"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[1059],{3805:(e,n,a)=>{a.d(n,{xA:()=>u,yg:()=>y});var t=a(758);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function r(e,n){if(null==e)return{};var a,t,i=function(e,n){if(null==e)return{};var a,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var o=t.createContext({}),p=function(e){var n=t.useContext(o),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},u=function(e){var n=p(e.components);return t.createElement(o.Provider,{value:n},e.children)},d="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var a=e.components,i=e.mdxType,l=e.originalType,o=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),d=p(a),c=i,y=d["".concat(o,".").concat(c)]||d[c]||g[c]||l;return a?t.createElement(y,s(s({ref:n},u),{},{components:a})):t.createElement(y,s({ref:n},u))}));function y(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=a.length,s=new Array(l);s[0]=c;var r={};for(var o in n)hasOwnProperty.call(n,o)&&(r[o]=n[o]);r.originalType=e,r[d]="string"==typeof e?e:i,s[1]=r;for(var p=2;p<l;p++)s[p]=a[p];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8480:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>r,toc:()=>p});var t=a(2232),i=(a(758),a(3805));const l={title:"Publishing"},s=void 0,r={unversionedId:"concepts/publishing",id:"concepts/publishing",title:"Publishing",description:"Overview",source:"@site/docs/concepts/publishing.md",sourceDirName:"concepts",slug:"/concepts/publishing",permalink:"/tods-competition-factory/docs/concepts/publishing",draft:!1,tags:[],version:"current",frontMatter:{title:"Publishing"},sidebar:"docs",previous:{title:"Conflict Reporting",permalink:"/tods-competition-factory/docs/concepts/scheduling-conflicts"},next:{title:"State Engines",permalink:"/tods-competition-factory/docs/engines/state-engines"}},o={},p=[{value:"Overview",id:"overview",level:2},{value:"Why Publishing Exists",id:"why-publishing-exists",level:3},{value:"How Publishing Works",id:"how-publishing-works",level:3},{value:"Publish State Management",id:"publish-state-management",level:2},{value:"Queryable Publish State",id:"queryable-publish-state",level:3},{value:"State Granularity",id:"state-granularity",level:3},{value:"Publishing Events and Draws",id:"publishing-events-and-draws",level:2},{value:"Publishing All Draws",id:"publishing-all-draws",level:3},{value:"Publishing Specific Draws",id:"publishing-specific-draws",level:3},{value:"Publishing by Stage",id:"publishing-by-stage",level:3},{value:"Round-by-Round Publishing",id:"round-by-round-publishing",level:3},{value:"Publishing with Embargo",id:"publishing-with-embargo",level:3},{value:"Unpublishing Events",id:"unpublishing-events",level:3},{value:"Publishing Event Seeding",id:"publishing-event-seeding",level:2},{value:"Why Separate Seeding Publication?",id:"why-separate-seeding-publication",level:3},{value:"Publishing Seeding",id:"publishing-seeding",level:3},{value:"Unpublishing Seeding",id:"unpublishing-seeding",level:3},{value:"Publishing Order of Play",id:"publishing-order-of-play",level:2},{value:"Why Order of Play Publishing?",id:"why-order-of-play-publishing",level:3},{value:"Publishing Scheduled MatchUps",id:"publishing-scheduled-matchups",level:3},{value:"Unpublishing Order of Play",id:"unpublishing-order-of-play",level:3},{value:"Querying Published Schedules",id:"querying-published-schedules",level:3},{value:"Publishing Participants",id:"publishing-participants",level:2},{value:"Why Participant Publishing?",id:"why-participant-publishing",level:3},{value:"Unpublishing Participants",id:"unpublishing-participants",level:3},{value:"Privacy Policies",id:"privacy-policies",level:2},{value:"Participant Privacy Policy",id:"participant-privacy-policy",level:3},{value:"Display Settings",id:"display-settings",level:3},{value:"Data Preparation for Publishing",id:"data-preparation-for-publishing",level:2},{value:"Event Data Payload",id:"event-data-payload",level:3},{value:"Prepared Payload Structure",id:"prepared-payload-structure",level:3},{value:"Subscriptions and Notifications",id:"subscriptions-and-notifications",level:2},{value:"Publishing Topics",id:"publishing-topics",level:3},{value:"Integration Patterns",id:"integration-patterns",level:3},{value:"Common Workflows",id:"common-workflows",level:2},{value:"Progressive Draw Publication",id:"progressive-draw-publication",level:3},{value:"Multi-Stage Publication",id:"multi-stage-publication",level:3},{value:"Daily Order of Play",id:"daily-order-of-play",level:3},{value:"Coordinated Event and Seeding Release",id:"coordinated-event-and-seeding-release",level:3},{value:"Querying with Publish State",id:"querying-with-publish-state",level:2},{value:"Event Data",id:"event-data",level:3},{value:"Competition Schedule",id:"competition-schedule",level:3},{value:"Participants",id:"participants",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Clear Separation",id:"clear-separation",level:3},{value:"Test Publish State",id:"test-publish-state",level:3},{value:"Atomic Publications",id:"atomic-publications",level:3},{value:"Subscription Error Handling",id:"subscription-error-handling",level:3},{value:"Privacy by Default",id:"privacy-by-default",level:3},{value:"Related Documentation",id:"related-documentation",level:2}],u={toc:p},d="wrapper";function g({components:e,...n}){return(0,i.yg)(d,(0,t.A)({},u,n,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"overview"},"Overview"),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Publishing")," is the mechanism for controlling what tournament information is made publicly available and when. It provides fine-grained control over the visibility of draws, seeding, schedules, and participant data, while maintaining a complete internal record for tournament operations."),(0,i.yg)("h3",{id:"why-publishing-exists"},"Why Publishing Exists"),(0,i.yg)("p",null,"Tournament organizers often need to control information release:"),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Competitive Integrity"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Withhold seeding until draws are complete to prevent gaming"),(0,i.yg)("li",{parentName:"ul"},"Delay draw publication until all entries are finalized"),(0,i.yg)("li",{parentName:"ul"},"Embargo certain rounds until earlier rounds complete")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Operational Flexibility"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Prepare draws internally before public release"),(0,i.yg)("li",{parentName:"ul"},"Schedule matchUps without immediately making them visible"),(0,i.yg)("li",{parentName:"ul"},"Make corrections before information becomes public")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Privacy Protection"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Control which participant information is publicly visible"),(0,i.yg)("li",{parentName:"ul"},"Apply privacy policies to protect sensitive data"),(0,i.yg)("li",{parentName:"ul"},"Manage participant opt-outs and preferences")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Media Management"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Coordinate releases with media partners"),(0,i.yg)("li",{parentName:"ul"},"Stage information rollout for maximum engagement"),(0,i.yg)("li",{parentName:"ul"},"Control timing of seeding and draw announcements")),(0,i.yg)("h3",{id:"how-publishing-works"},"How Publishing Works"),(0,i.yg)("p",null,"Publishing operates through ",(0,i.yg)("strong",{parentName:"p"},"publish state management")," tracked via ",(0,i.yg)("a",{parentName:"p",href:"./timeItems"},"Time Items"),":"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Internal Operations"),": Tournament staff work with complete data"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Publish Actions"),": Administrators explicitly publish specific elements"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"State Tracking"),": Time items record what's published and when"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Filtered Queries"),": Public-facing queries use ",(0,i.yg)("inlineCode",{parentName:"li"},"usePublishState: true")," to filter data"),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"Notifications"),": ",(0,i.yg)("a",{parentName:"li",href:"/docs/engines/subscriptions"},"Subscriptions")," notify systems when publishing changes")),(0,i.yg)("p",null,"This architecture enables full operational capability internally while controlling external visibility precisely."),(0,i.yg)("h2",{id:"publish-state-management"},"Publish State Management"),(0,i.yg)("p",null,"The factory tracks publish state for multiple tournament elements:"),(0,i.yg)("h3",{id:"queryable-publish-state"},"Queryable Publish State"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { publishState } = engine.getPublishState();\n\n// Tournament-level state\nconst participantsPublished = publishState.tournament.participants.published;\nconst orderOfPlayPublished = publishState.tournament.orderOfPlay.published;\n\n// Event-level state (accessed by eventId)\nconst eventState = publishState['eventId'].status;\nconst { published, publishedDrawIds, drawDetails } = eventState;\n\n// Draw-level state\nconst drawState = engine.getPublishState({ drawId }).publishState;\nconst drawPublished = drawState.status.published;\nconst drawDetail = drawState.status.drawDetail; // stage/structure granularity\n")),(0,i.yg)("h3",{id:"state-granularity"},"State Granularity"),(0,i.yg)("p",null,"Publishing can be controlled at multiple levels:"),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Tournament Level"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Participant list visibility"),(0,i.yg)("li",{parentName:"ul"},"Order of Play (scheduled matchUps)")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Event Level"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"All draws within an event"),(0,i.yg)("li",{parentName:"ul"},"Individual draws (flights) within an event"),(0,i.yg)("li",{parentName:"ul"},"Event seeding information")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Draw Level"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Entire draw structure"),(0,i.yg)("li",{parentName:"ul"},"Specific stages (MAIN, QUALIFYING, CONSOLATION)"),(0,i.yg)("li",{parentName:"ul"},"Individual structures within draws")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Structure Level"),":"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Specific structures within multi-structure draws"),(0,i.yg)("li",{parentName:"ul"},"Round-by-round visibility (progressive release)")),(0,i.yg)("h2",{id:"publishing-events-and-draws"},"Publishing Events and Draws"),(0,i.yg)("p",null,"Event publishing controls visibility of draw structures, matchUps, and results."),(0,i.yg)("h3",{id:"publishing-all-draws"},"Publishing All Draws"),(0,i.yg)("p",null,"Publish all draws within an event:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { eventData } = engine.publishEvent({ eventId });\n\n// eventData contains formatted payload for public display\n// publishState updated with timeItem\n// Subscribers notified via PUBLISH_EVENT topic\n")),(0,i.yg)("h3",{id:"publishing-specific-draws"},"Publishing Specific Draws"),(0,i.yg)("p",null,"Publish only selected draws (useful for flights):"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Shorthand for publishing specific drawIds\nengine.publishEvent({\n  eventId,\n  drawIdsToAdd: ['drawId1', 'drawId2'],\n});\n\n// Remove draws from published set\nengine.publishEvent({\n  eventId,\n  drawIdsToRemove: ['drawId3'],\n});\n")),(0,i.yg)("h3",{id:"publishing-by-stage"},"Publishing by Stage"),(0,i.yg)("p",null,"Publish only specific stages within a draw:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"import { stageConstants } from 'tods-competition-factory';\nconst { QUALIFYING, MAIN } = stageConstants;\n\n// Publish only qualifying stage\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [QUALIFYING],\n    },\n  },\n});\n\n// Publish MAIN and QUALIFYING\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [MAIN, QUALIFYING],\n      publishingDetail: { published: true },\n    },\n  },\n});\n")),(0,i.yg)("h3",{id:"round-by-round-publishing"},"Round-by-Round Publishing"),(0,i.yg)("p",null,"Control visibility round-by-round for progressive disclosure:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Publish only first round of a structure\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          roundLimit: 1,\n          published: true,\n        },\n      },\n    },\n  },\n});\n\n// Expand to include more rounds as they complete\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          roundLimit: 2, // Now show rounds 1 and 2\n          published: true,\n        },\n      },\n    },\n  },\n});\n")),(0,i.yg)("h3",{id:"publishing-with-embargo"},"Publishing with Embargo"),(0,i.yg)("p",null,"Schedule future publication with embargo timestamps:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const embargoTime = new Date('2024-06-15T10:00:00Z').toISOString();\n\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: {\n        published: true,\n        embargo: embargoTime, // Don't display until this time\n      },\n    },\n  },\n});\n")),(0,i.yg)("h3",{id:"unpublishing-events"},"Unpublishing Events"),(0,i.yg)("p",null,"Remove events from public visibility:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"engine.unPublishEvent({\n  eventId,\n  removePriorValues: true, // Remove timeItems (default)\n});\n")),(0,i.yg)("h2",{id:"publishing-event-seeding"},"Publishing Event Seeding"),(0,i.yg)("p",null,"Seeding publication is separate from draw publication, allowing flexible control over when seeding information becomes public."),(0,i.yg)("h3",{id:"why-separate-seeding-publication"},"Why Separate Seeding Publication?"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Competition Integrity"),": Prevent participants from knowing their seeded positions before draws finalized"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Draw Process"),": Complete seeding internally before public announcement"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Flexibility"),": Update seeding without re-publishing entire draw"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Staged Release"),": Announce seeded players separately from draw structure")),(0,i.yg)("h3",{id:"publishing-seeding"},"Publishing Seeding"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"engine.publishEventSeeding({\n  eventId,\n  seedingScaleNames: ['U18'], // Optional - specify which scales\n  drawIds: ['drawId1'], // Optional - specific draws only\n});\n\n// Different scales for different stages\nengine.publishEventSeeding({\n  eventId,\n  stageSeedingScaleNames: {\n    MAIN: 'U18',\n    QUALIFYING: 'U18Q',\n  },\n});\n")),(0,i.yg)("h3",{id:"unpublishing-seeding"},"Unpublishing Seeding"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"engine.unPublishEventSeeding({\n  eventId,\n  stages: ['MAIN', 'QUALIFYING'], // Optional - specific stages only\n});\n")),(0,i.yg)("h2",{id:"publishing-order-of-play"},"Publishing Order of Play"),(0,i.yg)("p",null,"Order of Play publishing controls visibility of scheduled matchUps - which matches are scheduled for which courts and times."),(0,i.yg)("h3",{id:"why-order-of-play-publishing"},"Why Order of Play Publishing?"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Schedule Preparation"),": Prepare schedules internally before announcing"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Flexibility"),": Make scheduling changes before public release"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Coordination"),": Synchronize releases with media partners"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Daily Updates"),": Publish each day's schedule separately")),(0,i.yg)("h3",{id:"publishing-scheduled-matchups"},"Publishing Scheduled MatchUps"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Publish all scheduled dates and events\nengine.publishOrderOfPlay();\n\n// Publish specific dates only\nengine.publishOrderOfPlay({\n  scheduledDates: ['2024-06-15', '2024-06-16'],\n});\n\n// Publish specific events only\nengine.publishOrderOfPlay({\n  eventIds: ['singles-main', 'doubles-main'],\n});\n\n// Publish specific dates and events\nengine.publishOrderOfPlay({\n  scheduledDates: ['2024-06-15'],\n  eventIds: ['singles-main'],\n  removePriorValues: true, // Clear previous publications\n});\n")),(0,i.yg)("h3",{id:"unpublishing-order-of-play"},"Unpublishing Order of Play"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"engine.unPublishOrderOfPlay({\n  removePriorValues: true, // Remove timeItems (default)\n});\n")),(0,i.yg)("h3",{id:"querying-published-schedules"},"Querying Published Schedules"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { dateMatchUps } = engine.competitionScheduleMatchUps({\n  usePublishState: true, // Only return published matchUps\n});\n\n// dateMatchUps organized by date, filtered by publish state\n// Only matchUps on published dates in published events returned\n")),(0,i.yg)("h2",{id:"publishing-participants"},"Publishing Participants"),(0,i.yg)("p",null,"Participant publishing controls visibility of the participant list."),(0,i.yg)("h3",{id:"why-participant-publishing"},"Why Participant Publishing?"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Entry Management"),": Accept entries internally before announcing participant list"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Privacy"),": Control when participant information becomes public"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Marketing"),": Coordinate announcements with promotional campaigns"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Staged Entries"),": Announce wildcards separately from direct acceptances")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"engine.publishParticipants();\n\n// Clear previous publications and republish\nengine.publishParticipants({\n  removePriorValues: true,\n});\n")),(0,i.yg)("h3",{id:"unpublishing-participants"},"Unpublishing Participants"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"engine.unPublishParticipants({\n  removePriorValues: true,\n});\n")),(0,i.yg)("h2",{id:"privacy-policies"},"Privacy Policies"),(0,i.yg)("p",null,"Publishing integrates with ",(0,i.yg)("strong",{parentName:"p"},"privacy policies")," to control which participant attributes are visible:"),(0,i.yg)("h3",{id:"participant-privacy-policy"},"Participant Privacy Policy"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"import { policyConstants } from 'tods-competition-factory';\n\nconst privacyPolicy = {\n  participant: {\n    contacts: false, // Hide contact information\n    addresses: false, // Hide addresses\n    individualParticipants: {\n      // For pairs/teams\n      contacts: false,\n      addresses: false,\n    },\n  },\n};\n\n// Apply privacy policy during publishing\nconst { eventData } = engine.publishEvent({\n  eventId,\n  policyDefinitions: { [policyConstants.POLICY_TYPE_PARTICIPANT]: privacyPolicy },\n});\n\n// Participant data in eventData respects privacy policy\n// Internal operations still have access to complete data\n")),(0,i.yg)("h3",{id:"display-settings"},"Display Settings"),(0,i.yg)("p",null,"Control visibility of specific matchUp and schedule attributes:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const displaySettings = {\n  matchUps: {\n    scheduleDate: true,\n    scheduledTime: false, // Hide specific times\n    courtName: true,\n    courtOrder: false,\n  },\n  participants: {\n    addresses: false,\n    contacts: false,\n  },\n};\n\nengine.setEventDisplay({\n  eventId,\n  displaySettings,\n});\n\n// Settings applied when usePublishState: true in queries\n")),(0,i.yg)("h2",{id:"data-preparation-for-publishing"},"Data Preparation for Publishing"),(0,i.yg)("p",null,"Publishing methods prepare optimized data payloads for public display."),(0,i.yg)("h3",{id:"event-data-payload"},"Event Data Payload"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { eventData } = engine.publishEvent({\n  eventId,\n  eventDataParams: {\n    allParticipantResults: true, // Include round statistics\n    participantsProfile: {\n      withISO2: true, // Include country codes\n      withIOC: true,\n    },\n  },\n});\n\n// eventData structure optimized for visualization:\n// - drawsData: Array of draws with structures\n// - matchUps: Organized by rounds for each structure\n// - participants: Hydrated participant information\n// - venuesData: Venue and court information\n// - tournamentInfo: Tournament metadata\n")),(0,i.yg)("admonition",{type:"important"},(0,i.yg)("p",{parentName:"admonition"},(0,i.yg)("strong",{parentName:"p"},"Event Data Parameters Are Not Persisted")),(0,i.yg)("p",{parentName:"admonition"},"The ",(0,i.yg)("inlineCode",{parentName:"p"},"eventDataParams")," passed to ",(0,i.yg)("inlineCode",{parentName:"p"},"publishEvent()")," are used to generate the ",(0,i.yg)("inlineCode",{parentName:"p"},"eventData")," payload ",(0,i.yg)("strong",{parentName:"p"},"for that specific call only"),". These parameters are ",(0,i.yg)("strong",{parentName:"p"},"NOT stored")," in the publish state timeItem."),(0,i.yg)("p",{parentName:"admonition"},(0,i.yg)("strong",{parentName:"p"},"Client applications must pass their own query parameters:")),(0,i.yg)("pre",{parentName:"admonition"},(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Server-side publishing (generates payload for subscriptions)\nengine.publishEvent({\n  eventId,\n  eventDataParams: { participantsProfile: { withISO2: true } },\n});\n\n// Client application querying published data\nconst { eventData } = engine.getEventData({\n  eventId,\n  usePublishState: true, // Respects what's published\n  participantsProfile: { withISO2: true }, // Must specify params again\n});\n")),(0,i.yg)("p",{parentName:"admonition"},"The publish state timeItem controls ",(0,i.yg)("strong",{parentName:"p"},"filtering")," (which draws, structures, rounds are visible) but does not store query customization parameters. Each client application specifies its own data requirements when querying.")),(0,i.yg)("h3",{id:"prepared-payload-structure"},"Prepared Payload Structure"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript"},"{\n  eventData: {\n    eventInfo: {\n      eventId: string;\n      eventName: string;\n      // ... event metadata\n    },\n    drawsData: [{\n      drawId: string;\n      drawName: string;\n      structures: [{\n        structureId: string;\n        structureName: string;\n        roundMatchUps: {\n          [roundNumber]: matchUp[]\n        }\n      }]\n    }],\n    participants: Participant[],\n    venuesData: Venue[],\n    tournamentInfo: TournamentInfo\n  }\n}\n")),(0,i.yg)("h2",{id:"subscriptions-and-notifications"},"Subscriptions and Notifications"),(0,i.yg)("p",null,"Publishing actions trigger ",(0,i.yg)("strong",{parentName:"p"},"subscription notifications")," enabling real-time updates to public-facing systems."),(0,i.yg)("h3",{id:"publishing-topics"},"Publishing Topics"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"import { topicConstants } from 'tods-competition-factory';\n\nconst subscriptions = {\n  [topicConstants.PUBLISH_EVENT]: (payload) => {\n    // Event published - update public website\n    const { eventData, eventId } = payload;\n    updatePublicSite(eventData);\n  },\n\n  [topicConstants.UNPUBLISH_EVENT]: (payload) => {\n    // Event unpublished - remove from public website\n    const { eventId } = payload;\n    removeFromPublicSite(eventId);\n  },\n\n  [topicConstants.PUBLISH_EVENT_SEEDING]: (payload) => {\n    // Seeding published - update seeding displays\n    const { eventId, seedingData } = payload;\n    updateSeedingDisplay(seedingData);\n  },\n\n  [topicConstants.UNPUBLISH_EVENT_SEEDING]: (payload) => {\n    // Seeding unpublished - remove seeding information\n    const { eventId } = payload;\n    removeSeedingDisplay(eventId);\n  },\n\n  [topicConstants.PUBLISH_ORDER_OF_PLAY]: (payload) => {\n    // Order of Play published - update schedule displays\n    const { dateMatchUps } = payload;\n    updateScheduleDisplay(dateMatchUps);\n  },\n\n  [topicConstants.UNPUBLISH_ORDER_OF_PLAY]: (payload) => {\n    // Order of Play unpublished - remove schedules\n    removeScheduleDisplay();\n  },\n};\n\nengine.devContext({ subscriptions });\n")),(0,i.yg)("h3",{id:"integration-patterns"},"Integration Patterns"),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Push to Public Website"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"[topicConstants.PUBLISH_EVENT]: async (payload) => {\n  const { eventData } = payload;\n  await fetch('https://public-site.com/api/events', {\n    method: 'POST',\n    body: JSON.stringify(eventData)\n  });\n}\n")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Database Synchronization"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"[topicConstants.PUBLISH_ORDER_OF_PLAY]: async (payload) => {\n  const { dateMatchUps } = payload;\n  await database.updatePublishedSchedule(dateMatchUps);\n}\n")),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Cache Invalidation"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"[topicConstants.UNPUBLISH_EVENT]: (payload) => {\n  const { eventId } = payload;\n  cache.invalidate(`event:${eventId}`);\n}\n")),(0,i.yg)("h2",{id:"common-workflows"},"Common Workflows"),(0,i.yg)("h3",{id:"progressive-draw-publication"},"Progressive Draw Publication"),(0,i.yg)("p",null,"Gradually release draw information as tournament progresses:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Day 1: Publish first round only\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: { roundLimit: 1, published: true },\n      },\n    },\n  },\n});\n\n// Day 2: Expand to show rounds 1-2\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: { roundLimit: 2, published: true },\n      },\n    },\n  },\n});\n\n// Day 3: Publish entire draw\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: { publishingDetail: { published: true } },\n  },\n});\n")),(0,i.yg)("h3",{id:"multi-stage-publication"},"Multi-Stage Publication"),(0,i.yg)("p",null,"Publish qualifying first, main draw later:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"import { stageConstants } from 'tods-competition-factory';\n\n// Publish qualifying only\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [stageConstants.QUALIFYING],\n    },\n  },\n});\n\n// Later: add main draw\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [stageConstants.MAIN],\n    },\n  },\n});\n")),(0,i.yg)("h3",{id:"daily-order-of-play"},"Daily Order of Play"),(0,i.yg)("p",null,"Publish each day's schedule separately:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Each morning, publish that day's schedule\nconst today = new Date().toISOString().split('T')[0];\n\nengine.publishOrderOfPlay({\n  scheduledDates: [today],\n  removePriorValues: false, // Keep previous days published\n});\n")),(0,i.yg)("h3",{id:"coordinated-event-and-seeding-release"},"Coordinated Event and Seeding Release"),(0,i.yg)("p",null,"Separate seeding announcement from draw publication:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Step 1: Announce seeded players\nengine.publishEventSeeding({ eventId });\n// Subscription notification sent\n// Public site shows seeded players without draw\n\n// Step 2: Later, publish draw\nengine.publishEvent({ eventId });\n// Subscription notification sent\n// Public site shows complete draw with seeding\n")),(0,i.yg)("h2",{id:"querying-with-publish-state"},"Querying with Publish State"),(0,i.yg)("p",null,"Methods that respect publish state when ",(0,i.yg)("inlineCode",{parentName:"p"},"usePublishState: true"),":"),(0,i.yg)("h3",{id:"event-data"},"Event Data"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { eventData } = engine.getEventData({\n  eventId,\n  usePublishState: true, // Filter to published draws/structures only\n});\n")),(0,i.yg)("h3",{id:"competition-schedule"},"Competition Schedule"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { dateMatchUps } = engine.competitionScheduleMatchUps({\n  usePublishState: true, // Only published dates and events\n});\n")),(0,i.yg)("h3",{id:"participants"},"Participants"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const { participants } = engine.getParticipants({\n  usePublishState: true, // Respect privacy policies\n  policyDefinitions: privacyPolicy,\n});\n")),(0,i.yg)("h2",{id:"best-practices"},"Best Practices"),(0,i.yg)("h3",{id:"clear-separation"},"Clear Separation"),(0,i.yg)("p",null,"Maintain clear separation between internal and public-facing queries:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Internal operations - full data access\nconst { matchUps } = engine.allTournamentMatchUps();\n\n// Public displays - filtered data\nconst { matchUps: publicMatchUps } = engine.allTournamentMatchUps({\n  usePublishState: true,\n});\n")),(0,i.yg)("h3",{id:"test-publish-state"},"Test Publish State"),(0,i.yg)("p",null,"Verify filtering works before going live:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Publish event\nengine.publishEvent({ eventId });\n\n// Query what public will see\nconst { eventData } = engine.getEventData({\n  eventId,\n  usePublishState: true,\n});\n\n// Verify expected structures/rounds visible\nassert(eventData.drawsData.length === expectedCount);\n")),(0,i.yg)("h3",{id:"atomic-publications"},"Atomic Publications"),(0,i.yg)("p",null,"Use ",(0,i.yg)("inlineCode",{parentName:"p"},"removePriorValues: true")," for clean state transitions:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"// Replace previous publication completely\nengine.publishOrderOfPlay({\n  scheduledDates: newDates,\n  removePriorValues: true, // Clean slate\n});\n")),(0,i.yg)("h3",{id:"subscription-error-handling"},"Subscription Error Handling"),(0,i.yg)("p",null,"Handle subscription failures gracefully:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"[topicConstants.PUBLISH_EVENT]: async (payload) => {\n  try {\n    await updatePublicSite(payload.eventData);\n  } catch (error) {\n    logger.error('Failed to update public site', error);\n    // Queue for retry or alert administrators\n  }\n}\n")),(0,i.yg)("h3",{id:"privacy-by-default"},"Privacy by Default"),(0,i.yg)("p",null,"Apply privacy policies consistently:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-js"},"const defaultPrivacyPolicy = {\n  participant: {\n    contacts: false,\n    addresses: false,\n    individualParticipants: {\n      contacts: false,\n      addresses: false,\n    },\n  },\n};\n\n// Attach to tournament for consistent application\nengine.attachPolicies({\n  policyDefinitions: {\n    [policyConstants.POLICY_TYPE_PARTICIPANT]: defaultPrivacyPolicy,\n  },\n});\n")),(0,i.yg)("h2",{id:"related-documentation"},"Related Documentation"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"/docs/governors/publishing-governor"},"Publishing Governor"))," - Complete API reference"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"/docs/governors/query-governor"},"Query Governor"))," - Methods using publish state"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"/docs/engines/subscriptions"},"Subscriptions"))," - Notification topics"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"./policies"},"Policies"))," - Privacy and display policies"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},(0,i.yg)("a",{parentName:"strong",href:"./timeItems"},"Time Items"))," - How publish state is stored")))}g.isMDXComponent=!0}}]);
"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[9552],{8967(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"engines/custom-engines","title":"Custom Engines","description":"Factory engines are lightweight, method-free containers until you import the specific functionality you need. This architecture enables tree-shaking and code splitting, allowing you to create custom engines with only the methods required for your use case.","source":"@site/docs/engines/custom-engines.md","sourceDirName":"engines","slug":"/engines/custom-engines","permalink":"/competition-factory/docs/engines/custom-engines","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Custom Engines"},"sidebar":"docs","previous":{"title":"Subscriptions","permalink":"/competition-factory/docs/engines/subscriptions"},"next":{"title":"Global State","permalink":"/competition-factory/docs/engines/global-state"}}');var t=r(6070),s=r(8322);const o={title:"Custom Engines"},c=void 0,l={},a=[{value:"Creating Custom Engines",id:"creating-custom-engines",level:2},{value:"Minimal Query Engine",id:"minimal-query-engine",level:3},{value:"Minimal Mutation Engine",id:"minimal-mutation-engine",level:3},{value:"Importing Nested Methods",id:"importing-nested-methods",level:3},{value:"Real-World Examples",id:"real-world-examples",level:2},{value:"Client-Side Scoring App",id:"client-side-scoring-app",level:3},{value:"Server-Side Tournament Admin API",id:"server-side-tournament-admin-api",level:3},{value:"Microservice-Specific Engines",id:"microservice-specific-engines",level:3},{value:"Method Import Patterns",id:"method-import-patterns",level:2},{value:"Selective Import (Recommended)",id:"selective-import-recommended",level:3},{value:"Governor Import",id:"governor-import",level:3},{value:"Full Import",id:"full-import",level:3},{value:"TypeScript Support",id:"typescript-support",level:2},{value:"Performance Comparison",id:"performance-comparison",level:2},{value:"Migration from v1.x",id:"migration-from-v1x",level:2}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Factory engines are lightweight, method-free containers until you import the specific functionality you need. This architecture enables ",(0,t.jsx)(n.strong,{children:"tree-shaking"})," and ",(0,t.jsx)(n.strong,{children:"code splitting"}),", allowing you to create custom engines with only the methods required for your use case."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Reduced bundle size for client-side applications"}),"\n",(0,t.jsx)(n.li,{children:"Faster load times by including only needed functionality"}),"\n",(0,t.jsx)(n.li,{children:"Clear separation between query and mutation operations"}),"\n",(0,t.jsx)(n.li,{children:"Modular architecture for microservices"}),"\n",(0,t.jsx)(n.li,{children:"Type-safe method imports with full IntelliSense support"}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"tournamentEngine"})," and ",(0,t.jsx)(n.code,{children:"competitionEngine"})," exports are pre-configured custom engines provided for backwards compatibility with Competition Factory v1.x. They include all governors and methods."]})}),"\n",(0,t.jsxs)(n.admonition,{title:"Engine Singleton Behavior",type:"warning",children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"syncEngine"})," is a singleton - importing it in multiple files returns the same instance. Methods imported into syncEngine are available everywhere it's imported. For truly independent engines in the same application, use different engine types:"]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"syncEngine"})," for one configuration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"askEngine"})," for read-only operations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"matchUpEngine"})," for matchUp-specific operations"]}),"\n"]}),(0,t.jsxs)(n.p,{children:["Do not import methods into ",(0,t.jsx)(n.code,{children:"syncEngine"})," in multiple places, as they will accumulate. Configure your custom engine once at application startup."]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"creating-custom-engines",children:"Creating Custom Engines"}),"\n",(0,t.jsx)(n.h3,{id:"minimal-query-engine",children:"Minimal Query Engine"}),"\n",(0,t.jsxs)(n.p,{children:["Create a read-only engine with just query methods. Since ",(0,t.jsx)(n.code,{children:"syncEngine"})," is a singleton, configure it once and export:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// queryEngine.ts\nimport { governors, syncEngine } from 'tods-competition-factory';\n\n// Import only query methods\nsyncEngine.importMethods(governors.queryGovernor);\n\nexport { syncEngine as queryEngine };\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { queryEngine } from './queryEngine';\n\nqueryEngine.setState(tournamentRecord);\n\n// Query methods available\nconst { participants } = queryEngine.getParticipants();\nconst { matchUps } = queryEngine.allTournamentMatchUps();\n\n// Mutation methods NOT available\nqueryEngine.addEvent({ event }); // \u274c TypeError: addEvent is not a function\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Bundle Size:"})," ~60% smaller than full tournamentEngine"]}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["Do not import ",(0,t.jsx)(n.code,{children:"syncEngine"})," in other files and add more methods - they will be added to the same singleton. Configure once at app startup."]})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"minimal-mutation-engine",children:"Minimal Mutation Engine"}),"\n",(0,t.jsxs)(n.p,{children:["Create a write-only engine for specific operations. Use ",(0,t.jsx)(n.code,{children:"askEngine"})," for an independent instance:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// scoringEngine.ts\nimport { governors, askEngine } from 'tods-competition-factory';\n\n// Import only scoring-related mutation methods\naskEngine.importMethods({\n  setMatchUpStatus: governors.matchUpGovernor.setMatchUpStatus,\n  setMatchUpState: governors.matchUpGovernor.setMatchUpState,\n});\n\nexport { askEngine as scoringEngine };\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { scoringEngine } from './scoringEngine';\n\nscoringEngine.setState(tournamentRecord);\n\n// Only scoring methods available\nscoringEngine.setMatchUpStatus({\n  matchUpId: 'match-1',\n  outcome: { score: { sets: [{ side1Score: 6, side2Score: 4 }] } }\n}); // \u2705 Works\n\nscoringEngine.generateDrawDefinition({ drawSize: 32 }); // \u274c Not available\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"importing-nested-methods",children:"Importing Nested Methods"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"importMethods"})," function can traverse nested objects to import all methods:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { governors, syncEngine } from 'tods-competition-factory';\n\n// Import all methods from all governors (full engine)\nsyncEngine.importMethods(governors, true, 1);\n// Parameters: (object, traverse=true, maxDepth=1)\n\nexport { syncEngine as fullEngine };\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Traversal Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"traverse: false"})," - Only import methods at the current level"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"traverse: true, maxDepth: 1"})," - Import from nested objects (1 level deep)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"traverse: true, maxDepth: 2"})," - Import from deeply nested objects"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"real-world-examples",children:"Real-World Examples"}),"\n",(0,t.jsx)(n.h3,{id:"client-side-scoring-app",children:"Client-Side Scoring App"}),"\n",(0,t.jsx)(n.p,{children:"Minimize bundle for browser-based live scoring:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// src/engines/clientEngine.ts\nimport { governors, syncEngine } from 'tods-competition-factory';\n\n// Only import what's needed for live scoring UI\nsyncEngine.importMethods({\n  // State management\n  setState: governors.queryGovernor.setState,\n  getState: governors.queryGovernor.getState,\n  \n  // Queries for display\n  allTournamentMatchUps: governors.queryGovernor.allTournamentMatchUps,\n  getMatchUp: governors.queryGovernor.getMatchUp,\n  \n  // Score entry\n  setMatchUpStatus: governors.matchUpGovernor.setMatchUpStatus,\n  \n  // Score validation\n  validateSetScore: governors.scoreGovernor.validateSetScore,\n  validateMatchUpScore: governors.scoreGovernor.validateMatchUpScore,\n});\n\nexport { syncEngine as clientEngine };\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Result:"})," 75% smaller bundle than full tournamentEngine"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"server-side-tournament-admin-api",children:"Server-Side Tournament Admin API"}),"\n",(0,t.jsx)(n.p,{children:"Full-featured engine for administrative operations:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// src/engines/adminEngine.ts\nimport { governors, syncEngine } from 'tods-competition-factory';\n\n// Import all governors for full admin capabilities\nsyncEngine.importMethods(governors, true, 1);\n\n// Add custom admin-only methods\nsyncEngine.getAdminStats = function() {\n  const { participants } = this.getParticipants();\n  const { events } = this.getEvents();\n  const { venues } = this.getVenues();\n  return {\n    participantCount: participants?.length || 0,\n    eventCount: events?.length || 0,\n    venueCount: venues?.length || 0,\n  };\n};\n\nexport { syncEngine as adminEngine };\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"microservice-specific-engines",children:"Microservice-Specific Engines"}),"\n",(0,t.jsx)(n.p,{children:"Create engines tailored to specific microservices:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// scheduling-service/engine.ts - Only scheduling methods\nimport { governors, syncEngine } from 'tods-competition-factory';\n\nsyncEngine.importMethods({\n  // State\n  setState: governors.queryGovernor.setState,\n  \n  // Queries\n  allTournamentMatchUps: governors.queryGovernor.allTournamentMatchUps,\n  getVenuesAndCourts: governors.queryGovernor.getVenuesAndCourts,\n  \n  // Scheduling mutations\n  bulkScheduleTournamentMatchUps: governors.scheduleGovernor.bulkScheduleTournamentMatchUps,\n  scheduleMatchUps: governors.scheduleGovernor.scheduleMatchUps,\n  clearScheduledMatchUps: governors.scheduleGovernor.clearScheduledMatchUps,\n});\n\nexport { syncEngine as schedulingEngine };\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// draw-generation-service/engine.ts - Only draw generation  \n// Use syncEngine singleton configured once at startup\nimport { governors, syncEngine } from 'tods-competition-factory';\n\nsyncEngine.importMethods({\n  setState: governors.queryGovernor.setState,\n  addEvent: governors.eventGovernor.addEvent,\n  generateDrawDefinition: governors.generationGovernor.generateDrawDefinition,\n  automatedPositioning: governors.drawsGovernor.automatedPositioning,\n});\n\nexport { syncEngine as drawEngine };\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"method-import-patterns",children:"Method Import Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"selective-import-recommended",children:"Selective Import (Recommended)"}),"\n",(0,t.jsx)(n.p,{children:"Explicitly list needed methods for maximum control:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"syncEngine.importMethods({\n  setState: governors.queryGovernor.setState,\n  getParticipants: governors.queryGovernor.getParticipants,\n  addEvent: governors.eventGovernor.addEvent,\n});\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Smallest bundle size"}),"\n",(0,t.jsx)(n.li,{children:"Clear dependencies"}),"\n",(0,t.jsx)(n.li,{children:"Easy to audit what's included"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"More verbose"}),"\n",(0,t.jsx)(n.li,{children:"Must update when adding features"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"governor-import",children:"Governor Import"}),"\n",(0,t.jsx)(n.p,{children:"Import entire governor for related functionality:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Import all query methods\nsyncEngine.importMethods(governors.queryGovernor);\n\n// Import all event methods\nsyncEngine.importMethods(governors.eventGovernor);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Balanced bundle size"}),"\n",(0,t.jsx)(n.li,{children:"Related methods grouped"}),"\n",(0,t.jsx)(n.li,{children:"Less maintenance"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"May include unused methods from governor"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"full-import",children:"Full Import"}),"\n",(0,t.jsx)(n.p,{children:"Import everything for maximum flexibility:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"syncEngine.importMethods(governors, true, 1);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All functionality available"}),"\n",(0,t.jsx)(n.li,{children:"No method missing errors"}),"\n",(0,t.jsx)(n.li,{children:"Fastest development"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Largest bundle size"}),"\n",(0,t.jsx)(n.li,{children:"Includes unused code"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"typescript-support",children:"TypeScript Support"}),"\n",(0,t.jsx)(n.p,{children:"Custom engines maintain full type safety:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { governors, syncEngine } from 'tods-competition-factory';\nimport type { FactoryEngine } from 'tods-competition-factory';\n\n// Type-safe custom engine\nsyncEngine.importMethods(governors.queryGovernor);\n\nexport { syncEngine as queryEngine };\n\n// IntelliSense works for imported methods\nqueryEngine.getParticipants(); // \u2705 Autocomplete available\nqueryEngine.addEvent({}); // \u274c TypeScript error: method not imported\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"performance-comparison",children:"Performance Comparison"}),"\n",(0,t.jsx)(n.p,{children:"Bundle sizes for different import strategies (gzipped):"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Engine Configuration"}),(0,t.jsx)(n.th,{children:"Bundle Size"}),(0,t.jsx)(n.th,{children:"Use Case"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Selective (5 methods)"}),(0,t.jsx)(n.td,{children:"~15 KB"}),(0,t.jsx)(n.td,{children:"Minimal client app"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Query Governor"}),(0,t.jsx)(n.td,{children:"~45 KB"}),(0,t.jsx)(n.td,{children:"Read-only display"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Mutation Governor"}),(0,t.jsx)(n.td,{children:"~60 KB"}),(0,t.jsx)(n.td,{children:"Specific mutations"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Full Engine"}),(0,t.jsx)(n.td,{children:"~180 KB"}),(0,t.jsx)(n.td,{children:"Complete functionality"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Pre-built tournamentEngine"}),(0,t.jsx)(n.td,{children:"~180 KB"}),(0,t.jsx)(n.td,{children:"Backward compatibility"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Recommendation:"})," Start with selective imports and add methods as needed."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"migration-from-v1x",children:"Migration from v1.x"}),"\n",(0,t.jsx)(n.p,{children:"If migrating from Competition Factory v1.x:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// v1.x - Pre-built engine\nimport { tournamentEngine } from 'tods-competition-factory';\n\n// v2.x - Custom engine (same functionality)\nimport { governors, syncEngine } from 'tods-competition-factory';\nsyncEngine.importMethods(governors, true, 1);\nexport const tournamentEngine = syncEngine;\n"})}),"\n",(0,t.jsx)(n.p,{children:"Or continue using the pre-built exports:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Still works in v2.x for backward compatibility\nimport { tournamentEngine } from 'tods-competition-factory';\n"})}),"\n",(0,t.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8322(e,n,r){r.d(n,{R:()=>o,x:()=>c});var i=r(758);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);
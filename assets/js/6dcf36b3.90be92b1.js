"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[9136],{7745(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"tools/make-deep-copy","title":"makeDeepCopy","description":"Makes a deep copy of a JSON object; used internally by default to ensure that objects returns by factory query methods are immutable.","source":"@site/docs/tools/make-deep-copy.md","sourceDirName":"tools","slug":"/tools/make-deep-copy","permalink":"/competition-factory/docs/tools/make-deep-copy","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"makeDeepCopy"},"sidebar":"docs","previous":{"title":"Overview","permalink":"/competition-factory/docs/tools/tools-overview"},"next":{"title":"structureSort","permalink":"/competition-factory/docs/tools/structure-sort"}}');var s=t(6070),i=t(8322);const r={title:"makeDeepCopy"},a=void 0,c={},l=[{value:"convertExtensions",id:"convertextensions",level:2},{value:"Disabling deep copies",id:"disabling-deep-copies",level:2},{value:"internalUse and deepCopyOptions",id:"internaluse-and-deepcopyoptions",level:2}];function d(e){const n={code:"code",em:"em",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Makes a deep copy of a JSON object; used internally by default to ensure that objects returns by factory query methods are immutable."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { tools } from 'tods-competition-factory';\n\ntools.makeDeepCopy(element, convertExtensions, internalUse);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"convertextensions",children:"convertExtensions"}),"\n",(0,s.jsxs)(n.p,{children:["When ",(0,s.jsx)(n.strong,{children:"convertExtensions"})," is ",(0,s.jsx)(n.strong,{children:"true"}),", TODS extensions objects are converted as follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// original\nelement.extensions: [ { name: 'extensionName', value: { a: 1 } }]\n\n// after conversion\nelement._extensionName: { a: 1 }\n"})}),"\n",(0,s.jsx)(n.p,{children:'This is useful for inContext representations of elements such as participants where "accessor strings" can be used to directly access values rather than searching through arrays of extensions; a good example of this is in Avoidance Policies.'}),"\n",(0,s.jsx)(n.h2,{id:"disabling-deep-copies",children:"Disabling deep copies"}),"\n",(0,s.jsxs)(n.p,{children:["In server environments where it is desireable for objects originating in back end storage (such as Mongo) to be modified directly, it is possible to disable ",(0,s.jsx)(n.code,{children:"makeDeepCopy"})," several ways:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { globalState: { setDeepCopy } } from 'tods-competition-factory';\n\nengine.setState(tournamentRecord, false, deepCopyOptions);\n\nsetDeepCopy(false, deepCopyOptions);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"internaluse-and-deepcopyoptions",children:"internalUse and deepCopyOptions"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"internalUse"})," is a boolean parameter which is sometimes used ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"within"})})," factory methods to specify that ",(0,s.jsx)(n.code,{children:"makeDeepCopy"})," must be used regardless; it pertains to methods which return ",(0,s.jsx)(n.strong,{children:"inContext"})," data which should never be persisted. There are some cases where this can cause problems, so a method is provided to configure how ",(0,s.jsx)(n.code,{children:"makeDeepCopy"})," behaves in scenarios where it is disabled but must be used internally."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const deepCopyOptions = {\n  threshold, // optional integer to limit the depth of the deep copy\n  stringify: [], // any object keys in this array will be stringified (using a .toString() function if present on the object)\n  toJSON: [], // any object keys in this array will be converted to JSON if there is a .toJSON() function on the object\n  ignore: [], // any object keys in this array will be ignored\n};\n\nsetDeepCopy(false, deepCopyOptions);\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8322(e,n,t){t.d(n,{R:()=>r,x:()=>a});var o=t(758);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);
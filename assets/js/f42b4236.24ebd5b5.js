"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[9552],{3805:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>y});var r=t(758);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),g=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=g(e.components);return r.createElement(s.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=g(t),c=o,y=m["".concat(s,".").concat(c)]||m[c]||u[c]||a;return t?r.createElement(y,i(i({ref:n},p),{},{components:t})):r.createElement(y,i({ref:n},p))}));function y(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=c;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[m]="string"==typeof e?e:o,i[1]=l;for(var g=2;g<a;g++)i[g]=t[g];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},5282:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>g});var r=t(2232),o=(t(758),t(3805));const a={title:"Custom Engines"},i=void 0,l={unversionedId:"engines/custom-engines",id:"engines/custom-engines",title:"Custom Engines",description:"Factory engines are lightweight, method-free containers until you import the specific functionality you need. This architecture enables tree-shaking and code splitting, allowing you to create custom engines with only the methods required for your use case.",source:"@site/docs/engines/custom-engines.md",sourceDirName:"engines",slug:"/engines/custom-engines",permalink:"/tods-competition-factory/docs/engines/custom-engines",draft:!1,tags:[],version:"current",frontMatter:{title:"Custom Engines"},sidebar:"docs",previous:{title:"Subscriptions",permalink:"/tods-competition-factory/docs/engines/subscriptions"},next:{title:"Global State",permalink:"/tods-competition-factory/docs/engines/global-state"}},s={},g=[{value:"Creating Custom Engines",id:"creating-custom-engines",level:2},{value:"Minimal Query Engine",id:"minimal-query-engine",level:3},{value:"Minimal Mutation Engine",id:"minimal-mutation-engine",level:3},{value:"Importing Nested Methods",id:"importing-nested-methods",level:3},{value:"Real-World Examples",id:"real-world-examples",level:2},{value:"Client-Side Scoring App",id:"client-side-scoring-app",level:3},{value:"Server-Side Tournament Admin API",id:"server-side-tournament-admin-api",level:3},{value:"Microservice-Specific Engines",id:"microservice-specific-engines",level:3},{value:"Method Import Patterns",id:"method-import-patterns",level:2},{value:"Selective Import (Recommended)",id:"selective-import-recommended",level:3},{value:"Governor Import",id:"governor-import",level:3},{value:"Full Import",id:"full-import",level:3},{value:"TypeScript Support",id:"typescript-support",level:2},{value:"Performance Comparison",id:"performance-comparison",level:2},{value:"Migration from v1.x",id:"migration-from-v1x",level:2}],p={toc:g},m="wrapper";function u({components:e,...n}){return(0,o.yg)(m,(0,r.A)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"Factory engines are lightweight, method-free containers until you import the specific functionality you need. This architecture enables ",(0,o.yg)("strong",{parentName:"p"},"tree-shaking")," and ",(0,o.yg)("strong",{parentName:"p"},"code splitting"),", allowing you to create custom engines with only the methods required for your use case."),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Benefits:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Reduced bundle size for client-side applications"),(0,o.yg)("li",{parentName:"ul"},"Faster load times by including only needed functionality"),(0,o.yg)("li",{parentName:"ul"},"Clear separation between query and mutation operations"),(0,o.yg)("li",{parentName:"ul"},"Modular architecture for microservices"),(0,o.yg)("li",{parentName:"ul"},"Type-safe method imports with full IntelliSense support")),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"The ",(0,o.yg)("inlineCode",{parentName:"p"},"tournamentEngine")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"competitionEngine")," exports are pre-configured custom engines provided for backwards compatibility with Competition Factory v1.x. They include all governors and methods.")),(0,o.yg)("admonition",{title:"Engine Singleton Behavior",type:"warning"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("inlineCode",{parentName:"p"},"syncEngine")," is a singleton - importing it in multiple files returns the same instance. Methods imported into syncEngine are available everywhere it's imported. For truly independent engines in the same application, use different engine types:"),(0,o.yg)("ul",{parentName:"admonition"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"syncEngine")," for one configuration"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"askEngine")," for read-only operations  "),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"matchUpEngine")," for matchUp-specific operations")),(0,o.yg)("p",{parentName:"admonition"},"Do not import methods into ",(0,o.yg)("inlineCode",{parentName:"p"},"syncEngine")," in multiple places, as they will accumulate. Configure your custom engine once at application startup.")),(0,o.yg)("hr",null),(0,o.yg)("h2",{id:"creating-custom-engines"},"Creating Custom Engines"),(0,o.yg)("h3",{id:"minimal-query-engine"},"Minimal Query Engine"),(0,o.yg)("p",null,"Create a read-only engine with just query methods. Since ",(0,o.yg)("inlineCode",{parentName:"p"},"syncEngine")," is a singleton, configure it once and export:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// queryEngine.ts\nimport { governors, syncEngine } from 'tods-competition-factory';\n\n// Import only query methods\nsyncEngine.importMethods(governors.queryGovernor);\n\nexport { syncEngine as queryEngine };\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Usage:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"import { queryEngine } from './queryEngine';\n\nqueryEngine.setState(tournamentRecord);\n\n// Query methods available\nconst { participants } = queryEngine.getParticipants();\nconst { matchUps } = queryEngine.allTournamentMatchUps();\n\n// Mutation methods NOT available\nqueryEngine.addEvent({ event }); // \u274c TypeError: addEvent is not a function\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Bundle Size:")," ~60% smaller than full tournamentEngine"),(0,o.yg)("admonition",{type:"caution"},(0,o.yg)("p",{parentName:"admonition"},"Do not import ",(0,o.yg)("inlineCode",{parentName:"p"},"syncEngine")," in other files and add more methods - they will be added to the same singleton. Configure once at app startup.")),(0,o.yg)("hr",null),(0,o.yg)("h3",{id:"minimal-mutation-engine"},"Minimal Mutation Engine"),(0,o.yg)("p",null,"Create a write-only engine for specific operations. Use ",(0,o.yg)("inlineCode",{parentName:"p"},"askEngine")," for an independent instance:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// scoringEngine.ts\nimport { governors, askEngine } from 'tods-competition-factory';\n\n// Import only scoring-related mutation methods\naskEngine.importMethods({\n  setMatchUpStatus: governors.matchUpGovernor.setMatchUpStatus,\n  setMatchUpState: governors.matchUpGovernor.setMatchUpState,\n});\n\nexport { askEngine as scoringEngine };\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Usage:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"import { scoringEngine } from './scoringEngine';\n\nscoringEngine.setState(tournamentRecord);\n\n// Only scoring methods available\nscoringEngine.setMatchUpStatus({\n  matchUpId: 'match-1',\n  outcome: { score: { sets: [{ side1Score: 6, side2Score: 4 }] } }\n}); // \u2705 Works\n\nscoringEngine.generateDrawDefinition({ drawSize: 32 }); // \u274c Not available\n")),(0,o.yg)("hr",null),(0,o.yg)("h3",{id:"importing-nested-methods"},"Importing Nested Methods"),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"importMethods")," function can traverse nested objects to import all methods:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"import { governors, syncEngine } from 'tods-competition-factory';\n\n// Import all methods from all governors (full engine)\nsyncEngine.importMethods(governors, true, 1);\n// Parameters: (object, traverse=true, maxDepth=1)\n\nexport { syncEngine as fullEngine };\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Traversal Parameters:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"traverse: false")," - Only import methods at the current level"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"traverse: true, maxDepth: 1")," - Import from nested objects (1 level deep)"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"traverse: true, maxDepth: 2")," - Import from deeply nested objects")),(0,o.yg)("hr",null),(0,o.yg)("h2",{id:"real-world-examples"},"Real-World Examples"),(0,o.yg)("h3",{id:"client-side-scoring-app"},"Client-Side Scoring App"),(0,o.yg)("p",null,"Minimize bundle for browser-based live scoring:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// src/engines/clientEngine.ts\nimport { governors, syncEngine } from 'tods-competition-factory';\n\n// Only import what's needed for live scoring UI\nsyncEngine.importMethods({\n  // State management\n  setState: governors.queryGovernor.setState,\n  getState: governors.queryGovernor.getState,\n  \n  // Queries for display\n  allTournamentMatchUps: governors.queryGovernor.allTournamentMatchUps,\n  getMatchUp: governors.queryGovernor.getMatchUp,\n  \n  // Score entry\n  setMatchUpStatus: governors.matchUpGovernor.setMatchUpStatus,\n  \n  // Score validation\n  validateSetScore: governors.scoreGovernor.validateSetScore,\n  validateMatchUpScore: governors.scoreGovernor.validateMatchUpScore,\n});\n\nexport { syncEngine as clientEngine };\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Result:")," 75% smaller bundle than full tournamentEngine"),(0,o.yg)("hr",null),(0,o.yg)("h3",{id:"server-side-tournament-admin-api"},"Server-Side Tournament Admin API"),(0,o.yg)("p",null,"Full-featured engine for administrative operations:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// src/engines/adminEngine.ts\nimport { governors, syncEngine } from 'tods-competition-factory';\n\n// Import all governors for full admin capabilities\nsyncEngine.importMethods(governors, true, 1);\n\n// Add custom admin-only methods\nsyncEngine.getAdminStats = function() {\n  const { participants } = this.getParticipants();\n  const { events } = this.getEvents();\n  const { venues } = this.getVenues();\n  return {\n    participantCount: participants?.length || 0,\n    eventCount: events?.length || 0,\n    venueCount: venues?.length || 0,\n  };\n};\n\nexport { syncEngine as adminEngine };\n")),(0,o.yg)("hr",null),(0,o.yg)("h3",{id:"microservice-specific-engines"},"Microservice-Specific Engines"),(0,o.yg)("p",null,"Create engines tailored to specific microservices:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// scheduling-service/engine.ts - Only scheduling methods\nimport { governors, syncEngine } from 'tods-competition-factory';\n\nsyncEngine.importMethods({\n  // State\n  setState: governors.queryGovernor.setState,\n  \n  // Queries\n  allTournamentMatchUps: governors.queryGovernor.allTournamentMatchUps,\n  getVenuesAndCourts: governors.queryGovernor.getVenuesAndCourts,\n  \n  // Scheduling mutations\n  bulkScheduleTournamentMatchUps: governors.scheduleGovernor.bulkScheduleTournamentMatchUps,\n  scheduleMatchUps: governors.scheduleGovernor.scheduleMatchUps,\n  clearScheduledMatchUps: governors.scheduleGovernor.clearScheduledMatchUps,\n});\n\nexport { syncEngine as schedulingEngine };\n")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// draw-generation-service/engine.ts - Only draw generation  \n// Use syncEngine singleton configured once at startup\nimport { governors, syncEngine } from 'tods-competition-factory';\n\nsyncEngine.importMethods({\n  setState: governors.queryGovernor.setState,\n  addEvent: governors.eventGovernor.addEvent,\n  generateDrawDefinition: governors.generationGovernor.generateDrawDefinition,\n  automatedPositioning: governors.drawsGovernor.automatedPositioning,\n});\n\nexport { syncEngine as drawEngine };\n")),(0,o.yg)("hr",null),(0,o.yg)("h2",{id:"method-import-patterns"},"Method Import Patterns"),(0,o.yg)("h3",{id:"selective-import-recommended"},"Selective Import (Recommended)"),(0,o.yg)("p",null,"Explicitly list needed methods for maximum control:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"syncEngine.importMethods({\n  setState: governors.queryGovernor.setState,\n  getParticipants: governors.queryGovernor.getParticipants,\n  addEvent: governors.eventGovernor.addEvent,\n});\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Pros:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Smallest bundle size"),(0,o.yg)("li",{parentName:"ul"},"Clear dependencies"),(0,o.yg)("li",{parentName:"ul"},"Easy to audit what's included")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Cons:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"More verbose"),(0,o.yg)("li",{parentName:"ul"},"Must update when adding features")),(0,o.yg)("h3",{id:"governor-import"},"Governor Import"),(0,o.yg)("p",null,"Import entire governor for related functionality:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// Import all query methods\nsyncEngine.importMethods(governors.queryGovernor);\n\n// Import all event methods\nsyncEngine.importMethods(governors.eventGovernor);\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Pros:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Balanced bundle size"),(0,o.yg)("li",{parentName:"ul"},"Related methods grouped"),(0,o.yg)("li",{parentName:"ul"},"Less maintenance")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Cons:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"May include unused methods from governor")),(0,o.yg)("h3",{id:"full-import"},"Full Import"),(0,o.yg)("p",null,"Import everything for maximum flexibility:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"syncEngine.importMethods(governors, true, 1);\n")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Pros:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"All functionality available"),(0,o.yg)("li",{parentName:"ul"},"No method missing errors"),(0,o.yg)("li",{parentName:"ul"},"Fastest development")),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Cons:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Largest bundle size"),(0,o.yg)("li",{parentName:"ul"},"Includes unused code")),(0,o.yg)("hr",null),(0,o.yg)("h2",{id:"typescript-support"},"TypeScript Support"),(0,o.yg)("p",null,"Custom engines maintain full type safety:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-ts"},"import { governors, syncEngine } from 'tods-competition-factory';\nimport type { FactoryEngine } from 'tods-competition-factory';\n\n// Type-safe custom engine\nsyncEngine.importMethods(governors.queryGovernor);\n\nexport { syncEngine as queryEngine };\n\n// IntelliSense works for imported methods\nqueryEngine.getParticipants(); // \u2705 Autocomplete available\nqueryEngine.addEvent({}); // \u274c TypeScript error: method not imported\n")),(0,o.yg)("hr",null),(0,o.yg)("h2",{id:"performance-comparison"},"Performance Comparison"),(0,o.yg)("p",null,"Bundle sizes for different import strategies (gzipped):"),(0,o.yg)("table",null,(0,o.yg)("thead",{parentName:"table"},(0,o.yg)("tr",{parentName:"thead"},(0,o.yg)("th",{parentName:"tr",align:null},"Engine Configuration"),(0,o.yg)("th",{parentName:"tr",align:null},"Bundle Size"),(0,o.yg)("th",{parentName:"tr",align:null},"Use Case"))),(0,o.yg)("tbody",{parentName:"table"},(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Selective (5 methods)"),(0,o.yg)("td",{parentName:"tr",align:null},"~15 KB"),(0,o.yg)("td",{parentName:"tr",align:null},"Minimal client app")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Query Governor"),(0,o.yg)("td",{parentName:"tr",align:null},"~45 KB"),(0,o.yg)("td",{parentName:"tr",align:null},"Read-only display")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Mutation Governor"),(0,o.yg)("td",{parentName:"tr",align:null},"~60 KB"),(0,o.yg)("td",{parentName:"tr",align:null},"Specific mutations")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Full Engine"),(0,o.yg)("td",{parentName:"tr",align:null},"~180 KB"),(0,o.yg)("td",{parentName:"tr",align:null},"Complete functionality")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Pre-built tournamentEngine"),(0,o.yg)("td",{parentName:"tr",align:null},"~180 KB"),(0,o.yg)("td",{parentName:"tr",align:null},"Backward compatibility")))),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Recommendation:")," Start with selective imports and add methods as needed."),(0,o.yg)("hr",null),(0,o.yg)("h2",{id:"migration-from-v1x"},"Migration from v1.x"),(0,o.yg)("p",null,"If migrating from Competition Factory v1.x:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// v1.x - Pre-built engine\nimport { tournamentEngine } from 'tods-competition-factory';\n\n// v2.x - Custom engine (same functionality)\nimport { governors, syncEngine } from 'tods-competition-factory';\nsyncEngine.importMethods(governors, true, 1);\nexport const tournamentEngine = syncEngine;\n")),(0,o.yg)("p",null,"Or continue using the pre-built exports:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-js"},"// Still works in v2.x for backward compatibility\nimport { tournamentEngine } from 'tods-competition-factory';\n")),(0,o.yg)("hr",null))}u.isMDXComponent=!0}}]);
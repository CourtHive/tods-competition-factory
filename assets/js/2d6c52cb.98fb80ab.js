"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[9298],{6537(e,i,s){s.r(i),s.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"concepts/exit-profiles","title":"Exit Profiles","description":"Overview","source":"@site/docs/concepts/exit-profiles.md","sourceDirName":"concepts","slug":"/concepts/exit-profiles","permalink":"/competition-factory/docs/concepts/exit-profiles","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Exit Profiles"},"sidebar":"docs","previous":{"title":"Draw Types","permalink":"/competition-factory/docs/concepts/draw-types"},"next":{"title":"Finishing Positions","permalink":"/competition-factory/docs/concepts/finishing-positions"}}');var t=s(6070),n=s(8322);const o={title:"Exit Profiles"},l=void 0,c={},d=[{value:"Overview",id:"overview",level:2},{value:"Format",id:"format",level:2},{value:"Example: Compass Draw",id:"example-compass-draw",level:2},{value:"Example: Feed-In Championship",id:"example-feed-in-championship",level:2},{value:"How Exit Profiles Are Built",id:"how-exit-profiles-are-built",level:2},{value:"Exit Profiles and Structure Generation",id:"exit-profiles-and-structure-generation",level:2},{value:"Stages and Exit Profiles",id:"stages-and-exit-profiles",level:2},{value:"API",id:"api",level:2},{value:"<code>getExitProfiles({ drawDefinition })</code>",id:"getexitprofiles-drawdefinition-",level:3},{value:"Related",id:"related",level:3}];function a(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(i.p,{children:["An ",(0,t.jsx)(i.strong,{children:"exit profile"})," is a string that encodes the path a participant took through a draw's linked structures before arriving at their current structure. Exit profiles are the mechanism by which the factory traces how participants flow between structures \u2014 from a main draw through consolation rounds, playoff brackets, or compass directions."]}),"\n",(0,t.jsxs)(i.p,{children:["Exit profiles are computed by ",(0,t.jsx)(i.code,{children:"getExitProfiles()"})," and are used internally to:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Build ",(0,t.jsx)(i.a,{href:"./finishing-positions",children:"finishing position"})," ranges across multi-structure draws"]}),"\n",(0,t.jsx)(i.li,{children:"Name structures in playoff and compass-style draws"}),"\n",(0,t.jsx)(i.li,{children:"Determine which playoff structures to generate for a given exit path"}),"\n",(0,t.jsx)(i.li,{children:"Map positions between source and target structures"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"format",children:"Format"}),"\n",(0,t.jsx)(i.p,{children:"An exit profile is a hyphen-separated string of round numbers representing the chain of link traversals from the initial structure of a stage:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-text",children:'"0"          \u2192 the initial structure itself\n"0-1"        \u2192 reached via losers from round 1 of the initial structure\n"0-2"        \u2192 reached via losers from round 2 of the initial structure\n"0-1-1"      \u2192 reached via losers from round 1 of the "0-1" structure\n"0-1-1-1"    \u2192 one more level deep\n'})}),"\n",(0,t.jsxs)(i.p,{children:["The first segment is always ",(0,t.jsx)(i.code,{children:'"0"'})," (the root). Each subsequent segment is the source round number from the parent structure's link."]}),"\n",(0,t.jsx)(i.h2,{id:"example-compass-draw",children:"Example: Compass Draw"}),"\n",(0,t.jsx)(i.p,{children:"A COMPASS draw with 32 players produces 8 structures. Their exit profiles map directly to compass directions:"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Exit Profile"}),(0,t.jsx)(i.th,{children:"Structure"}),(0,t.jsx)(i.th,{children:"How participants arrive"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0"})}),(0,t.jsx)(i.td,{children:"East (Main)"}),(0,t.jsx)(i.td,{children:"Direct entry"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-1"})}),(0,t.jsx)(i.td,{children:"West"}),(0,t.jsx)(i.td,{children:"Round 1 losers from East"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-2"})}),(0,t.jsx)(i.td,{children:"North"}),(0,t.jsx)(i.td,{children:"Round 2 losers from East"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-3"})}),(0,t.jsx)(i.td,{children:"Northeast"}),(0,t.jsx)(i.td,{children:"Round 3 losers from East"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-1-1"})}),(0,t.jsx)(i.td,{children:"South"}),(0,t.jsx)(i.td,{children:"Round 1 losers from West"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-1-2"})}),(0,t.jsx)(i.td,{children:"Southwest"}),(0,t.jsx)(i.td,{children:"Round 2 losers from West"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-2-1"})}),(0,t.jsx)(i.td,{children:"Northwest"}),(0,t.jsx)(i.td,{children:"Round 1 losers from North"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"0-1-1-1"})}),(0,t.jsx)(i.td,{children:"Southeast"}),(0,t.jsx)(i.td,{children:"Round 1 losers from South"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"COMPASS_ATTRIBUTES"})," constant maps these exit profiles to structure names and abbreviations."]}),"\n",(0,t.jsx)(i.h2,{id:"example-feed-in-championship",children:"Example: Feed-In Championship"}),"\n",(0,t.jsx)(i.p,{children:"In a feed-in championship, the main structure feeds losers from each round into a consolation structure. The exit profiles look different because the consolation is a single structure receiving multiple feed rounds:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-text",children:'Main:         exitProfile = "0"\nConsolation:  exitProfiles = ["0-1", "0-2", "0-3", ...]\n'})}),"\n",(0,t.jsxs)(i.p,{children:["A consolation structure can have ",(0,t.jsx)(i.strong,{children:"multiple exit profiles"})," \u2014 one for each round that feeds into it. This is how the system knows that a single consolation structure receives participants from rounds 1, 2, and 3 of the main draw."]}),"\n",(0,t.jsx)(i.h2,{id:"how-exit-profiles-are-built",children:"How Exit Profiles Are Built"}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"getExitProfiles()"})," function in ",(0,t.jsx)(i.code,{children:"src/query/drawDefinition/getExitProfile.ts"})," builds exit profiles by:"]}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Grouping structures by stage"})," \u2014 MAIN, QUALIFYING, CONSOLATION, PLAY_OFF, etc."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Finding the initial structure"})," for each stage (the one with ",(0,t.jsx)(i.code,{children:"stageSequence === 1"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Recursively traversing links"})," from each initial structure, building the exit profile string as it goes"]}),"\n"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-ts",children:"// Simplified traversal logic\nfunction addExitProfiles({ structureId, exitProfile, stage }) {\n  exitProfiles[structureId].push(exitProfile);\n\n  // Follow all outgoing links from this structure\n  for (const link of relevantLinks) {\n    addExitProfiles({\n      structureId: link.target.structureId,\n      exitProfile: `${exitProfile}-${link.source.roundNumber}`,\n      stage: targetStructure.stage,\n    });\n  }\n}\n"})}),"\n",(0,t.jsxs)(i.p,{children:["The initial structure of CONSOLATION and PLAY_OFF stages does ",(0,t.jsx)(i.strong,{children:"not"})," record the ",(0,t.jsx)(i.code,{children:'"0"'})," exit profile for itself (line 49). This is because these structures are always reached via links from another stage \u2014 their ",(0,t.jsx)(i.code,{children:'"0"'})," would be meaningless."]}),"\n",(0,t.jsx)(i.h2,{id:"exit-profiles-and-structure-generation",children:"Exit Profiles and Structure Generation"}),"\n",(0,t.jsxs)(i.p,{children:["When generating multi-structure draws like COMPASS or PLAYOFF, the ",(0,t.jsx)(i.code,{children:"generatePlayoffStructures()"})," function uses exit profiles to:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Name structures"}),": The ",(0,t.jsx)(i.code,{children:"playoffAttributes"})," map is keyed by exit profile (e.g., ",(0,t.jsx)(i.code,{children:"COMPASS_ATTRIBUTES['0-1']"})," gives ",(0,t.jsx)(i.code,{children:"{ name: 'West', abbreviation: 'W' }"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Control depth"}),": The ",(0,t.jsx)(i.code,{children:"exitProfileLimit"})," parameter can restrict which exit profiles generate structures"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Track finishing positions"}),": Each child structure's ",(0,t.jsx)(i.code,{children:"finishingPositionOffset"})," is computed from its position in the exit profile tree"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"stages-and-exit-profiles",children:"Stages and Exit Profiles"}),"\n",(0,t.jsxs)(i.p,{children:["Exit profiles interact with ",(0,t.jsx)(i.a,{href:"./draw-types#stages-organizing-structures",children:"stages"})," in an important way:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"MAIN"})," structures get exit profiles starting from ",(0,t.jsx)(i.code,{children:'"0"'})]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"PLAY_OFF"})," and ",(0,t.jsx)(i.strong,{children:"CONSOLATION"})," structures skip the ",(0,t.jsx)(i.code,{children:'"0"'})," profile for their initial structure, since they're reached through links"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"QUALIFYING"})," structures have their own independent exit profile tree"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["In draws like COMPASS and OLYMPIC, the root structure (East) has ",(0,t.jsx)(i.code,{children:"stage: MAIN"})," while all secondary structures have ",(0,t.jsx)(i.code,{children:"stage: PLAY_OFF"}),". Exit profiles are still built correctly because the traversal follows links regardless of stage boundaries."]}),"\n",(0,t.jsx)(i.h2,{id:"api",children:"API"}),"\n",(0,t.jsx)(i.h3,{id:"getexitprofiles-drawdefinition-",children:(0,t.jsx)(i.code,{children:"getExitProfiles({ drawDefinition })"})}),"\n",(0,t.jsx)(i.p,{children:"Returns a map of structure IDs to their exit profile arrays:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-ts",children:"const { exitProfiles } = getExitProfiles({ drawDefinition });\n// exitProfiles = {\n//   'struct-east-id': ['0'],\n//   'struct-west-id': ['0-1'],\n//   'struct-north-id': ['0-2'],\n//   ...\n// }\n"})}),"\n",(0,t.jsx)(i.h3,{id:"related",children:"Related"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.a,{href:"./finishing-positions",children:"Finishing Positions"})})," \u2014 How exit profiles feed into finishing position calculations"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:(0,t.jsx)(i.a,{href:"./draw-types",children:"Draw Types"})})," \u2014 Pre-defined draw types and their structure topologies"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8322(e,i,s){s.d(i,{R:()=>o,x:()=>l});var r=s(758);const t={},n=r.createContext(t);function o(e){const i=r.useContext(n);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(n.Provider,{value:i},e.children)}}}]);
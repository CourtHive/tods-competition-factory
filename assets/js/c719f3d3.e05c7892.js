"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[8449],{1411(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"concepts/publishing/publishing-embargo","title":"Embargo and Scheduled Rounds","description":"Embargo","source":"@site/docs/concepts/publishing/publishing-embargo.md","sourceDirName":"concepts/publishing","slug":"/concepts/publishing/publishing-embargo","permalink":"/competition-factory/docs/concepts/publishing/publishing-embargo","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Embargo and Scheduled Rounds"},"sidebar":"docs","previous":{"title":"Participants","permalink":"/competition-factory/docs/concepts/publishing/publishing-participants"},"next":{"title":"Data and Subscriptions","permalink":"/competition-factory/docs/concepts/publishing/publishing-data-subscriptions"}}');var r=s(6070),t=s(8322);const l={title:"Embargo and Scheduled Rounds"},d=void 0,a={},o=[{value:"Embargo",id:"embargo",level:2},{value:"Why Embargo?",id:"why-embargo",level:3},{value:"How Embargo Works",id:"how-embargo-works",level:3},{value:"Embargo Levels",id:"embargo-levels",level:3},{value:"Draw-Level Embargo",id:"draw-level-embargo",level:4},{value:"Stage-Level Embargo",id:"stage-level-embargo",level:4},{value:"Structure-Level Embargo",id:"structure-level-embargo",level:4},{value:"Order of Play Embargo",id:"order-of-play-embargo",level:4},{value:"Participants Embargo",id:"participants-embargo",level:4},{value:"Admin vs Public Behavior",id:"admin-vs-public-behavior",level:3},{value:"Querying Embargo Status",id:"querying-embargo-status",level:3},{value:"Embargo Validation",id:"embargo-validation",level:3},{value:"Validating embargo values directly",id:"validating-embargo-values-directly",level:4},{value:"Converting wall-clock time to UTC embargo strings",id:"converting-wall-clock-time-to-utc-embargo-strings",level:4},{value:"Embargo Expiry",id:"embargo-expiry",level:3},{value:"Embargo Workflow Example",id:"embargo-workflow-example",level:3},{value:"Scheduled Rounds",id:"scheduled-rounds",level:2},{value:"roundLimit Behavior",id:"roundlimit-behavior",level:3},{value:"Per-Round Schedule Control",id:"per-round-schedule-control",level:3},{value:"Interaction Rules",id:"interaction-rules",level:3},{value:"Scheduled Rounds Workflow",id:"scheduled-rounds-workflow",level:3}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"embargo",children:"Embargo"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Embargo"})," is a time-based visibility gate that extends the publishing system. When an embargo timestamp is set on any publishable element, the element is stored as ",(0,r.jsx)(n.code,{children:"published: true"})," but remains ",(0,r.jsx)(n.strong,{children:"hidden from public-facing queries"})," until the embargo time passes. No additional mutation or cron job is needed \u2014 visibility changes automatically when the system clock passes the embargo timestamp."]}),"\n",(0,r.jsx)(n.h3,{id:"why-embargo",children:"Why Embargo?"}),"\n",(0,r.jsxs)(n.p,{children:["Embargoes solve a common tournament operations challenge: the need to ",(0,r.jsx)(n.strong,{children:"prepare and finalize"})," publish state ahead of time while controlling ",(0,r.jsx)(n.strong,{children:"exactly when"})," the public sees the data."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common scenarios:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Media coordination"}),": Schedule draw release for a specific press conference time"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Staged rollout"}),": Publish qualifying draws immediately, embargo main draw until the next morning"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Schedule preparation"}),": Finalize the order of play internally and set it to go live at a specific hour"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Participant announcements"}),": Coordinate participant list release with marketing campaigns"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"how-embargo-works",children:"How Embargo Works"}),"\n",(0,r.jsxs)(n.p,{children:["Embargo adds an optional ",(0,r.jsx)(n.code,{children:"embargo"})," field (ISO 8601 timestamp string) to the ",(0,r.jsx)(n.code,{children:"PublishingDetail"})," type used across the publishing system:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type ScheduledRoundDetail = {\n  published?: boolean;\n  embargo?: string; // ISO 8601 timestamp\n};\n\ntype PublishingDetail = {\n  scheduledRounds?: { [roundNumber: number]: ScheduledRoundDetail };\n  roundLimit?: number; // only applicable to structureDetails\n  published?: boolean;\n  embargo?: string; // ISO 8601 timestamp \u2014 content hidden until this time\n};\n"})}),"\n",(0,r.jsx)(n.p,{children:"The enforcement logic is:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"published"})," is ",(0,r.jsx)(n.code,{children:"false"}),", the element is ",(0,r.jsx)(n.strong,{children:"hidden"})," (embargo is irrelevant)"]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"published"})," is ",(0,r.jsx)(n.code,{children:"true"})," and there is ",(0,r.jsx)(n.strong,{children:"no embargo"})," (or the embargo is not a valid ISO date), the element is ",(0,r.jsx)(n.strong,{children:"visible"})," (backward compatible)"]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"published"})," is ",(0,r.jsx)(n.code,{children:"true"})," and the embargo is a ",(0,r.jsx)(n.strong,{children:"future"})," timestamp, the element is ",(0,r.jsx)(n.strong,{children:"hidden"})]}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"published"})," is ",(0,r.jsx)(n.code,{children:"true"})," and the embargo is a ",(0,r.jsx)(n.strong,{children:"past"})," timestamp, the element is ",(0,r.jsx)(n.strong,{children:"visible"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"embargo-levels",children:"Embargo Levels"}),"\n",(0,r.jsx)(n.p,{children:"Embargoes can be applied at every level of the publish hierarchy:"}),"\n",(0,r.jsx)(n.h4,{id:"draw-level-embargo",children:"Draw-Level Embargo"}),"\n",(0,r.jsx)(n.p,{children:"Hides an entire draw from public queries until the embargo passes."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"engine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: {\n        published: true,\n        embargo: '2024-06-15T10:00:00Z',\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Reference:"})," ",(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#publishevent",children:"publishEvent"})]}),"\n",(0,r.jsx)(n.h4,{id:"stage-level-embargo",children:"Stage-Level Embargo"}),"\n",(0,r.jsx)(n.p,{children:"Hides a specific stage (e.g. QUALIFYING, MAIN) while other stages remain visible."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"engine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: { published: true },\n      stageDetails: {\n        QUALIFYING: { published: true }, // visible immediately\n        MAIN: { published: true, embargo: '2024-06-16T08:00:00Z' }, // hidden until 8am\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Reference:"})," ",(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#publishevent",children:"publishEvent"})]}),"\n",(0,r.jsx)(n.h4,{id:"structure-level-embargo",children:"Structure-Level Embargo"}),"\n",(0,r.jsx)(n.p,{children:"Hides a specific structure within a draw."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"engine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: { published: true },\n      structureDetails: {\n        [structureId]: { published: true, embargo: '2024-06-15T14:00:00Z' },\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Reference:"})," ",(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#publishevent",children:"publishEvent"})]}),"\n",(0,r.jsx)(n.h4,{id:"order-of-play-embargo",children:"Order of Play Embargo"}),"\n",(0,r.jsx)(n.p,{children:"Hides the published schedule until the embargo passes."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"engine.publishOrderOfPlay({\n  scheduledDates: ['2024-06-15'],\n  embargo: '2024-06-14T18:00:00Z', // schedule visible after 6pm the day before\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["When embargoed, ",(0,r.jsx)(n.code,{children:"competitionScheduleMatchUps({ usePublishState: true })"})," returns empty ",(0,r.jsx)(n.code,{children:"dateMatchUps"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Reference:"})," ",(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#publishorderofplay",children:"publishOrderOfPlay"}),", ",(0,r.jsx)(n.a,{href:"/docs/governors/query-governor#competitionschedulematchups",children:"competitionScheduleMatchUps"})]}),"\n",(0,r.jsx)(n.h4,{id:"participants-embargo",children:"Participants Embargo"}),"\n",(0,r.jsx)(n.p,{children:"Hides the participant list until the embargo passes."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"engine.publishParticipants({\n  embargo: '2024-06-10T09:00:00Z',\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Reference:"})," ",(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#publishparticipants",children:"publishParticipants"})]}),"\n",(0,r.jsx)(n.h3,{id:"admin-vs-public-behavior",children:"Admin vs Public Behavior"}),"\n",(0,r.jsxs)(n.p,{children:["Embargo enforcement applies only to ",(0,r.jsx)(n.strong,{children:"public-facing query paths"})," \u2014 methods called with ",(0,r.jsx)(n.code,{children:"usePublishState: true"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Embargo enforced?"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/governors/query-governor#geteventdata",children:(0,r.jsx)(n.code,{children:"getEventData"})})}),(0,r.jsxs)(n.td,{children:["Yes (when ",(0,r.jsx)(n.code,{children:"usePublishState: true"}),")"]}),(0,r.jsx)(n.td,{children:"Filters draws, stages, structures"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/governors/query-governor#competitionschedulematchups",children:(0,r.jsx)(n.code,{children:"competitionScheduleMatchUps"})})}),(0,r.jsxs)(n.td,{children:["Yes (when ",(0,r.jsx)(n.code,{children:"usePublishState: true"}),")"]}),(0,r.jsx)(n.td,{children:"Filters orderOfPlay and matchUps"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#getdrawdata",children:(0,r.jsx)(n.code,{children:"getDrawData"})})}),(0,r.jsxs)(n.td,{children:["Yes (when ",(0,r.jsx)(n.code,{children:"usePublishState: true"}),")"]}),(0,r.jsx)(n.td,{children:"Filters structures"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#getpublishstate",children:(0,r.jsx)(n.code,{children:"getPublishState"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"No"})}),(0,r.jsx)(n.td,{children:"Reports full publish config including embargo metadata"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"getPublishState"})})," is the ",(0,r.jsx)(n.strong,{children:"admin/reporting"})," function. It intentionally ",(0,r.jsx)(n.strong,{children:"ignores"})," embargo timestamps so that admin clients (like TMX) can see:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Which elements are published"}),"\n",(0,r.jsx)(n.li,{children:"Which have active embargoes"}),"\n",(0,r.jsx)(n.li,{children:"When each embargo expires"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:'This is essential for admin UIs \u2014 an organizer who sets a future embargo needs to see the element as "published (embargoed until X)" rather than "unpublished."'}),"\n",(0,r.jsx)(n.h3,{id:"querying-embargo-status",children:"Querying Embargo Status"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"getPublishState()"})," returns an ",(0,r.jsx)(n.code,{children:"embargoes"})," array when any embargoes exist:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const { publishState } = engine.getPublishState();\n\n// publishState.embargoes is an array when embargoes are present\npublishState.embargoes?.forEach(({ type, id, embargo, embargoActive }) => {\n  console.log(`${type} ${id ?? ''}: embargo ${embargo}, active: ${embargoActive}`);\n});\n\n// Example embargoes array:\n// [\n//   { type: 'draw', id: 'drawId1', embargo: '2024-06-15T10:00:00Z', embargoActive: true },\n//   { type: 'stage', id: 'drawId1:QUALIFYING', embargo: '2024-06-14T08:00:00Z', embargoActive: false },\n//   { type: 'structure', id: 'structureId1', embargo: '2024-06-15T14:00:00Z', embargoActive: true },\n//   { type: 'scheduledRound', id: 'structureId1:round2', embargo: '2024-06-16T08:00:00Z', embargoActive: true },\n//   { type: 'orderOfPlay', embargo: '2024-06-14T18:00:00Z', embargoActive: true },\n//   { type: 'participants', embargo: '2024-06-10T09:00:00Z', embargoActive: false },\n// ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API Reference:"})," ",(0,r.jsx)(n.a,{href:"/docs/governors/publishing-governor#getpublishstate",children:"getPublishState"})]}),"\n",(0,r.jsx)(n.p,{children:"Each entry contains:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"type"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"'draw'"}),", ",(0,r.jsx)(n.code,{children:"'stage'"}),", ",(0,r.jsx)(n.code,{children:"'structure'"}),", ",(0,r.jsx)(n.code,{children:"'scheduledRound'"}),", ",(0,r.jsx)(n.code,{children:"'orderOfPlay'"}),", or ",(0,r.jsx)(n.code,{children:"'participants'"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"id"})}),(0,r.jsx)(n.td,{children:"string?"}),(0,r.jsxs)(n.td,{children:["Identifier (drawId, ",(0,r.jsx)(n.code,{children:"drawId:stage"}),", structureId, ",(0,r.jsx)(n.code,{children:"structureId:roundN"}),"). Absent for tournament-level types."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"embargo"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"ISO 8601 timestamp"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"embargoActive"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"true"})," if the embargo is still in the future"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"embargo-validation",children:"Embargo Validation"}),"\n",(0,r.jsxs)(n.p,{children:["The factory ",(0,r.jsx)(n.strong,{children:"enforces"})," that all embargo values include a timezone indicator \u2014 either a ",(0,r.jsx)(n.code,{children:"Z"})," suffix (UTC) or an explicit offset like ",(0,r.jsx)(n.code,{children:"+05:30"})," or ",(0,r.jsx)(n.code,{children:"-04:00"}),". A bare datetime string like ",(0,r.jsx)(n.code,{children:"'2025-06-20T12:00:00'"})," (no timezone) is ",(0,r.jsx)(n.strong,{children:"rejected"})," with an ",(0,r.jsx)(n.code,{children:"INVALID_EMBARGO"})," error."]}),"\n",(0,r.jsx)(n.p,{children:"This validation is applied in all publishing methods that accept embargo values:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"publishEvent"})," \u2014 validates embargo in ",(0,r.jsx)(n.code,{children:"publishingDetail"}),", ",(0,r.jsx)(n.code,{children:"stageDetails"}),", ",(0,r.jsx)(n.code,{children:"structureDetails"}),", and ",(0,r.jsx)(n.code,{children:"scheduledRounds"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"publishOrderOfPlay"})," \u2014 validates the top-level ",(0,r.jsx)(n.code,{children:"embargo"})," parameter"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"publishParticipants"})," \u2014 validates the top-level ",(0,r.jsx)(n.code,{children:"embargo"})," parameter"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// \u2713 Valid embargo values\n'2024-06-15T10:00:00Z'; // UTC (Z suffix)\n'2024-06-15T10:00:00+05:30'; // Explicit positive offset\n'2024-06-15T06:00:00-04:00'; // Explicit negative offset\n\n// \u2717 Invalid \u2014 rejected with INVALID_EMBARGO error\n'2024-06-15T10:00:00'; // No timezone indicator\n'2024-06-15'; // Date only\n'June 15, 2024'; // Non-ISO format\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Why this matters:"})," A bare ",(0,r.jsx)(n.code,{children:"'2024-06-15T10:00:00'"})," is interpreted differently depending on the runtime's local timezone. A client in EST setting an embargo would have that embargo interpreted 5 hours earlier by a server running in UTC. Requiring timezone context makes embargo behavior identical regardless of where the code executes."]}),"\n",(0,r.jsx)(n.h4,{id:"validating-embargo-values-directly",children:"Validating embargo values directly"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"isValidEmbargoDate"})," utility function is available for pre-validating embargo strings before passing them to publishing methods:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"import { tools } from 'tods-competition-factory';\n\ntools.dateTime.isValidEmbargoDate('2024-06-15T10:00:00Z'); // true\ntools.dateTime.isValidEmbargoDate('2024-06-15T10:00:00'); // false\n"})}),"\n",(0,r.jsx)(n.h4,{id:"converting-wall-clock-time-to-utc-embargo-strings",children:"Converting wall-clock time to UTC embargo strings"}),"\n",(0,r.jsxs)(n.p,{children:["When a tournament operates in a specific timezone (set via ",(0,r.jsx)(n.code,{children:"localTimeZone"})," on the tournament record), use ",(0,r.jsx)(n.code,{children:"toEmbargoUTC"})," to convert a local wall-clock time to a valid UTC embargo string:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"import { tools } from 'tods-competition-factory';\n\n// Convert \"8:00 AM Eastern\" on June 15 to a UTC embargo string\nconst embargo = tools.timeZone.toEmbargoUTC('2024-06-15', '08:00', 'America/New_York');\n// Result: '2024-06-15T12:00:00.000Z' (EDT is UTC-4 in June)\n\n// Use the result directly in publishEvent\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: { published: true, embargo },\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/concepts/date-time-handling",children:"Date and Time Handling"})," for the complete timezone utility reference."]}),"\n",(0,r.jsx)(n.h3,{id:"embargo-expiry",children:"Embargo Expiry"}),"\n",(0,r.jsx)(n.p,{children:"Embargoes are evaluated at query time \u2014 there is no background process. When the system clock passes the embargo timestamp, the content automatically becomes visible on the next query. This means:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No cron jobs needed"})," \u2014 visibility is always current"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No second mutation needed"})," \u2014 the embargo is self-resolving"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Time zone safety"})," \u2014 all embargo values are validated to include timezone context, ensuring consistent behavior across clients and servers regardless of their local timezone"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"embargo-workflow-example",children:"Embargo Workflow Example"}),"\n",(0,r.jsx)(n.p,{children:"A typical tournament workflow using embargoes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"import { stageConstants } from 'tods-competition-factory';\n\n// 1. Monday: Publish qualifying draw immediately, embargo main draw until Wednesday 9am\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: { published: true },\n      stageDetails: {\n        [stageConstants.QUALIFYING]: { published: true },\n        [stageConstants.MAIN]: { published: true, embargo: '2024-06-12T09:00:00Z' },\n      },\n    },\n  },\n});\n\n// 2. Monday: Schedule ready \u2014 embargo until Tuesday evening\nengine.publishOrderOfPlay({\n  scheduledDates: ['2024-06-11', '2024-06-12'],\n  embargo: '2024-06-10T18:00:00Z',\n});\n\n// 3. Admin UI checks status\nconst { publishState } = engine.getPublishState();\n// publishState.embargoes shows both active embargoes with their expiry times\n\n// 4. No further action needed \u2014 embargoes resolve automatically\n"})}),"\n",(0,r.jsx)(n.h2,{id:"scheduled-rounds",children:"Scheduled Rounds"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Scheduled Rounds"})," provide per-round control over which rounds' matchUps appear in the published schedule. This works in conjunction with ",(0,r.jsx)(n.code,{children:"roundLimit"})," and embargo to enable progressive schedule disclosure."]}),"\n",(0,r.jsx)(n.h3,{id:"roundlimit-behavior",children:"roundLimit Behavior"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"roundLimit"})," behaves differently depending on draw type:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AD_HOC draws"}),": ",(0,r.jsx)(n.code,{children:"roundLimit"})," filters both the bracket (draw data in ",(0,r.jsx)(n.code,{children:"getEventData"}),") and the schedule (",(0,r.jsx)(n.code,{children:"competitionScheduleMatchUps"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Non-AD_HOC draws"})," (elimination, round robin, etc.): ",(0,r.jsx)(n.code,{children:"roundLimit"})," filters the ",(0,r.jsx)(n.strong,{children:"schedule only"}),". The bracket always shows all rounds because future rounds in elimination draws represent the structure, not yet-generated matchUps."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"per-round-schedule-control",children:"Per-Round Schedule Control"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"scheduledRounds"})," within ",(0,r.jsx)(n.code,{children:"structureDetails"})," for granular control:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"engine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          published: true,\n          roundLimit: 3, // schedule ceiling: rounds 1-3\n          scheduledRounds: {\n            1: { published: true }, // round 1 visible in schedule\n            2: { published: true, embargo: '2024-06-16T08:00:00Z' }, // round 2 embargoed\n            // round 3 not listed \u2192 hidden from schedule\n          },\n        },\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"interaction-rules",children:"Interaction Rules"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"roundLimit"})," is always the ceiling"]})," \u2014 rounds above ",(0,r.jsx)(n.code,{children:"roundLimit"})," never appear in the schedule, regardless of ",(0,r.jsx)(n.code,{children:"scheduledRounds"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"scheduledRounds"})," gates within the ceiling"]})," \u2014 within the rounds allowed by ",(0,r.jsx)(n.code,{children:"roundLimit"}),", only rounds listed in ",(0,r.jsx)(n.code,{children:"scheduledRounds"})," with ",(0,r.jsx)(n.code,{children:"{ published: true }"})," (and past embargo) appear"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["When ",(0,r.jsx)(n.code,{children:"scheduledRounds"})," is absent"]})," \u2014 all rounds up to ",(0,r.jsx)(n.code,{children:"roundLimit"})," appear in the schedule (backward compatible)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Embargo on individual rounds"})," \u2014 each entry in ",(0,r.jsx)(n.code,{children:"scheduledRounds"})," supports the standard ",(0,r.jsx)(n.code,{children:"embargo"})," field for time-based release"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scheduled-rounds-workflow",children:"Scheduled Rounds Workflow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// Step 1: Create 3 AD_HOC rounds, schedule all matchUps\n// Step 2: Publish bracket with roundLimit 2, schedule only round 1\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          published: true,\n          roundLimit: 2,\n          scheduledRounds: { 1: { published: true } },\n        },\n      },\n    },\n  },\n});\n\n// Step 3: Add round 2 to schedule with embargo\nengine.publishEvent({\n  eventId,\n  removePriorValues: true,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          published: true,\n          roundLimit: 2,\n          scheduledRounds: {\n            1: { published: true },\n            2: { published: true, embargo: '2024-06-16T08:00:00Z' },\n          },\n        },\n      },\n    },\n  },\n});\n\n// Step 4: Embargo passes \u2192 round 2 automatically visible in schedule\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8322(e,n,s){s.d(n,{R:()=>l,x:()=>d});var i=s(758);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);
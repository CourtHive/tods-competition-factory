"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[3036],{3899(n,i,e){e.r(i),e.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"concepts/finishing-positions","title":"Finishing Positions","description":"Overview","source":"@site/docs/concepts/finishing-positions.md","sourceDirName":"concepts","slug":"/concepts/finishing-positions","permalink":"/competition-factory/docs/concepts/finishing-positions","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Finishing Positions"},"sidebar":"docs","previous":{"title":"Draw Types","permalink":"/competition-factory/docs/concepts/draw-types"},"next":{"title":"Actions","permalink":"/competition-factory/docs/concepts/actions"}}');var r=e(6070),o=e(8322);const t={title:"Finishing Positions"},a=void 0,c={},l=[{value:"Overview",id:"overview",level:2},{value:"How Finishing Positions Are Computed",id:"how-finishing-positions-are-computed",level:2},{value:"Draw Type Variations",id:"draw-type-variations",level:2},{value:"Single Elimination",id:"single-elimination",level:3},{value:"Feed-In Championship (FIC)",id:"feed-in-championship-fic",level:3},{value:"Round Robin",id:"round-robin",level:3},{value:"Compass Draw",id:"compass-draw",level:3},{value:"Qualifying Structures",id:"qualifying-structures",level:3},{value:"The Accessor: Mapping to Policy Keys",id:"accessor",level:2},{value:"Multi-Structure Draws",id:"multi-structure-draws",level:3},{value:"structureParticipation",id:"structureparticipation",level:2},{value:"playoffFinishingPositionRanges",id:"playofffinishingpositionranges",level:2},{value:"Links Between Structures",id:"links-between-structures",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function d(n){const i={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(i.p,{children:["Every matchUp in a draw carries a ",(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.code,{children:"finishingPositionRange"})})," \u2014 a pair of numeric ranges that describe the possible finishing positions for the winner and loser of that matchUp. This value is the bridge between draw structure (where a participant finished) and ranking point calculation (how many points they earn)."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ts",children:"type MatchUpFinishingPositionRange = {\n  winner: number[]; // [minPosition, maxPosition]\n  loser: number[];  // [minPosition, maxPosition]\n};\n"})}),"\n",(0,r.jsx)(i.p,{children:"For example, in a 32-draw single elimination:"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Round"}),(0,r.jsx)(i.th,{children:"Winner Range"}),(0,r.jsx)(i.th,{children:"Loser Range"}),(0,r.jsx)(i.th,{children:"Meaning"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Final"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[1, 1]"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[2, 2]"})}),(0,r.jsx)(i.td,{children:"Champion vs. runner-up"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Semifinal"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[1, 2]"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[3, 4]"})}),(0,r.jsx)(i.td,{children:"Winner goes to final; loser finishes 3rd-4th"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Quarterfinal"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[1, 4]"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[5, 8]"})}),(0,r.jsx)(i.td,{children:"Winner advances; loser finishes 5th-8th"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Round of 16"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[1, 8]"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[9, 16]"})}),(0,r.jsx)(i.td,{children:"Winner advances; loser finishes 9th-16th"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Round of 32"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[1, 16]"})}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"[17, 32]"})}),(0,r.jsx)(i.td,{children:"Winner advances; loser finishes 17th-32nd"})]})]})]}),"\n",(0,r.jsxs)(i.p,{children:["The winner range narrows as the participant advances through the draw \u2014 a champion's final ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," is ",(0,r.jsx)(i.code,{children:"[1, 1]"}),", meaning they definitively finished 1st."]}),"\n",(0,r.jsx)(i.h2,{id:"how-finishing-positions-are-computed",children:"How Finishing Positions Are Computed"}),"\n",(0,r.jsxs)(i.p,{children:["Finishing positions are computed during draw generation by the ",(0,r.jsx)(i.code,{children:"addFinishingRounds()"})," function. The algorithm works backwards from the final round:"]}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Final round"}),": The winner finishes at position 1, the loser at position 2"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Each earlier round"}),": Positions are calculated based on how many matchUps remain and the structure size"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Offsets"}),": Multi-structure draws apply a ",(0,r.jsx)(i.code,{children:"finishingPositionOffset"})," to shift positions for consolation or playoff structures"]}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"The key inputs are:"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Parameter"}),(0,r.jsx)(i.th,{children:"Purpose"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"finishingPositionOffset"})}),(0,r.jsx)(i.td,{children:"Shifts all positions by this amount (used for consolation structures)"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"positionsFed"})}),(0,r.jsx)(i.td,{children:"Number of positions fed into the structure from a linked structure"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"roundsCount"})}),(0,r.jsx)(i.td,{children:"Total number of rounds in the structure"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"draw-type-variations",children:"Draw Type Variations"}),"\n",(0,r.jsx)(i.h3,{id:"single-elimination",children:"Single Elimination"}),"\n",(0,r.jsx)(i.p,{children:"The simplest case. Each round produces a clear loser range:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"32-draw:\n  R1 losers:  [17, 32]  \u2192  accessor 32\n  R2 losers:  [9, 16]   \u2192  accessor 16\n  QF losers:  [5, 8]    \u2192  accessor 8\n  SF losers:  [3, 4]    \u2192  accessor 4\n  Finalist:   [2, 2]    \u2192  accessor 2\n  Champion:   [1, 1]    \u2192  accessor 1\n"})}),"\n",(0,r.jsx)(i.admonition,{type:"tip",children:(0,r.jsxs)(i.p,{children:["Without a 3rd-place playoff, both semifinal losers get ",(0,r.jsx)(i.code,{children:"finishingPositionRange: [3, 4]"})," with accessor ",(0,r.jsx)(i.code,{children:"4"}),". Key ",(0,r.jsx)(i.code,{children:"3"})," in a ranking policy is only reached when a 3-4 playoff produces a definitive 3rd-place finisher with range ",(0,r.jsx)(i.code,{children:"[3, 3]"}),"."]})}),"\n",(0,r.jsx)(i.h3,{id:"feed-in-championship-fic",children:"Feed-In Championship (FIC)"}),"\n",(0,r.jsxs)(i.p,{children:["FIC draws have a main structure and a consolation structure. The consolation structure receives ",(0,r.jsx)(i.code,{children:"finishingPositionOffset = baseDrawSize"})," so its positions don't overlap with the main draw:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"32-draw FIC (16-player base main):\n  Main draw positions:        1\u201316\n  Consolation positions:      17\u201332 (offset by 16)\n\nConsolation accessors:\n  Consolation R1 losers: accessor 32\n  Consolation R2 losers: accessor 24\n  Consolation SF losers: accessor 20 (or similar, depending on feeds)\n  Consolation finalist:  accessor 18\n  Consolation champion:  accessor 17\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Because each consolation tier receives a distinct ",(0,r.jsx)(i.code,{children:"finishingPositionOffset"}),", all accessors across the entire draw are unique. This means ranking policies can assign different point values to every finishing tier without ambiguity."]}),"\n",(0,r.jsx)(i.h3,{id:"round-robin",children:"Round Robin"}),"\n",(0,r.jsxs)(i.p,{children:["In Round Robin structures, ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," is less meaningful because all participants in a group play each other. Both ",(0,r.jsx)(i.code,{children:"winner"})," and ",(0,r.jsx)(i.code,{children:"loser"})," have identical ranges spanning the full group:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"4-player group: winner=[1,4], loser=[1,4]\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Final standings in Round Robin are determined by ",(0,r.jsx)(i.a,{href:"/docs/policies/roundRobinTallyPolicy",children:"tally results"})," rather than ",(0,r.jsx)(i.code,{children:"finishingPositionRange"}),". When Round Robin groups feed into playoff structures via ",(0,r.jsx)(i.a,{href:"./draw-types#how-links-work",children:"POSITION links"}),", the playoff structure computes its own ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," independently."]}),"\n",(0,r.jsx)(i.h3,{id:"compass-draw",children:"Compass Draw"}),"\n",(0,r.jsxs)(i.p,{children:["Each direction (East, West, South, North, etc.) is an independent elimination structure with its own ",(0,r.jsx)(i.code,{children:"finishingPositionRange"}),". Positions are local to each quadrant."]}),"\n",(0,r.jsx)(i.h3,{id:"qualifying-structures",children:"Qualifying Structures"}),"\n",(0,r.jsxs)(i.p,{children:["Qualifying structures use ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," with special handling:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Qualifying winners don't receive position ",(0,r.jsx)(i.code,{children:"1"})," (reserved for the main draw champion)"]}),"\n",(0,r.jsx)(i.li,{children:"Instead, their minimum position is set to the qualifying round count"}),"\n",(0,r.jsx)(i.li,{children:"This prevents qualifying match wins from mapping to main draw finishing positions"}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"accessor",children:"The Accessor: Mapping to Policy Keys"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.strong,{children:"accessor"})," is the critical bridge between ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," and ranking point policies. It is computed as:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-js",children:"const accessor = Math.max(...finishingPositionRange);\n"})}),"\n",(0,r.jsxs)(i.p,{children:["This value becomes the key used to look up points in a ranking policy's ",(0,r.jsx)(i.code,{children:"finishingPositionRanges"})," object:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-js",children:"// Ranking policy\nfinishingPositionRanges: {\n  1:  { level: { 1: 3000, 2: 1650, 3: 990 } },  // Champion\n  2:  { level: { 1: 2400, 2: 1320, 3: 792 } },  // Runner-up\n  4:  { level: { 1: 1800, 2: 990, 3: 594 } },   // SF losers (key 4, not 3!)\n  8:  { level: { 1: 1200, 2: 660, 3: 396 } },   // QF losers\n  16: { level: { 1: 600,  2: 330, 3: 198 } },   // R16 losers\n  32: { level: { 1: 300,  2: 165, 3: 99 } },    // R32 losers\n}\n"})}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"Math.max()"})," convention means the accessor always corresponds to the ",(0,r.jsx)(i.strong,{children:"worst possible"})," finishing position in the range. This is intentional \u2014 it ensures participants are awarded points based on the round where they were eliminated, not their best theoretical position."]}),"\n",(0,r.jsx)(i.h3,{id:"multi-structure-draws",children:"Multi-Structure Draws"}),"\n",(0,r.jsxs)(i.p,{children:["For draws with multiple structures (FIC, Curtis Consolation, Compass), a participant may have ",(0,r.jsx)(i.code,{children:"structureParticipation"})," entries in more than one structure (e.g., eliminated in main draw R2, then played consolation through to the consolation SF). The ranking points pipeline iterates all entries and takes the ",(0,r.jsx)(i.strong,{children:"maximum position points"})," across structures:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"Main draw R2 loss:       accessor 24  \u2192  75 pts\nConsolation SF finish:   accessor 12  \u2192  150 pts\nFinal position points:   150 pts (consolation finish is better)\n"})}),"\n",(0,r.jsx)(i.p,{children:"This happens automatically \u2014 no special policy configuration is needed."}),"\n",(0,r.jsx)(i.h2,{id:"structureparticipation",children:"structureParticipation"}),"\n",(0,r.jsxs)(i.p,{children:["When participants are hydrated with ",(0,r.jsx)(i.code,{children:"getParticipants({ withRankingProfile: true })"}),", each participant's ",(0,r.jsx)(i.code,{children:"draws"})," array contains ",(0,r.jsx)(i.code,{children:"structureParticipation"})," entries. Each entry includes:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-ts",children:"{\n  structureId: string;\n  finishingPositionRange: number[];  // the resolved range (winner or loser, based on outcome)\n  participantWon: boolean;\n  winCount: number;\n  rankingStage: string;             // 'MAIN', 'QUALIFYING', 'CONSOLATION', etc.\n  participationOrder: number;       // 1 for primary, 2+ for consolation/playoff\n}\n"})}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," stored in ",(0,r.jsx)(i.code,{children:"structureParticipation"})," is the ",(0,r.jsx)(i.strong,{children:"resolved"})," range \u2014 it's the winner range if the participant won their last matchUp, or the loser range if they lost. When a participant plays multiple matchUps in the same structure, the ",(0,r.jsx)(i.strong,{children:"narrowest"})," range is kept (smallest spread between min and max position)."]}),"\n",(0,r.jsx)(i.h2,{id:"playofffinishingpositionranges",children:"playoffFinishingPositionRanges"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"getAvailablePlayoffProfiles"})," method (available on the ",(0,r.jsx)(i.a,{href:"/docs/governors/query-governor#getavailableplayoffprofiles",children:"Query Governor"}),") returns the available finishing positions for Round Robin playoff structures:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-js",children:'const { playoffFinishingPositionRanges } = engine.getPlayoffFinishingPositionRanges({\n  structureId,\n  drawId,\n});\n// Returns:\n// [\n//   { finishingPosition: 1, finishingPositions: [1,2,3,4], finishingPositionRange: "1-4" },\n//   { finishingPosition: 2, finishingPositions: [5,6,7,8], finishingPositionRange: "5-8" },\n//   ...\n// ]\n'})}),"\n",(0,r.jsxs)(i.p,{children:["These ranges define how group finishers map to overall draw finishing positions and are used when configuring ",(0,r.jsx)(i.a,{href:"./draws-overview#round-robin-with-playoffs",children:"playoff structures"}),"."]}),"\n",(0,r.jsx)(i.h2,{id:"links-between-structures",children:"Links Between Structures"}),"\n",(0,r.jsxs)(i.p,{children:["Draw structures are connected via ",(0,r.jsx)(i.strong,{children:"links"})," that control participant flow. The ",(0,r.jsx)(i.code,{children:"finishingPositions"})," field on link sources determines which participants advance:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-js",children:"// Group winners advance to Gold bracket\n{\n  linkType: 'POSITION',\n  source: { structureId: 'rr-group', finishingPositions: [1] },\n  target: { structureId: 'gold-bracket', roundNumber: 1 }\n}\n\n// Group runners-up advance to Silver bracket\n{\n  linkType: 'POSITION',\n  source: { structureId: 'rr-group', finishingPositions: [2] },\n  target: { structureId: 'silver-bracket', roundNumber: 1 }\n}\n"})}),"\n",(0,r.jsxs)(i.p,{children:["See ",(0,r.jsx)(i.a,{href:"./draw-types#how-links-work",children:"How Links Work"})," for full details on link types (WINNER, LOSER, POSITION)."]}),"\n",(0,r.jsx)(i.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"/docs/scale-engine/ranking-points-pipeline#position-points",children:"Ranking Points Pipeline"})})," \u2014 How the accessor maps to policy points"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"/docs/policies/rankingPolicy",children:"Ranking Policy"})})," \u2014 Policy structure with ",(0,r.jsx)(i.code,{children:"finishingPositionRanges"})," configuration"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"./draw-types",children:"Draw Types"})})," \u2014 Draw structures and links between them"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"./matchup-context",children:"MatchUp Context"})})," \u2014 How ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})," appears on matchUps"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"/docs/scale-engine/scale-engine-overview",children:"Scale Engine Overview"})})," \u2014 Full ranking points pipeline"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"/docs/governors/report-governor",children:"Report Governor"})})," \u2014 Draw reports include ",(0,r.jsx)(i.code,{children:"finishingPositionRange"})]}),"\n"]})]})}function h(n={}){const{wrapper:i}={...(0,o.R)(),...n.components};return i?(0,r.jsx)(i,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},8322(n,i,e){e.d(i,{R:()=>t,x:()=>a});var s=e(758);const r={},o=s.createContext(r);function t(n){const i=s.useContext(o);return s.useMemo(function(){return"function"==typeof n?n(i):{...i,...n}},[i,n])}function a(n){let i;return i=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),s.createElement(o.Provider,{value:i},n.children)}}}]);
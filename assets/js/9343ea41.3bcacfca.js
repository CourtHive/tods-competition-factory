"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[1059],{4008(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"concepts/publishing","title":"Publishing","description":"Overview","source":"@site/docs/concepts/publishing.md","sourceDirName":"concepts","slug":"/concepts/publishing","permalink":"/competition-factory/docs/concepts/publishing","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Publishing"},"sidebar":"docs","previous":{"title":"Conflict Reporting","permalink":"/competition-factory/docs/concepts/scheduling-conflicts"},"next":{"title":"Overview","permalink":"/competition-factory/docs/engines/state-engines"}}');var t=i(6070),a=i(8439);const l={title:"Publishing"},r=void 0,d={},c=[{value:"Overview",id:"overview",level:2},{value:"Why Publishing Exists",id:"why-publishing-exists",level:3},{value:"How Publishing Works",id:"how-publishing-works",level:3},{value:"Publish State Management",id:"publish-state-management",level:2},{value:"Queryable Publish State",id:"queryable-publish-state",level:3},{value:"State Granularity",id:"state-granularity",level:3},{value:"Publishing Events and Draws",id:"publishing-events-and-draws",level:2},{value:"Publishing All Draws",id:"publishing-all-draws",level:3},{value:"Publishing Specific Draws",id:"publishing-specific-draws",level:3},{value:"Publishing by Stage",id:"publishing-by-stage",level:3},{value:"Round-by-Round Publishing",id:"round-by-round-publishing",level:3},{value:"Publishing with Embargo",id:"publishing-with-embargo",level:3},{value:"Unpublishing Events",id:"unpublishing-events",level:3},{value:"Publishing Event Seeding",id:"publishing-event-seeding",level:2},{value:"Why Separate Seeding Publication?",id:"why-separate-seeding-publication",level:3},{value:"Publishing Seeding",id:"publishing-seeding",level:3},{value:"Unpublishing Seeding",id:"unpublishing-seeding",level:3},{value:"Publishing Order of Play",id:"publishing-order-of-play",level:2},{value:"Why Order of Play Publishing?",id:"why-order-of-play-publishing",level:3},{value:"Publishing Scheduled MatchUps",id:"publishing-scheduled-matchups",level:3},{value:"Unpublishing Order of Play",id:"unpublishing-order-of-play",level:3},{value:"Querying Published Schedules",id:"querying-published-schedules",level:3},{value:"Publishing Participants",id:"publishing-participants",level:2},{value:"Why Participant Publishing?",id:"why-participant-publishing",level:3},{value:"Unpublishing Participants",id:"unpublishing-participants",level:3},{value:"Privacy Policies",id:"privacy-policies",level:2},{value:"Participant Privacy Policy",id:"participant-privacy-policy",level:3},{value:"Display Settings",id:"display-settings",level:3},{value:"Data Preparation for Publishing",id:"data-preparation-for-publishing",level:2},{value:"Event Data Payload",id:"event-data-payload",level:3},{value:"Prepared Payload Structure",id:"prepared-payload-structure",level:3},{value:"Subscriptions and Notifications",id:"subscriptions-and-notifications",level:2},{value:"Publishing Topics",id:"publishing-topics",level:3},{value:"Integration Patterns",id:"integration-patterns",level:3},{value:"Common Workflows",id:"common-workflows",level:2},{value:"Progressive Draw Publication",id:"progressive-draw-publication",level:3},{value:"Multi-Stage Publication",id:"multi-stage-publication",level:3},{value:"Daily Order of Play",id:"daily-order-of-play",level:3},{value:"Coordinated Event and Seeding Release",id:"coordinated-event-and-seeding-release",level:3},{value:"Querying with Publish State",id:"querying-with-publish-state",level:2},{value:"Event Data",id:"event-data",level:3},{value:"Competition Schedule",id:"competition-schedule",level:3},{value:"Participants",id:"participants",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Clear Separation",id:"clear-separation",level:3},{value:"Test Publish State",id:"test-publish-state",level:3},{value:"Atomic Publications",id:"atomic-publications",level:3},{value:"Subscription Error Handling",id:"subscription-error-handling",level:3},{value:"Privacy by Default",id:"privacy-by-default",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Publishing"})," is the mechanism for controlling what tournament information is made publicly available and when. It provides fine-grained control over the visibility of draws, seeding, schedules, and participant data, while maintaining a complete internal record for tournament operations."]}),"\n",(0,t.jsx)(n.h3,{id:"why-publishing-exists",children:"Why Publishing Exists"}),"\n",(0,t.jsx)(n.p,{children:"Tournament organizers often need to control information release:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Competitive Integrity"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Withhold seeding until draws are complete to prevent gaming"}),"\n",(0,t.jsx)(n.li,{children:"Delay draw publication until all entries are finalized"}),"\n",(0,t.jsx)(n.li,{children:"Embargo certain rounds until earlier rounds complete"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Operational Flexibility"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Prepare draws internally before public release"}),"\n",(0,t.jsx)(n.li,{children:"Schedule matchUps without immediately making them visible"}),"\n",(0,t.jsx)(n.li,{children:"Make corrections before information becomes public"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Privacy Protection"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Control which participant information is publicly visible"}),"\n",(0,t.jsx)(n.li,{children:"Apply privacy policies to protect sensitive data"}),"\n",(0,t.jsx)(n.li,{children:"Manage participant opt-outs and preferences"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Media Management"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Coordinate releases with media partners"}),"\n",(0,t.jsx)(n.li,{children:"Stage information rollout for maximum engagement"}),"\n",(0,t.jsx)(n.li,{children:"Control timing of seeding and draw announcements"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-publishing-works",children:"How Publishing Works"}),"\n",(0,t.jsxs)(n.p,{children:["Publishing operates through ",(0,t.jsx)(n.strong,{children:"publish state management"})," tracked via ",(0,t.jsx)(n.a,{href:"./timeItems",children:"Time Items"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Internal Operations"}),": Tournament staff work with complete data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Publish Actions"}),": Administrators explicitly publish specific elements"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"State Tracking"}),": Time items record what's published and when"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Filtered Queries"}),": Public-facing queries use ",(0,t.jsx)(n.code,{children:"usePublishState: true"})," to filter data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Notifications"}),": ",(0,t.jsx)(n.a,{href:"/docs/engines/subscriptions",children:"Subscriptions"})," notify systems when publishing changes"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This architecture enables full operational capability internally while controlling external visibility precisely."}),"\n",(0,t.jsx)(n.h2,{id:"publish-state-management",children:"Publish State Management"}),"\n",(0,t.jsx)(n.p,{children:"The factory tracks publish state for multiple tournament elements:"}),"\n",(0,t.jsx)(n.h3,{id:"queryable-publish-state",children:"Queryable Publish State"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { publishState } = engine.getPublishState();\n\n// Tournament-level state\nconst participantsPublished = publishState.tournament.participants.published;\nconst orderOfPlayPublished = publishState.tournament.orderOfPlay.published;\n\n// Event-level state (accessed by eventId)\nconst eventState = publishState['eventId'].status;\nconst { published, publishedDrawIds, drawDetails } = eventState;\n\n// Draw-level state\nconst drawState = engine.getPublishState({ drawId }).publishState;\nconst drawPublished = drawState.status.published;\nconst drawDetail = drawState.status.drawDetail; // stage/structure granularity\n"})}),"\n",(0,t.jsx)(n.h3,{id:"state-granularity",children:"State Granularity"}),"\n",(0,t.jsx)(n.p,{children:"Publishing can be controlled at multiple levels:"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tournament Level"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Participant list visibility"}),"\n",(0,t.jsx)(n.li,{children:"Order of Play (scheduled matchUps)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Event Level"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"All draws within an event"}),"\n",(0,t.jsx)(n.li,{children:"Individual draws (flights) within an event"}),"\n",(0,t.jsx)(n.li,{children:"Event seeding information"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Draw Level"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Entire draw structure"}),"\n",(0,t.jsx)(n.li,{children:"Specific stages (MAIN, QUALIFYING, CONSOLATION)"}),"\n",(0,t.jsx)(n.li,{children:"Individual structures within draws"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Structure Level"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Specific structures within multi-structure draws"}),"\n",(0,t.jsx)(n.li,{children:"Round-by-round visibility (progressive release)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"publishing-events-and-draws",children:"Publishing Events and Draws"}),"\n",(0,t.jsx)(n.p,{children:"Event publishing controls visibility of draw structures, matchUps, and results."}),"\n",(0,t.jsx)(n.h3,{id:"publishing-all-draws",children:"Publishing All Draws"}),"\n",(0,t.jsx)(n.p,{children:"Publish all draws within an event:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { eventData } = engine.publishEvent({ eventId });\n\n// eventData contains formatted payload for public display\n// publishState updated with timeItem\n// Subscribers notified via PUBLISH_EVENT topic\n"})}),"\n",(0,t.jsx)(n.h3,{id:"publishing-specific-draws",children:"Publishing Specific Draws"}),"\n",(0,t.jsx)(n.p,{children:"Publish only selected draws (useful for flights):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Shorthand for publishing specific drawIds\nengine.publishEvent({\n  eventId,\n  drawIdsToAdd: ['drawId1', 'drawId2'],\n});\n\n// Remove draws from published set\nengine.publishEvent({\n  eventId,\n  drawIdsToRemove: ['drawId3'],\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"publishing-by-stage",children:"Publishing by Stage"}),"\n",(0,t.jsx)(n.p,{children:"Publish only specific stages within a draw:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { stageConstants } from 'tods-competition-factory';\nconst { QUALIFYING, MAIN } = stageConstants;\n\n// Publish only qualifying stage\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [QUALIFYING],\n    },\n  },\n});\n\n// Publish MAIN and QUALIFYING\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [MAIN, QUALIFYING],\n      publishingDetail: { published: true },\n    },\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"round-by-round-publishing",children:"Round-by-Round Publishing"}),"\n",(0,t.jsx)(n.p,{children:"Control visibility round-by-round for progressive disclosure:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Publish only first round of a structure\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          roundLimit: 1,\n          published: true,\n        },\n      },\n    },\n  },\n});\n\n// Expand to include more rounds as they complete\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: {\n          roundLimit: 2, // Now show rounds 1 and 2\n          published: true,\n        },\n      },\n    },\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"publishing-with-embargo",children:"Publishing with Embargo"}),"\n",(0,t.jsx)(n.p,{children:"Schedule future publication with embargo timestamps:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const embargoTime = new Date('2024-06-15T10:00:00Z').toISOString();\n\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      publishingDetail: {\n        published: true,\n        embargo: embargoTime, // Don't display until this time\n      },\n    },\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"unpublishing-events",children:"Unpublishing Events"}),"\n",(0,t.jsx)(n.p,{children:"Remove events from public visibility:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"engine.unPublishEvent({\n  eventId,\n  removePriorValues: true, // Remove timeItems (default)\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"publishing-event-seeding",children:"Publishing Event Seeding"}),"\n",(0,t.jsx)(n.p,{children:"Seeding publication is separate from draw publication, allowing flexible control over when seeding information becomes public."}),"\n",(0,t.jsx)(n.h3,{id:"why-separate-seeding-publication",children:"Why Separate Seeding Publication?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Competition Integrity"}),": Prevent participants from knowing their seeded positions before draws finalized"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Draw Process"}),": Complete seeding internally before public announcement"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Flexibility"}),": Update seeding without re-publishing entire draw"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Staged Release"}),": Announce seeded players separately from draw structure"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"publishing-seeding",children:"Publishing Seeding"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"engine.publishEventSeeding({\n  eventId,\n  seedingScaleNames: ['U18'], // Optional - specify which scales\n  drawIds: ['drawId1'], // Optional - specific draws only\n});\n\n// Different scales for different stages\nengine.publishEventSeeding({\n  eventId,\n  stageSeedingScaleNames: {\n    MAIN: 'U18',\n    QUALIFYING: 'U18Q',\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"unpublishing-seeding",children:"Unpublishing Seeding"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"engine.unPublishEventSeeding({\n  eventId,\n  stages: ['MAIN', 'QUALIFYING'], // Optional - specific stages only\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"publishing-order-of-play",children:"Publishing Order of Play"}),"\n",(0,t.jsx)(n.p,{children:"Order of Play publishing controls visibility of scheduled matchUps - which matches are scheduled for which courts and times."}),"\n",(0,t.jsx)(n.h3,{id:"why-order-of-play-publishing",children:"Why Order of Play Publishing?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Schedule Preparation"}),": Prepare schedules internally before announcing"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Flexibility"}),": Make scheduling changes before public release"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Coordination"}),": Synchronize releases with media partners"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Daily Updates"}),": Publish each day's schedule separately"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"publishing-scheduled-matchups",children:"Publishing Scheduled MatchUps"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Publish all scheduled dates and events\nengine.publishOrderOfPlay();\n\n// Publish specific dates only\nengine.publishOrderOfPlay({\n  scheduledDates: ['2024-06-15', '2024-06-16'],\n});\n\n// Publish specific events only\nengine.publishOrderOfPlay({\n  eventIds: ['singles-main', 'doubles-main'],\n});\n\n// Publish specific dates and events\nengine.publishOrderOfPlay({\n  scheduledDates: ['2024-06-15'],\n  eventIds: ['singles-main'],\n  removePriorValues: true, // Clear previous publications\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"unpublishing-order-of-play",children:"Unpublishing Order of Play"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"engine.unPublishOrderOfPlay({\n  removePriorValues: true, // Remove timeItems (default)\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"querying-published-schedules",children:"Querying Published Schedules"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { dateMatchUps } = engine.competitionScheduleMatchUps({\n  usePublishState: true, // Only return published matchUps\n});\n\n// dateMatchUps organized by date, filtered by publish state\n// Only matchUps on published dates in published events returned\n"})}),"\n",(0,t.jsx)(n.h2,{id:"publishing-participants",children:"Publishing Participants"}),"\n",(0,t.jsx)(n.p,{children:"Participant publishing controls visibility of the participant list."}),"\n",(0,t.jsx)(n.h3,{id:"why-participant-publishing",children:"Why Participant Publishing?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Entry Management"}),": Accept entries internally before announcing participant list"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Privacy"}),": Control when participant information becomes public"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Marketing"}),": Coordinate announcements with promotional campaigns"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Staged Entries"}),": Announce wildcards separately from direct acceptances"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"engine.publishParticipants();\n\n// Clear previous publications and republish\nengine.publishParticipants({\n  removePriorValues: true,\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"unpublishing-participants",children:"Unpublishing Participants"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"engine.unPublishParticipants({\n  removePriorValues: true,\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"privacy-policies",children:"Privacy Policies"}),"\n",(0,t.jsxs)(n.p,{children:["Publishing integrates with ",(0,t.jsx)(n.strong,{children:"privacy policies"})," to control which participant attributes are visible:"]}),"\n",(0,t.jsx)(n.h3,{id:"participant-privacy-policy",children:"Participant Privacy Policy"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { policyConstants } from 'tods-competition-factory';\n\nconst privacyPolicy = {\n  participant: {\n    contacts: false, // Hide contact information\n    addresses: false, // Hide addresses\n    individualParticipants: {\n      // For pairs/teams\n      contacts: false,\n      addresses: false,\n    },\n  },\n};\n\n// Apply privacy policy during publishing\nconst { eventData } = engine.publishEvent({\n  eventId,\n  policyDefinitions: { [policyConstants.POLICY_TYPE_PARTICIPANT]: privacyPolicy },\n});\n\n// Participant data in eventData respects privacy policy\n// Internal operations still have access to complete data\n"})}),"\n",(0,t.jsx)(n.h3,{id:"display-settings",children:"Display Settings"}),"\n",(0,t.jsx)(n.p,{children:"Control visibility of specific matchUp and schedule attributes:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const displaySettings = {\n  matchUps: {\n    scheduleDate: true,\n    scheduledTime: false, // Hide specific times\n    courtName: true,\n    courtOrder: false,\n  },\n  participants: {\n    addresses: false,\n    contacts: false,\n  },\n};\n\nengine.setEventDisplay({\n  eventId,\n  displaySettings,\n});\n\n// Settings applied when usePublishState: true in queries\n"})}),"\n",(0,t.jsx)(n.h2,{id:"data-preparation-for-publishing",children:"Data Preparation for Publishing"}),"\n",(0,t.jsx)(n.p,{children:"Publishing methods prepare optimized data payloads for public display."}),"\n",(0,t.jsx)(n.h3,{id:"event-data-payload",children:"Event Data Payload"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { eventData } = engine.publishEvent({\n  eventId,\n  eventDataParams: {\n    allParticipantResults: true, // Include round statistics\n    participantsProfile: {\n      withISO2: true, // Include country codes\n      withIOC: true,\n    },\n  },\n});\n\n// eventData structure optimized for visualization:\n// - drawsData: Array of draws with structures\n// - matchUps: Organized by rounds for each structure\n// - participants: Hydrated participant information\n// - venuesData: Venue and court information\n// - tournamentInfo: Tournament metadata\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"important",children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Event Data Parameters Are Not Persisted"})}),(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"eventDataParams"})," passed to ",(0,t.jsx)(n.code,{children:"publishEvent()"})," are used to generate the ",(0,t.jsx)(n.code,{children:"eventData"})," payload ",(0,t.jsx)(n.strong,{children:"for that specific call only"}),". These parameters are ",(0,t.jsx)(n.strong,{children:"NOT stored"})," in the publish state timeItem."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Client applications must pass their own query parameters:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Server-side publishing (generates payload for subscriptions)\nengine.publishEvent({\n  eventId,\n  eventDataParams: { participantsProfile: { withISO2: true } },\n});\n\n// Client application querying published data\nconst { eventData } = engine.getEventData({\n  eventId,\n  usePublishState: true, // Respects what's published\n  participantsProfile: { withISO2: true }, // Must specify params again\n});\n"})}),(0,t.jsxs)(n.p,{children:["The publish state timeItem controls ",(0,t.jsx)(n.strong,{children:"filtering"})," (which draws, structures, rounds are visible) but does not store query customization parameters. Each client application specifies its own data requirements when querying."]})]}),"\n",(0,t.jsx)(n.h3,{id:"prepared-payload-structure",children:"Prepared Payload Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"{\n  eventData: {\n    eventInfo: {\n      eventId: string;\n      eventName: string;\n      // ... event metadata\n    },\n    drawsData: [{\n      drawId: string;\n      drawName: string;\n      structures: [{\n        structureId: string;\n        structureName: string;\n        roundMatchUps: {\n          [roundNumber]: matchUp[]\n        }\n      }]\n    }],\n    participants: Participant[],\n    venuesData: Venue[],\n    tournamentInfo: TournamentInfo\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"subscriptions-and-notifications",children:"Subscriptions and Notifications"}),"\n",(0,t.jsxs)(n.p,{children:["Publishing actions trigger ",(0,t.jsx)(n.strong,{children:"subscription notifications"})," enabling real-time updates to public-facing systems."]}),"\n",(0,t.jsx)(n.h3,{id:"publishing-topics",children:"Publishing Topics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { topicConstants } from 'tods-competition-factory';\n\nconst subscriptions = {\n  [topicConstants.PUBLISH_EVENT]: (payload) => {\n    // Event published - update public website\n    const { eventData, eventId } = payload;\n    updatePublicSite(eventData);\n  },\n\n  [topicConstants.UNPUBLISH_EVENT]: (payload) => {\n    // Event unpublished - remove from public website\n    const { eventId } = payload;\n    removeFromPublicSite(eventId);\n  },\n\n  [topicConstants.PUBLISH_EVENT_SEEDING]: (payload) => {\n    // Seeding published - update seeding displays\n    const { eventId, seedingData } = payload;\n    updateSeedingDisplay(seedingData);\n  },\n\n  [topicConstants.UNPUBLISH_EVENT_SEEDING]: (payload) => {\n    // Seeding unpublished - remove seeding information\n    const { eventId } = payload;\n    removeSeedingDisplay(eventId);\n  },\n\n  [topicConstants.PUBLISH_ORDER_OF_PLAY]: (payload) => {\n    // Order of Play published - update schedule displays\n    const { dateMatchUps } = payload;\n    updateScheduleDisplay(dateMatchUps);\n  },\n\n  [topicConstants.UNPUBLISH_ORDER_OF_PLAY]: (payload) => {\n    // Order of Play unpublished - remove schedules\n    removeScheduleDisplay();\n  },\n};\n\nengine.devContext({ subscriptions });\n"})}),"\n",(0,t.jsx)(n.h3,{id:"integration-patterns",children:"Integration Patterns"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Push to Public Website"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"[topicConstants.PUBLISH_EVENT]: async (payload) => {\n  const { eventData } = payload;\n  await fetch('https://public-site.com/api/events', {\n    method: 'POST',\n    body: JSON.stringify(eventData)\n  });\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Database Synchronization"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"[topicConstants.PUBLISH_ORDER_OF_PLAY]: async (payload) => {\n  const { dateMatchUps } = payload;\n  await database.updatePublishedSchedule(dateMatchUps);\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cache Invalidation"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"[topicConstants.UNPUBLISH_EVENT]: (payload) => {\n  const { eventId } = payload;\n  cache.invalidate(`event:${eventId}`);\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-workflows",children:"Common Workflows"}),"\n",(0,t.jsx)(n.h3,{id:"progressive-draw-publication",children:"Progressive Draw Publication"}),"\n",(0,t.jsx)(n.p,{children:"Gradually release draw information as tournament progresses:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Day 1: Publish first round only\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: { roundLimit: 1, published: true },\n      },\n    },\n  },\n});\n\n// Day 2: Expand to show rounds 1-2\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      structureDetails: {\n        [structureId]: { roundLimit: 2, published: true },\n      },\n    },\n  },\n});\n\n// Day 3: Publish entire draw\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: { publishingDetail: { published: true } },\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"multi-stage-publication",children:"Multi-Stage Publication"}),"\n",(0,t.jsx)(n.p,{children:"Publish qualifying first, main draw later:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import { stageConstants } from 'tods-competition-factory';\n\n// Publish qualifying only\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [stageConstants.QUALIFYING],\n    },\n  },\n});\n\n// Later: add main draw\nengine.publishEvent({\n  eventId,\n  drawDetails: {\n    [drawId]: {\n      stagesToAdd: [stageConstants.MAIN],\n    },\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"daily-order-of-play",children:"Daily Order of Play"}),"\n",(0,t.jsx)(n.p,{children:"Publish each day's schedule separately:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Each morning, publish that day's schedule\nconst today = new Date().toISOString().split('T')[0];\n\nengine.publishOrderOfPlay({\n  scheduledDates: [today],\n  removePriorValues: false, // Keep previous days published\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"coordinated-event-and-seeding-release",children:"Coordinated Event and Seeding Release"}),"\n",(0,t.jsx)(n.p,{children:"Separate seeding announcement from draw publication:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Step 1: Announce seeded players\nengine.publishEventSeeding({ eventId });\n// Subscription notification sent\n// Public site shows seeded players without draw\n\n// Step 2: Later, publish draw\nengine.publishEvent({ eventId });\n// Subscription notification sent\n// Public site shows complete draw with seeding\n"})}),"\n",(0,t.jsx)(n.h2,{id:"querying-with-publish-state",children:"Querying with Publish State"}),"\n",(0,t.jsxs)(n.p,{children:["Methods that respect publish state when ",(0,t.jsx)(n.code,{children:"usePublishState: true"}),":"]}),"\n",(0,t.jsx)(n.h3,{id:"event-data",children:"Event Data"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { eventData } = engine.getEventData({\n  eventId,\n  usePublishState: true, // Filter to published draws/structures only\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"competition-schedule",children:"Competition Schedule"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { dateMatchUps } = engine.competitionScheduleMatchUps({\n  usePublishState: true, // Only published dates and events\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"participants",children:"Participants"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const { participants } = engine.getParticipants({\n  usePublishState: true, // Respect privacy policies\n  policyDefinitions: privacyPolicy,\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"clear-separation",children:"Clear Separation"}),"\n",(0,t.jsx)(n.p,{children:"Maintain clear separation between internal and public-facing queries:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Internal operations - full data access\nconst { matchUps } = engine.allTournamentMatchUps();\n\n// Public displays - filtered data\nconst { matchUps: publicMatchUps } = engine.allTournamentMatchUps({\n  usePublishState: true,\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"test-publish-state",children:"Test Publish State"}),"\n",(0,t.jsx)(n.p,{children:"Verify filtering works before going live:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Publish event\nengine.publishEvent({ eventId });\n\n// Query what public will see\nconst { eventData } = engine.getEventData({\n  eventId,\n  usePublishState: true,\n});\n\n// Verify expected structures/rounds visible\nassert(eventData.drawsData.length === expectedCount);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"atomic-publications",children:"Atomic Publications"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"removePriorValues: true"})," for clean state transitions:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Replace previous publication completely\nengine.publishOrderOfPlay({\n  scheduledDates: newDates,\n  removePriorValues: true, // Clean slate\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"subscription-error-handling",children:"Subscription Error Handling"}),"\n",(0,t.jsx)(n.p,{children:"Handle subscription failures gracefully:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"[topicConstants.PUBLISH_EVENT]: async (payload) => {\n  try {\n    await updatePublicSite(payload.eventData);\n  } catch (error) {\n    logger.error('Failed to update public site', error);\n    // Queue for retry or alert administrators\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"privacy-by-default",children:"Privacy by Default"}),"\n",(0,t.jsx)(n.p,{children:"Apply privacy policies consistently:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const defaultPrivacyPolicy = {\n  participant: {\n    contacts: false,\n    addresses: false,\n    individualParticipants: {\n      contacts: false,\n      addresses: false,\n    },\n  },\n};\n\n// Attach to tournament for consistent application\nengine.attachPolicies({\n  policyDefinitions: {\n    [policyConstants.POLICY_TYPE_PARTICIPANT]: defaultPrivacyPolicy,\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/governors/publishing-governor",children:"Publishing Governor"})})," - Complete API reference"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/governors/query-governor",children:"Query Governor"})})," - Methods using publish state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/docs/engines/subscriptions",children:"Subscriptions"})})," - Notification topics"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"./policies",children:"Policies"})})," - Privacy and display policies"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"./timeItems",children:"Time Items"})})," - How publish state is stored"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8439(e,n,i){i.d(n,{R:()=>l,x:()=>r});var s=i(758);const t={},a=s.createContext(t);function l(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);
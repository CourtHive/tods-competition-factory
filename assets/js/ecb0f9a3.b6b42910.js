"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[9290],{7126(n,e,i){i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"governors/ranking-governor","title":"Ranking Governor","description":"The rankingGovernor provides ranking points computation, quality win calculation, multi-tournament aggregation, and write-back functions. It groups all ranking-related operations and is composed into the Scale Engine alongside the ratings governor.","source":"@site/docs/governors/ranking-governor.md","sourceDirName":"governors","slug":"/governors/ranking-governor","permalink":"/competition-factory/docs/governors/ranking-governor","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Ranking Governor"},"sidebar":"docs","previous":{"title":"Query Governor","permalink":"/competition-factory/docs/governors/query-governor"},"next":{"title":"Report Governor","permalink":"/competition-factory/docs/governors/report-governor"}}');var s=i(6070),t=i(8322);const o={title:"Ranking Governor"},a=void 0,l={},c=[{value:"Query Methods",id:"query-methods",level:2},{value:"getTournamentPoints",id:"gettournamentpoints",level:3},{value:"getAwardProfile",id:"getawardprofile",level:3},{value:"getAwardPoints",id:"getawardpoints",level:3},{value:"getQualityWinPoints",id:"getqualitywinpoints",level:3},{value:"generateRankingList",id:"generaterankinglist",level:3},{value:"getParticipantPoints",id:"getparticipantpoints",level:3},{value:"Mutation Methods",id:"mutation-methods",level:2},{value:"applyTournamentRankingPoints",id:"applytournamentrankingpoints",level:3},{value:"Relationship to Scale Engine",id:"relationship-to-scale-engine",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"import { rankingGovernor } from 'tods-competition-factory';\n"})}),"\n",(0,s.jsxs)(e.p,{children:["The ",(0,s.jsx)(e.strong,{children:"rankingGovernor"})," provides ranking points computation, quality win calculation, multi-tournament aggregation, and write-back functions. It groups all ranking-related operations and is composed into the ",(0,s.jsx)(e.a,{href:"/docs/scale-engine/scale-engine-overview",children:"Scale Engine"})," alongside the ratings governor."]}),"\n",(0,s.jsx)(e.admonition,{type:"info",children:(0,s.jsxs)(e.p,{children:["Most applications use the ",(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/scale-engine/scale-engine-overview",children:"Scale Engine"})})," for convenience. The rankingGovernor is useful for stateless processing, custom engines, or when you need to pass ",(0,s.jsx)(e.code,{children:"tournamentRecord"})," explicitly."]})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"query-methods",children:"Query Methods"}),"\n",(0,s.jsx)(e.h3,{id:"gettournamentpoints",children:"getTournamentPoints"}),"\n",(0,s.jsxs)(e.p,{children:["Computes ranking points for all participants in a tournament based on a ",(0,s.jsx)(e.a,{href:"/docs/policies/rankingPolicy",children:"ranking policy"}),"."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const result = rankingGovernor.getTournamentPoints({\n  tournamentRecord,\n  policyDefinitions: rankingPolicy,\n  level: 3,\n});\n\n// result.personPoints: Record<personId, PointAward[]>\n// result.pairPoints: Record<participantId, PointAward[]>\n// result.teamPoints: Record<participantId, PointAward[]>\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Core computation function. Iterates participants with outcomes, selects award profiles via specificity scoring, resolves position points, per-win points, bonus points, quality win points, and doubles attribution."]}),"\n",(0,s.jsxs)(e.p,{children:["See ",(0,s.jsx)(e.a,{href:"/docs/scale-engine/ranking-points-pipeline",children:"Ranking Points Pipeline"})," for detailed documentation."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"getawardprofile",children:"getAwardProfile"}),"\n",(0,s.jsx)(e.p,{children:"Selects the best-matching award profile for a participation using specificity scoring."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const { awardProfile } = rankingGovernor.getAwardProfile({\n  awardProfiles,\n  participation,\n  eventType: 'SINGLES',\n  drawType: 'SINGLE_ELIMINATION',\n  drawSize: 32,\n  category: { ageCategoryCode: 'U18' },\n  gender: 'MALE',\n  level: 3,\n});\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Deterministic profile selection. Counts populated scope fields to score each profile; highest score wins. Explicit ",(0,s.jsx)(e.code,{children:"priority"})," overrides scoring."]}),"\n",(0,s.jsxs)(e.p,{children:["See ",(0,s.jsx)(e.a,{href:"/docs/scale-engine/ranking-points-pipeline#profile-selection",children:"Profile Selection"})," for scoring rules."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"getawardpoints",children:"getAwardPoints"}),"\n",(0,s.jsx)(e.p,{children:"Resolves a position value object into numeric points."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const { awardPoints, requireWin } = rankingGovernor.getAwardPoints({\n  valueObj: finishingPositionRanges[accessor],\n  level: 3,\n  drawSize: 32,\n  flightNumber: 1,\n});\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Handles level-keyed values (",(0,s.jsx)(e.code,{children:"{ level: { 1: 1000, 2: 500 } }"}),"), draw size thresholds (",(0,s.jsx)(e.code,{children:"[{ threshold: 16, value: 800 }]"}),"), flight lookups, and ",(0,s.jsx)(e.code,{children:"won"}),"/",(0,s.jsx)(e.code,{children:"lost"})," accessors."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"getqualitywinpoints",children:"getQualityWinPoints"}),"\n",(0,s.jsx)(e.p,{children:"Computes quality win bonus points for a participant's won matchUps."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const { qualityWinPoints, qualityWins } = rankingGovernor.getQualityWinPoints({\n  qualityWinProfiles,\n  wonMatchUpIds,\n  mappedMatchUps,\n  participantSideMap,\n  tournamentParticipants,\n  tournamentStartDate: '2025-06-01',\n});\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Looks up opponent rankings from scale items, matches against ranking ranges, applies per-tournament caps."]}),"\n",(0,s.jsxs)(e.p,{children:["See ",(0,s.jsx)(e.a,{href:"/docs/scale-engine/quality-win-points",children:"Quality Win Points"})," for detailed documentation."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"generaterankinglist",children:"generateRankingList"}),"\n",(0,s.jsx)(e.p,{children:"Aggregates point awards from multiple tournaments into a sorted ranking list."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const rankingList = rankingGovernor.generateRankingList({\n  pointAwards: allAwards,\n  aggregationRules: {\n    countingBuckets: [\n      { bucketName: 'Singles', eventTypes: ['SINGLES'], pointComponents: ['positionPoints', 'perWinPoints'], bestOfCount: 6 },\n    ],\n    rollingPeriodDays: 365,\n    tiebreakCriteria: ['highestSingleResult'],\n  },\n  asOfDate: '2025-12-31',\n});\n\n// rankingList[0] = { personId, totalPoints, rank: 1, ... }\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Pure aggregation. Filters, groups, applies counting buckets with maxResultsPerLevel and bestOfCount, computes tiebreakers, assigns ranks."]}),"\n",(0,s.jsxs)(e.p,{children:["See ",(0,s.jsx)(e.a,{href:"/docs/scale-engine/aggregation",children:"Multi-Tournament Aggregation"})," for detailed documentation."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"getparticipantpoints",children:"getParticipantPoints"}),"\n",(0,s.jsx)(e.p,{children:"Returns a per-participant breakdown of counting and dropped results."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const { buckets, totalPoints } = rankingGovernor.getParticipantPoints({\n  pointAwards: allAwards,\n  personId: 'player-abc',\n  aggregationRules,\n});\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Inspect which results count toward a participant's ranking and which are dropped."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"mutation-methods",children:"Mutation Methods"}),"\n",(0,s.jsx)(e.h3,{id:"applytournamentrankingpoints",children:"applyTournamentRankingPoints"}),"\n",(0,s.jsxs)(e.p,{children:["Computes ranking points and persists them as ",(0,s.jsx)(e.a,{href:"/docs/concepts/scaleItems",children:"scale items"})," on participant records."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"const result = rankingGovernor.applyTournamentRankingPoints({\n  tournamentRecord,\n  policyDefinitions: rankingPolicy,\n  scaleName: 'NATIONAL_RANKING',\n  level: 2,\n  removePriorValues: true,\n});\n\n// result.modificationsApplied: number of scaleItems written\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Purpose:"})," Write-back mutation. Calls ",(0,s.jsx)(e.code,{children:"getTournamentPoints"}),", then writes one scale item per participant per eventType. Enables multi-tournament workflows and quality win lookups in subsequent tournaments."]}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Parameter"}),(0,s.jsx)(e.th,{children:"Type"}),(0,s.jsx)(e.th,{children:"Description"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tournamentRecord"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"Tournament"})}),(0,s.jsx)(e.td,{children:"Tournament to compute and persist points for"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"policyDefinitions"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"PolicyDefinitions"})}),(0,s.jsx)(e.td,{children:"Ranking policy"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"scaleName"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"string"})}),(0,s.jsxs)(e.td,{children:["Scale item name (default: ",(0,s.jsx)(e.code,{children:"'RANKING_POINTS'"}),")"]})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"level"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"number"})}),(0,s.jsx)(e.td,{children:"Tournament level"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"removePriorValues"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"boolean"})}),(0,s.jsx)(e.td,{children:"Remove existing items with same scaleName before writing"})]})]})]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"relationship-to-scale-engine",children:"Relationship to Scale Engine"}),"\n",(0,s.jsxs)(e.p,{children:["The rankingGovernor is one of two governors composed into the ",(0,s.jsx)(e.a,{href:"/docs/scale-engine/scale-engine-overview",children:"Scale Engine"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"ScaleEngine = rankingGovernor + ratingsGovernor\n"})}),"\n",(0,s.jsx)(e.p,{children:"All rankingGovernor methods are available as engine methods:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"// Governor approach (stateless)\nrankingGovernor.getTournamentPoints({ tournamentRecord, ... });\n\n// Engine approach (stateful)\nscaleEngine.setState(tournamentRecord);\nscaleEngine.getTournamentPoints({ ... });\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/scale-engine/scale-engine-overview",children:"Scale Engine Overview"})})," \u2014 Stateful engine wrapping this governor"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/scale-engine/scale-engine-api",children:"Scale Engine API"})})," \u2014 Complete method reference"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/scale-engine/ranking-points-pipeline",children:"Ranking Points Pipeline"})})," \u2014 How points are computed"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/scale-engine/quality-win-points",children:"Quality Win Points"})})," \u2014 Quality win bonus system"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/scale-engine/aggregation",children:"Multi-Tournament Aggregation"})})," \u2014 Counting buckets and ranking lists"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/policies/rankingPolicy",children:"Ranking Policy"})})," \u2014 Policy structure reference"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/concepts/scaleItems",children:"Scale Items"})})," \u2014 How rankings are stored"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/governors/governors-overview",children:"Governors Overview"})})," \u2014 All governors"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:(0,s.jsx)(e.a,{href:"/docs/governors/participant-governor",children:"Participant Governor"})})," \u2014 setParticipantScaleItem, getParticipantScaleItem"]}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},8322(n,e,i){i.d(e,{R:()=>o,x:()=>a});var r=i(758);const s={},t=r.createContext(s);function o(n){const e=r.useContext(t);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);
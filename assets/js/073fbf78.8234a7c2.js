"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[6306],{3805:(e,t,a)=>{a.d(t,{xA:()=>g,yg:()=>y});var n=a(758);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var o=n.createContext({}),p=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},g=function(e){var t=p(e.components);return n.createElement(o.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,g=s(e,["components","mdxType","originalType","parentName"]),u=p(a),m=l,y=u["".concat(o,".").concat(m)]||u[m]||c[m]||r;return a?n.createElement(y,i(i({ref:t},g),{},{components:a})):n.createElement(y,i({ref:t},g))}));function y(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,i=new Array(r);i[0]=m;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[u]="string"==typeof e?e:l,i[1]=s;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},1302:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var n=a(2232),l=(a(758),a(3805));const r={},i="Round Robin Tally Policy",s={unversionedId:"policies/roundRobinTallyPolicy",id:"policies/roundRobinTallyPolicy",title:"Round Robin Tally Policy",description:"The Round Robin Tally Policy controls how participants are ranked within round robin groups, including tiebreaking procedures, head-to-head calculations, and group order determination.",source:"@site/docs/policies/roundRobinTallyPolicy.md",sourceDirName:"policies",slug:"/policies/roundRobinTallyPolicy",permalink:"/tods-competition-factory/docs/policies/roundRobinTallyPolicy",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Introduction to Policies",permalink:"/tods-competition-factory/docs/concepts/policies"},next:{title:"Avoidance Policies",permalink:"/tods-competition-factory/docs/policies/avoidance"}},o={},p=[{value:"Overview",id:"overview",level:2},{value:"Default Behavior",id:"default-behavior",level:2},{value:"Standard Tiebreaking Sequence",id:"standard-tiebreaking-sequence",level:3},{value:"Algorithm Overview",id:"algorithm-overview",level:3},{value:"Head-to-Head Logic",id:"head-to-head-logic",level:3},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Calculated Attributes",id:"calculated-attributes",level:3},{value:"Calculation Scoping",id:"calculation-scoping",level:3},{value:"Group Totals",id:"group-totals",level:3},{value:"Directive Processing",id:"directive-processing",level:3},{value:"Precision in Percentages",id:"precision-in-percentages",level:3},{value:"Policy Structure",id:"policy-structure",level:2},{value:"Built-in Policies",id:"built-in-policies",level:2},{value:"Default Tally Policy",id:"default-tally-policy",level:3},{value:"JTT Tally Policy",id:"jtt-tally-policy",level:3},{value:"TOC Tally Policy",id:"toc-tally-policy",level:3},{value:"Key Attributes",id:"key-attributes",level:2},{value:"groupOrderKey",id:"grouporderkey",level:3},{value:"tallyDirectives",id:"tallydirectives",level:3},{value:"idsFilter",id:"idsfilter",level:3},{value:"reversed",id:"reversed",level:3},{value:"maxParticipants",id:"maxparticipants",level:3},{value:"groupTotals",id:"grouptotals",level:3},{value:"headToHead",id:"headtohead",level:3},{value:"Percentage Calculations",id:"percentage-calculations",level:2},{value:"precision",id:"precision",level:3},{value:"groupTotalGamesPlayed / groupTotalSetsPlayed",id:"grouptotalgamesplayed--grouptotalsetsplayed",level:3},{value:"Credit for Incomplete Matches",id:"credit-for-incomplete-matches",level:2},{value:"setsCreditForDefaults / setsCreditForWalkovers / setsCreditForRetirements",id:"setscreditfordefaults--setscreditforwalkovers--setscreditforretirements",level:3},{value:"gamesCreditForDefaults / gamesCreditForWalkovers / gamesCreditForRetirements",id:"gamescreditfordefaults--gamescreditforwalkovers--gamescreditforretirements",level:3},{value:"gamesCreditForTiebreakSets",id:"gamescreditfortiebreaksets",level:3},{value:"Disqualification",id:"disqualification",level:2},{value:"disqualifyDefaults / disqualifyWalkovers",id:"disqualifydefaults--disqualifywalkovers",level:3},{value:"Exclude Match Statuses",id:"exclude-match-statuses",level:2},{value:"excludeMatchUpStatuses",id:"excludematchupstatuses",level:3},{value:"GEMscore",id:"gemscore",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Example 1: Standard Tournament",id:"example-1-standard-tournament",level:3},{value:"Example 2: Custom Tiebreaking",id:"example-2-custom-tiebreaking",level:3},{value:"Example 3: Team Tennis (TEAM Events)",id:"example-3-team-tennis-team-events",level:3},{value:"Example 4: Games-Based Ranking",id:"example-4-games-based-ranking",level:3},{value:"Example 5: Hockey-Style with Penalty Minutes",id:"example-5-hockey-style-with-penalty-minutes",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Always Provide Fallback Directives",id:"1-always-provide-fallback-directives",level:3},{value:"2. Use maxParticipants for Head-to-Head",id:"2-use-maxparticipants-for-head-to-head",level:3},{value:"3. Order Directives Logically",id:"3-order-directives-logically",level:3},{value:"4. Document Tournament-Specific Rules",id:"4-document-tournament-specific-rules",level:3},{value:"Related Documentation",id:"related-documentation",level:2},{value:"Methods",id:"methods",level:2},{value:"tallyParticipantResults",id:"tallyparticipantresults",level:3},{value:"Notes",id:"notes",level:2},{value:"groupOrder vs provisionalOrder",id:"grouporder-vs-provisionalorder",level:3},{value:"Bracket Completion",id:"bracket-completion",level:3},{value:"Circular Ties",id:"circular-ties",level:3},{value:"Testing",id:"testing",level:2}],g={toc:p},u="wrapper";function c(e){let{components:t,...a}=e;return(0,l.yg)(u,(0,n.A)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"round-robin-tally-policy"},"Round Robin Tally Policy"),(0,l.yg)("p",null,"The ",(0,l.yg)("strong",{parentName:"p"},"Round Robin Tally Policy")," controls how participants are ranked within round robin groups, including tiebreaking procedures, head-to-head calculations, and group order determination."),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"overview"},"Overview"),(0,l.yg)("p",null,"Round robin groups require sophisticated tiebreaking rules to determine final standings when participants have equal records. The tally policy provides:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Flexible tiebreaking")," through configurable ",(0,l.yg)("inlineCode",{parentName:"li"},"tallyDirectives")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Head-to-head")," comparisons between tied participants"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Percentage calculations")," (matches, sets, games, points)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Statistical tracking")," (wins, losses, defaults, retirements)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Threshold-based rules")," via ",(0,l.yg)("a",{parentName:"li",href:"/tods-competition-factory/docs/policies/maxParticipants"},"maxParticipants")," attribute"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Composite scoring")," through GEMscore"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Group totals")," for percentage calculations")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"default-behavior"},"Default Behavior"),(0,l.yg)("p",null,"When no custom tally policy is specified, the system applies a comprehensive default tiebreaking procedure that follows widely-accepted tournament standards."),(0,l.yg)("h3",{id:"standard-tiebreaking-sequence"},"Standard Tiebreaking Sequence"),(0,l.yg)("p",null,"The ",(0,l.yg)("strong",{parentName:"p"},"default tally policy")," implements the following hierarchy:"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Primary criterion:")," Participants grouped by ",(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsWon")),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Head-to-head comparison:")," When participants are tied, their direct results against each other are evaluated"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Percentage-based tiebreakers:")," Match, set, game, and point percentages (in order)"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Scope escalation:")," First evaluate all group matches, then recalculate among tied participants only")),(0,l.yg)("h3",{id:"algorithm-overview"},"Algorithm Overview"),(0,l.yg)("p",null,"The tiebreaking algorithm works as follows:"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Group participants")," by the primary attribute (default: ",(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsWon"),")"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"For each tied group:"),(0,l.yg)("ul",{parentName:"li"},(0,l.yg)("li",{parentName:"ul"},"If only 1 participant: resolved (no tie)"),(0,l.yg)("li",{parentName:"ul"},"If exactly 2 participants: compare head-to-head record"),(0,l.yg)("li",{parentName:"ul"},"If 3+ participants: apply ",(0,l.yg)("inlineCode",{parentName:"li"},"tallyDirectives")," sequence"))),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Apply directives")," until ties are broken or all directives exhausted"),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Recursive separation:")," As each directive separates participants, smaller groups are formed and process repeats")),(0,l.yg)("h3",{id:"head-to-head-logic"},"Head-to-Head Logic"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"When 2 participants are tied:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Direct comparison of their match result"),(0,l.yg)("li",{parentName:"ul"},"Winner places higher"),(0,l.yg)("li",{parentName:"ul"},"If they didn't play: move to next directive")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"When 3+ participants are tied:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Calculate statistics among only the tied participants"),(0,l.yg)("li",{parentName:"ul"},"Look for clear separation"),(0,l.yg)("li",{parentName:"ul"},"If circular tie (A>B>C>A): move to next directive")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Head-to-head is applied BEFORE tallyDirectives")," unless explicitly disabled via ",(0,l.yg)("inlineCode",{parentName:"p"},"headToHead: { disabled: true }"),"."),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"implementation-details"},"Implementation Details"),(0,l.yg)("h3",{id:"calculated-attributes"},"Calculated Attributes"),(0,l.yg)("p",null,"For each participant, the following attributes are calculated from match results:"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Match-level:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsWon")," - Total matches won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsLost")," - Total matches lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsCancelled")," - Matches that were cancelled/abandoned"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsPct")," - Win percentage: ",(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsWon / (matchUpsWon + matchUpsLost)"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Set-level:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsWon")," - Total sets won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsLost")," - Total sets lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsPct")," - Win percentage: ",(0,l.yg)("inlineCode",{parentName:"li"},"setsWon / (setsWon + setsLost)"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Game-level:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesWon")," - Total games won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesLost")," - Total games lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesPct")," - Win percentage: ",(0,l.yg)("inlineCode",{parentName:"li"},"gamesWon / (gamesWon + gamesLost)"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Point-level:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsWon")," - Total points won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsLost")," - Total points lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsPct")," - Win percentage: ",(0,l.yg)("inlineCode",{parentName:"li"},"pointsWon / (pointsWon + pointsLost)"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Incomplete matches:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"defaults")," - Number of times participant defaulted"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"walkovers")," - Number of times participant walked over"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"retirements")," - Number of times participant retired"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"allDefaults")," - Total of all exit statuses (defaults + walkovers + retirements)")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"TEAM events (tieMatchUps):")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieMatchUpsWon")," - Individual matches won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieMatchUpsLost")," - Individual matches lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieSinglesWon")," - Singles matches won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieSinglesLost")," - Singles matches lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieDoublesWon")," - Doubles matches won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieDoublesLost")," - Doubles matches lost")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Final result:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"groupOrder")," - Final placement (1-based, lower is better)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"GEMscore")," - Composite score (if configured)")),(0,l.yg)("h3",{id:"calculation-scoping"},"Calculation Scoping"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Global scope (idsFilter: false):")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// Calculate from ALL group matches\nmatchUpsPct = matchUpsWon / (matchUpsWon + matchUpsLost);\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Filtered scope (idsFilter: true):")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// Calculate from ONLY matches among tied participants\n// Example: If A, B, C are tied, only count A-B, A-C, B-C matches\nmatchUpsPct = matchUpsWon_amongTied / (matchUpsWon_amongTied + matchUpsLost_amongTied);\n")),(0,l.yg)("h3",{id:"group-totals"},"Group Totals"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Participant-based (groupTotals: false - default):")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"gamesPct = gamesWon / (gamesWon + gamesLost);\n// Each participant's denominator is their own games\n// Sum of all gamesPct can exceed 1.0\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Group-based (groupTotals: true):")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"totalGroupGames = sum of all gamesWon by all participants\ngamesPct = gamesWon / totalGroupGames\n// Sum of all gamesPct = 1.0\n")),(0,l.yg)("h3",{id:"directive-processing"},"Directive Processing"),(0,l.yg)("p",null,"Directives are applied sequentially:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"for (const directive of tallyDirectives) {\n  // 1. Check maxParticipants threshold\n  if (directive.maxParticipants && tiedCount > directive.maxParticipants) {\n    continue; // Skip this directive\n  }\n\n  // 2. Calculate attribute (with idsFilter if specified)\n  const values = calculateAttribute(directive, tiedParticipants);\n\n  // 3. Sort (reversed if specified)\n  const sorted = directive.reversed\n    ? sortAscending(values) // Least to greatest\n    : sortDescending(values); // Greatest to least\n\n  // 4. Separate into groups by value\n  const groups = groupByValue(sorted);\n\n  // 5. Recursively process each group\n  groups.forEach((group) => {\n    if (group.length > 1) {\n      // Still tied, continue with next directive\n    } else {\n      // Resolved! Assign groupOrder\n    }\n  });\n}\n")),(0,l.yg)("h3",{id:"precision-in-percentages"},"Precision in Percentages"),(0,l.yg)("p",null,"Percentages are calculated with configurable precision:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const precision = Math.pow(10, tallyPolicy?.precision || 3);\n// precision: 3 \u2192 1000 \u2192 0.667\n// precision: 5 \u2192 100000 \u2192 0.66667\n\nmatchUpsPct = Math.round((matchUpsWon / matchUpsTotal) * precision) / precision;\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"policy-structure"},"Policy Structure"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-typescript"},"type RoundRobinTallyPolicy = {\n  policyName?: string;\n\n  // Initial grouping attribute\n  groupOrderKey?:\n    | 'matchUpsWon'\n    | 'tieMatchUpsWon'\n    | 'tieSinglesWon'\n    | 'tieDoublesWon'\n    | 'pointsWon'\n    | 'gamesWon'\n    | 'setsWon'\n    | 'gamesPct'\n    | 'setsPct'\n    | 'pointsPct'\n    | 'matchUpsPct';\n\n  // Tiebreaking sequence\n  tallyDirectives?: Array<{\n    attribute: string; // Which statistic to compare\n    idsFilter?: boolean; // Compare only tied participants\n    reversed?: boolean; // Least-to-greatest instead of greatest-to-least\n    maxParticipants?: number; // Only apply if # tied <= threshold\n    groupTotals?: boolean; // Use group totals for percentages\n    disableHeadToHead?: boolean; // Skip head-to-head for this directive\n  }>;\n\n  // Head-to-head configuration\n  headToHead?: {\n    disabled?: boolean; // Skip head-to-head entirely\n  };\n\n  // Percentage calculation options\n  groupTotalGamesPlayed?: boolean; // Use all group games for gamesPct\n  groupTotalSetsPlayed?: boolean; // Use all group sets for setsPct\n  precision?: number; // Decimal precision (default: 3)\n\n  // Disqualification rules\n  disqualifyDefaults?: boolean; // Push defaulting participants to bottom\n  disqualifyWalkovers?: boolean; // Push walkover participants to bottom\n\n  // Exclude specific match statuses\n  excludeMatchUpStatuses?: string[]; // e.g., ['ABANDONED', 'INCOMPLETE']\n\n  // Credit for incomplete matches\n  setsCreditForDefaults?: boolean;\n  setsCreditForWalkovers?: boolean;\n  setsCreditForRetirements?: boolean;\n  gamesCreditForDefaults?: boolean;\n  gamesCreditForWalkovers?: boolean;\n  gamesCreditForRetirements?: boolean;\n  gamesCreditForTiebreakSets?: boolean; // Default: true\n\n  // Composite score attributes\n  GEMscore?: string[]; // Attributes to include in GEMscore calculation\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"built-in-policies"},"Built-in Policies"),(0,l.yg)("h3",{id:"default-tally-policy"},"Default Tally Policy"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Standard tiebreaking procedure:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"import { POLICY_ROUND_ROBIN_TALLY_DEFAULT } from 'tods-competition-factory';\n\nconst policy = POLICY_ROUND_ROBIN_TALLY_DEFAULT[POLICY_TYPE_ROUND_ROBIN_TALLY];\n// {\n//   policyName: 'Default Round Robin Tally',\n//   groupOrderKey: 'matchUpsWon',\n//   tallyDirectives: [\n//     { attribute: 'matchUpsPct', idsFilter: false },\n//     { attribute: 'allDefaults', reversed: true, idsFilter: false },\n//     { attribute: 'defaults', reversed: true, idsFilter: false },\n//     { attribute: 'walkovers', reversed: true, idsFilter: false },\n//     { attribute: 'retirements', reversed: true, idsFilter: false },\n//     { attribute: 'setsPct', idsFilter: false },\n//     { attribute: 'gamesPct', idsFilter: false },\n//     { attribute: 'pointsPct', idsFilter: false },\n//     { attribute: 'matchUpsPct', idsFilter: true },\n//     { attribute: 'setsPct', idsFilter: true },\n//     { attribute: 'gamesPct', idsFilter: true },\n//     { attribute: 'pointsPct', idsFilter: true },\n//   ],\n// }\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Tiebreaking sequence:")),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"Match win percentage (all group matches)"),(0,l.yg)("li",{parentName:"ol"},"Fewest all defaults (any exit status)"),(0,l.yg)("li",{parentName:"ol"},"Fewest defaults"),(0,l.yg)("li",{parentName:"ol"},"Fewest walkovers"),(0,l.yg)("li",{parentName:"ol"},"Fewest retirements"),(0,l.yg)("li",{parentName:"ol"},"Set win percentage (all group matches)"),(0,l.yg)("li",{parentName:"ol"},"Game win percentage (all group matches)"),(0,l.yg)("li",{parentName:"ol"},"Point win percentage (all group matches)"),(0,l.yg)("li",{parentName:"ol"},"Match win percentage (among tied teams only)"),(0,l.yg)("li",{parentName:"ol"},"Set win percentage (among tied teams only)"),(0,l.yg)("li",{parentName:"ol"},"Game win percentage (among tied teams only)"),(0,l.yg)("li",{parentName:"ol"},"Point win percentage (among tied teams only)")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"jtt-tally-policy"},"JTT Tally Policy"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Junior Team Tennis format:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"import { POLICY_ROUND_ROBIN_TALLY_JTT } from 'tods-competition-factory';\n\n// {\n//   policyName: 'JTT Round Robin Tally',\n//   groupOrderKey: 'gamesWon',\n//   tallyDirectives: [\n//     { attribute: 'matchUpsPct', idsFilter: true },\n//     { attribute: 'gamesWon', idsFilter: false },\n//     { attribute: 'matchUpsWon', idsFilter: false },\n//     { attribute: 'tieMatchUpsWon', idsFilter: false },\n//     { attribute: 'setsWon', idsFilter: false },\n//   ],\n// }\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Key features:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Primary criterion:")," Most games won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Head-to-head first:")," matchUpsPct with idsFilter: true"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Designed for team tennis")," where games won is primary metric")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"toc-tally-policy"},"TOC Tally Policy"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Tournament of Champions format:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"import { POLICY_ROUND_ROBIN_TALLY_TOC } from 'tods-competition-factory';\n\n// {\n//   policyName: 'TOC Round Robin Tally',\n//   groupOrderKey: 'matchUpsPct',\n//   tallyDirectives: [\n//     { attribute: 'matchUpsPct', idsFilter: true, maxParticipants: 2 },\n//     { attribute: 'gamesPct', idsFilter: false },\n//     { attribute: 'gamesWon', idsFilter: false },\n//     { attribute: 'gamesLost', idsFilter: false, reversed: true },\n//   ],\n// }\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Key features:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"maxParticipants: 2")," on head-to-head (only if 2 teams tied)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Games percentage")," for 3+ team ties"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"Fewest games lost")," as final tiebreaker")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"key-attributes"},"Key Attributes"),(0,l.yg)("h3",{id:"grouporderkey"},"groupOrderKey"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Initial attribute to group participants by before applying tiebreakers."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Valid values:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'matchUpsWon'")," (default)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'tieMatchUpsWon'")," (for TEAM events)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'tieSinglesWon'")," (for TEAM events)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'tieDoublesWon'")," (for TEAM events)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'pointsWon'")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'gamesWon'")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'setsWon'")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'gamesPct'")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'setsPct'")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'pointsPct'")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"'matchUpsPct'"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const policy = {\n  [POLICY_TYPE_ROUND_ROBIN_TALLY]: {\n    groupOrderKey: 'gamesWon', // Group by total games won\n    tallyDirectives: [{ attribute: 'gamesPct', idsFilter: false }],\n  },\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"tallydirectives"},"tallyDirectives"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Sequence of tiebreaking rules applied in order."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Structure:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  attribute: string;        // Statistic to compare\n  idsFilter?: boolean;      // Scope to tied participants only\n  reversed?: boolean;       // Reverse sort order (least-to-greatest)\n  maxParticipants?: number; // Threshold-based application\n  groupTotals?: boolean;    // Use group totals for percentages\n}\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Directive attributes:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsPct")," - Match win percentage"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsPct")," - Set win percentage"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesPct")," - Game win percentage"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsPct")," - Point win percentage"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsWon")," - Total matches won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsWon")," - Total sets won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesWon")," - Total games won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsWon")," - Total points won"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsLost")," - Total matches lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsLost")," - Total sets lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesLost")," - Total games lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsLost")," - Total points lost"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"defaults")," - Number of defaults"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"walkovers")," - Number of walkovers"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"retirements")," - Number of retirements"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"allDefaults")," - All exit statuses combined"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieMatchUpsWon")," - Individual matches won (TEAM events)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieSinglesWon")," - Singles matches won (TEAM events)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieDoublesWon")," - Doubles matches won (TEAM events)")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"See also:")," ",(0,l.yg)("a",{parentName:"p",href:"/tods-competition-factory/docs/policies/maxParticipants"},"maxParticipants documentation")," for threshold-based tiebreaking"),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"idsfilter"},"idsFilter"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Scope calculations to only the tied participants."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"When false (default):")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Statistics calculated from ALL group matches"),(0,l.yg)("li",{parentName:"ul"},"Example: gamesPct = gamesWon / (gamesWon + gamesLost) across entire group")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"When true:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Statistics calculated ONLY from matches among tied participants"),(0,l.yg)("li",{parentName:"ul"},"Example: If A, B, C are tied, only count A-B, A-C, B-C matches"),(0,l.yg)("li",{parentName:"ul"},"Used for head-to-head comparisons")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"tallyDirectives: [\n  // Stage 1: Overall group performance\n  { attribute: 'gamesPct', idsFilter: false },\n\n  // Stage 2: Performance among tied teams only\n  { attribute: 'gamesPct', idsFilter: true },\n];\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"reversed"},"reversed"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Reverse sort order from greatest-to-least to least-to-greatest."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Use cases:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Fewest losses"),(0,l.yg)("li",{parentName:"ul"},"Fewest defaults/walkovers/retirements"),(0,l.yg)("li",{parentName:"ul"},"Fewest penalty minutes"),(0,l.yg)("li",{parentName:"ul"},'Any "lower is better" metric')),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"tallyDirectives: [\n  { attribute: 'gamesWon', reversed: false }, // Most games won\n  { attribute: 'gamesLost', reversed: true }, // Fewest games lost\n];\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"maxparticipants"},"maxParticipants"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Only apply directive when number of tied participants does not exceed threshold."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Common usage:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  attribute: 'matchUpsPct',\n  idsFilter: true,\n  maxParticipants: 2  // Only if exactly 2 teams tied\n}\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Why this exists:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"2 teams:")," Direct head-to-head works (one beat the other)"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"3+ teams:")," Circular ties possible (A>B>C>A)"),(0,l.yg)("li",{parentName:"ul"},"Sports rules universally distinguish 2-team vs 3+-team ties")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"See:")," ",(0,l.yg)("a",{parentName:"p",href:"/tods-competition-factory/docs/policies/maxParticipants"},"maxParticipants documentation")," for complete details and sports precedents"),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"grouptotals"},"groupTotals"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Use total group games/sets for percentage calculations instead of participant totals."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"When false (default):")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"gamesPct = gamesWon / (gamesWon + gamesLost)\n// Sum of all gamesPct can be > 1.0\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"When true:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"gamesPct = gamesWon / (total games played by all participants)\n// Sum of all gamesPct = 1.0\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"tallyDirectives: [\n  {\n    attribute: 'gamesPct',\n    idsFilter: false,\n    groupTotals: true, // Use total group games as denominator\n  },\n];\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Or set at top level:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  groupTotalGamesPlayed: true,  // All gamesPct calculations\n  groupTotalSetsPlayed: true,   // All setsPct calculations\n}\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"headtohead"},"headToHead"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Configure head-to-head tiebreaking behavior."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Default behavior:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"When 2 participants tied: Compare their head-to-head record"),(0,l.yg)("li",{parentName:"ul"},"When 3+ participants tied: Try to separate with head-to-head among all tied")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Disable completely:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  headToHead: { disabled: true },\n  tallyDirectives: [\n    // Head-to-head skipped, go straight to directives\n    { attribute: 'gamesPct', idsFilter: false },\n  ],\n}\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Note:")," Head-to-head happens BEFORE tallyDirectives. Disabling it forces all tiebreaking through directives."),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"percentage-calculations"},"Percentage Calculations"),(0,l.yg)("h3",{id:"precision"},"precision"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Control decimal precision for percentage calculations."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Default:")," 3 (1000)"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  precision: 5,  // Results: 0.66667 instead of 0.667\n}\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Formula:")," ",(0,l.yg)("inlineCode",{parentName:"p"},"Math.pow(10, precision)")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"precision: 3 \u2192 1000 \u2192 0.667"),(0,l.yg)("li",{parentName:"ul"},"precision: 5 \u2192 100000 \u2192 0.66667"),(0,l.yg)("li",{parentName:"ul"},"precision: 7 \u2192 10000000 \u2192 0.6666667")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"grouptotalgamesplayed--grouptotalsetsplayed"},"groupTotalGamesPlayed / groupTotalSetsPlayed"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Use total group games/sets as denominator for percentage calculations."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example scenario:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"4 participants in round robin (6 total matches):\n- Participant A: 12 games won, 6 games lost\n- Participant B: 10 games won, 8 games lost\n- Participant C: 8 games won, 10 games lost\n- Participant D: 6 games won, 12 games lost\nTotal: 36 games won, 36 games lost (72 games total)\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Without groupTotalGamesPlayed:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"A: 12/18 = 66.7%\nB: 10/18 = 55.6%\nC: 8/18 = 44.4%\nD: 6/18 = 33.3%\nTotal: 200%\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"With groupTotalGamesPlayed:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"A: 12/72 = 16.7%\nB: 10/72 = 13.9%\nC: 8/72 = 11.1%\nD: 6/72 = 8.3%\nTotal: 50% (games won / total games)\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"credit-for-incomplete-matches"},"Credit for Incomplete Matches"),(0,l.yg)("h3",{id:"setscreditfordefaults--setscreditforwalkovers--setscreditforretirements"},"setsCreditForDefaults / setsCreditForWalkovers / setsCreditForRetirements"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Award winner full sets when opponent doesn't complete match."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Default:")," All false"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// Best of 3 (2 sets to win)\n// Match: A vs B, score 6-3, B retires\n\n// Without setsCreditForRetirements:\nA: 1 set won\n\n// With setsCreditForRetirements:\nA: 2 sets won (awarded setsToWin)\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Policy:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  setsCreditForRetirements: true,\n  setsCreditForDefaults: true,\n  setsCreditForWalkovers: true,\n}\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"gamescreditfordefaults--gamescreditforwalkovers--gamescreditforretirements"},"gamesCreditForDefaults / gamesCreditForWalkovers / gamesCreditForRetirements"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Award winner estimated games when opponent doesn't complete match."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Default:")," All false"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// Best of 3, standard scoring (6 games per set)\n// Match: A vs B, score 6-3, B retires\n\n// Without gamesCreditForRetirements:\nA: 6 games won\n\n// With gamesCreditForRetirements:\nA: 12 games won (estimated from setsToWin * 6)\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"gamescreditfortiebreaksets"},"gamesCreditForTiebreakSets"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Count tiebreak set as 1 game won."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Default:")," true"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// Match: A vs B, score 6-3 3-6 [10-5]\n\n// With gamesCreditForTiebreakSets: true\nA: 6 + 3 + 1 = 10 games won\nB: 3 + 6 = 9 games won\n\n// With gamesCreditForTiebreakSets: false\nA: 6 + 3 = 9 games won\nB: 3 + 6 = 9 games won\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Policy:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  gamesCreditForTiebreakSets: false,  // Don't count [10-x] as game\n}\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"disqualification"},"Disqualification"),(0,l.yg)("h3",{id:"disqualifydefaults--disqualifywalkovers"},"disqualifyDefaults / disqualifyWalkovers"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Push participants who defaulted/walked over to bottom of group order."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Default:")," true (in most built-in policies)"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// 4 participants:\n// A: 2-1\n// B: 2-1\n// C: 1-2\n// D: 1-2 (with 1 DEFAULT)\n\n// With disqualifyDefaults: true\nOrder: A, B, C, D (4th - pushed to bottom)\n\n// With disqualifyDefaults: false\nOrder: A, B, C/D tied (use tiebreakers)\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Policy:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  disqualifyDefaults: true,\n  disqualifyWalkovers: true,\n}\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"exclude-match-statuses"},"Exclude Match Statuses"),(0,l.yg)("h3",{id:"excludematchupstatuses"},"excludeMatchUpStatuses"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Exclude specific match statuses from tally calculations."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Use cases:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Exclude ABANDONED matches"),(0,l.yg)("li",{parentName:"ul"},"Exclude INCOMPLETE matches"),(0,l.yg)("li",{parentName:"ul"},"Exclude matches that shouldn't count toward standings")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Example:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  excludeMatchUpStatuses: ['ABANDONED', 'INCOMPLETE'],\n}\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Effect:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Excluded matches don't count toward wins/losses"),(0,l.yg)("li",{parentName:"ul"},"Not included in percentage calculations"),(0,l.yg)("li",{parentName:"ul"},"Treated as if they never happened")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"gemscore"},"GEMscore"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Purpose:")," Create composite score from multiple attributes."),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Formula:")," Weighted combination of percentage attributes"),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Attributes:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"matchUpsPct")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"tieMatchUpsPct")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"setsPct")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"gamesPct")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"pointsPct"))),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Result:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"participantResults: {\n  participantId123: {\n    matchUpsWon: 2,\n    matchUpsLost: 1,\n    matchUpsPct: 0.667,\n    setsPct: 0.714,\n    gamesPct: 0.650,\n    GEMscore: 85234567, // Composite integer score\n  }\n}\n")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Usage:")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Alternative ranking metric"),(0,l.yg)("li",{parentName:"ul"},"Visual representation of overall performance"),(0,l.yg)("li",{parentName:"ul"},"Can be used as tiebreaker attribute")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"usage-examples"},"Usage Examples"),(0,l.yg)("h3",{id:"example-1-standard-tournament"},"Example 1: Standard Tournament"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"import { POLICY_TYPE_ROUND_ROBIN_TALLY, POLICY_ROUND_ROBIN_TALLY_DEFAULT } from 'tods-competition-factory';\n\nconst tournament = {\n  policyDefinitions: POLICY_ROUND_ROBIN_TALLY_DEFAULT,\n};\n\ntournamentEngine.generateDrawDefinition({\n  drawType: ROUND_ROBIN,\n  policyDefinitions: tournament.policyDefinitions,\n  drawSize: 16,\n  // ... other options\n});\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"example-2-custom-tiebreaking"},"Example 2: Custom Tiebreaking"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const customPolicy = {\n  [POLICY_TYPE_ROUND_ROBIN_TALLY]: {\n    policyName: 'Custom Tournament 2024',\n    groupOrderKey: 'matchUpsWon',\n\n    tallyDirectives: [\n      // 1. Head-to-head if exactly 2 tied\n      {\n        attribute: 'matchUpsPct',\n        idsFilter: true,\n        maxParticipants: 2,\n      },\n\n      // 2. Games percentage (all matches)\n      {\n        attribute: 'gamesPct',\n        idsFilter: false,\n      },\n\n      // 3. Sets percentage (all matches)\n      {\n        attribute: 'setsPct',\n        idsFilter: false,\n      },\n\n      // 4. Games won among tied teams\n      {\n        attribute: 'gamesWon',\n        idsFilter: true,\n      },\n\n      // 5. Fewest games lost\n      {\n        attribute: 'gamesLost',\n        idsFilter: false,\n        reversed: true,\n      },\n    ],\n\n    disqualifyDefaults: true,\n    disqualifyWalkovers: true,\n  },\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"example-3-team-tennis-team-events"},"Example 3: Team Tennis (TEAM Events)"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const teamPolicy = {\n  [POLICY_TYPE_ROUND_ROBIN_TALLY]: {\n    policyName: 'Team Championship',\n    groupOrderKey: 'tieMatchUpsWon', // Individual matches won\n\n    tallyDirectives: [\n      // Team match record among tied teams\n      {\n        attribute: 'matchUpsPct',\n        idsFilter: true,\n        maxParticipants: 2,\n      },\n\n      // Individual matches won\n      {\n        attribute: 'tieMatchUpsWon',\n        idsFilter: false,\n      },\n\n      // Singles matches won\n      {\n        attribute: 'tieSinglesWon',\n        idsFilter: false,\n      },\n\n      // Doubles matches won\n      {\n        attribute: 'tieDoublesWon',\n        idsFilter: false,\n      },\n\n      // Sets won\n      {\n        attribute: 'setsWon',\n        idsFilter: false,\n      },\n    ],\n  },\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"example-4-games-based-ranking"},"Example 4: Games-Based Ranking"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const gamesPolicy = {\n  [POLICY_TYPE_ROUND_ROBIN_TALLY]: {\n    policyName: 'Games Primary',\n    groupOrderKey: 'gamesWon',\n\n    tallyDirectives: [\n      // Most games won\n      {\n        attribute: 'gamesWon',\n        idsFilter: false,\n      },\n\n      // Fewest games lost\n      {\n        attribute: 'gamesLost',\n        idsFilter: false,\n        reversed: true,\n      },\n\n      // Game percentage\n      {\n        attribute: 'gamesPct',\n        idsFilter: false,\n      },\n\n      // Head-to-head if 2 teams\n      {\n        attribute: 'matchUpsPct',\n        idsFilter: true,\n        maxParticipants: 2,\n      },\n    ],\n\n    // Award games for walkovers/defaults\n    gamesCreditForWalkovers: true,\n    gamesCreditForDefaults: true,\n  },\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"example-5-hockey-style-with-penalty-minutes"},"Example 5: Hockey-Style with Penalty Minutes"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const hockeyPolicy = {\n  [POLICY_TYPE_ROUND_ROBIN_TALLY]: {\n    policyName: 'Hockey Tournament',\n    groupOrderKey: 'matchUpsWon',\n\n    tallyDirectives: [\n      // Head-to-head (2 teams only)\n      {\n        attribute: 'matchUpsPct',\n        idsFilter: true,\n        maxParticipants: 2,\n      },\n\n      // Most wins\n      {\n        attribute: 'matchUpsWon',\n        idsFilter: false,\n      },\n\n      // Goal average (custom attribute - would need implementation)\n      // { attribute: 'goalAverage', idsFilter: false },\n\n      // Fewest penalty minutes (custom attribute)\n      // { attribute: 'penaltyMinutes', idsFilter: false, reversed: true },\n\n      // Fallback to games\n      {\n        attribute: 'gamesPct',\n        idsFilter: false,\n      },\n    ],\n  },\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"best-practices"},"Best Practices"),(0,l.yg)("h3",{id:"1-always-provide-fallback-directives"},"1. Always Provide Fallback Directives"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// \u2713 GOOD: Multiple tiebreakers\ntallyDirectives: [\n  { attribute: 'matchUpsPct', idsFilter: true, maxParticipants: 2 },\n  { attribute: 'gamesPct', idsFilter: false },\n  { attribute: 'gamesWon', idsFilter: false },\n  { attribute: 'gamesLost', idsFilter: false, reversed: true },\n];\n\n// \u2717 BAD: Single tiebreaker might not resolve all ties\ntallyDirectives: [{ attribute: 'matchUpsPct', idsFilter: true, maxParticipants: 2 }];\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"2-use-maxparticipants-for-head-to-head"},"2. Use maxParticipants for Head-to-Head"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// \u2713 GOOD: Only apply head-to-head when it makes sense\n{\n  attribute: 'matchUpsPct',\n  idsFilter: true,\n  maxParticipants: 2  // Skip if 3+ teams (circular ties possible)\n}\n\n// \u2717 RISKY: Head-to-head with 3+ teams can be indeterminate\n{\n  attribute: 'matchUpsPct',\n  idsFilter: true  // May not separate circular ties\n}\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"3-order-directives-logically"},"3. Order Directives Logically"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"// \u2713 GOOD: Broad criteria first, narrow criteria later\ntallyDirectives: [\n  { attribute: 'matchUpsPct', idsFilter: false }, // Overall record\n  { attribute: 'setsPct', idsFilter: false }, // Overall sets\n  { attribute: 'matchUpsPct', idsFilter: true }, // Head-to-head\n  { attribute: 'setsPct', idsFilter: true }, // H2H sets\n];\n\n// \u2717 CONFUSING: Narrow then broad\ntallyDirectives: [\n  { attribute: 'matchUpsPct', idsFilter: true }, // H2H first\n  { attribute: 'matchUpsPct', idsFilter: false }, // Then overall\n];\n")),(0,l.yg)("hr",null),(0,l.yg)("h3",{id:"4-document-tournament-specific-rules"},"4. Document Tournament-Specific Rules"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const tournamentPolicy = {\n  [POLICY_TYPE_ROUND_ROBIN_TALLY]: {\n    policyName: 'Spring Championship 2024',\n    // Document: \"Per tournament regulations section 5.3\"\n    groupOrderKey: 'matchUpsWon',\n    tallyDirectives: [\n      // Rule 5.3.1: Head-to-head if 2 teams tied\n      { attribute: 'matchUpsPct', idsFilter: true, maxParticipants: 2 },\n      // Rule 5.3.2: Games won percentage\n      { attribute: 'gamesPct', idsFilter: false },\n      // Rule 5.3.3: Fewest games lost\n      { attribute: 'gamesLost', idsFilter: false, reversed: true },\n    ],\n  },\n};\n")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"related-documentation"},"Related Documentation"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},(0,l.yg)("a",{parentName:"strong",href:"/tods-competition-factory/docs/policies/maxParticipants"},"maxParticipants"))," - Threshold-based tiebreaking rules"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},(0,l.yg)("a",{parentName:"strong",href:"/tods-competition-factory/docs/policies/seedingPolicy"},"Seeding Policy"))," - How participants are seeded into draws"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},(0,l.yg)("a",{parentName:"strong",href:"/tods-competition-factory/docs/policies/feedInPolicy"},"Feed-In Policy"))," - Consolation feed patterns"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},(0,l.yg)("a",{parentName:"strong",href:"/tods-competition-factory/docs/concepts/policies"},"Policies Overview"))," - All policy types")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"methods"},"Methods"),(0,l.yg)("h3",{id:"tallyparticipantresults"},"tallyParticipantResults"),(0,l.yg)("p",null,"Calculate participant results and group order based on the round robin tally policy."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"import { tallyParticipantResults } from 'tods-competition-factory';\n\nconst { participantResults, order, report, readableReport } = tallyParticipantResults({\n  matchUps, // Array of matchUps\n  policyDefinitions, // Policy definitions object\n  matchUpFormat, // Optional default format\n  generateReport: true, // Optional: generate detailed tiebreaking report\n});\n\n// participantResults: {\n//   [participantId]: {\n//     matchUpsWon: number;\n//     matchUpsLost: number;\n//     setsWon: number;\n//     setsLost: number;\n//     gamesWon: number;\n//     gamesLost: number;\n//     pointsWon: number;\n//     pointsLost: number;\n//     matchUpsPct: number;\n//     setsPct: number;\n//     gamesPct: number;\n//     pointsPct: number;\n//     defaults: number;\n//     walkovers: number;\n//     retirements: number;\n//     allDefaults: number;\n//     groupOrder: number;      // Final placement (when bracket complete)\n//     provisionalOrder: number; // Current placement (when incomplete)\n//     GEMscore?: number;       // If configured\n//   }\n// }\n")),(0,l.yg)("admonition",{title:"Understanding Tiebreaking",type:"tip"},(0,l.yg)("p",{parentName:"admonition"},"When ",(0,l.yg)("inlineCode",{parentName:"p"},"generateReport: true"),", the function returns detailed information showing ",(0,l.yg)("strong",{parentName:"p"},"exactly how tiebreaks were resolved step-by-step"),". This is invaluable for:"),(0,l.yg)("ul",{parentName:"admonition"},(0,l.yg)("li",{parentName:"ul"},"Explaining to participants why they finished in a specific position"),(0,l.yg)("li",{parentName:"ul"},"Verifying that tiebreaking followed the expected policy"),(0,l.yg)("li",{parentName:"ul"},"Debugging complex tiebreaking scenarios"),(0,l.yg)("li",{parentName:"ul"},"Creating transparent tournament reports")),(0,l.yg)("p",{parentName:"admonition"},"See ",(0,l.yg)("strong",{parentName:"p"},(0,l.yg)("a",{parentName:"strong",href:"/tods-competition-factory/docs/governors/query-governor#tallyparticipantresults"},"Query Governor - tallyParticipantResults"))," for complete documentation of the ",(0,l.yg)("inlineCode",{parentName:"p"},"generateReport")," parameter and examples of using the tiebreaking report.")),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"notes"},"Notes"),(0,l.yg)("h3",{id:"grouporder-vs-provisionalorder"},"groupOrder vs provisionalOrder"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"groupOrder:")," Assigned when bracket is complete"),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("strong",{parentName:"li"},"provisionalOrder:")," Assigned when bracket is incomplete"),(0,l.yg)("li",{parentName:"ul"},"See ",(0,l.yg)("inlineCode",{parentName:"li"},"provisionalPositioning")," in ",(0,l.yg)("a",{parentName:"li",href:"/tods-competition-factory/docs/governors/draws-governor"},"Draws Governor"))),(0,l.yg)("h3",{id:"bracket-completion"},"Bracket Completion"),(0,l.yg)("p",null,"Group order is ONLY assigned when all required matchUps are complete:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-javascript"},"const bracketComplete = relevantMatchUps.filter((matchUp) => isComplete(matchUp)).length === relevantMatchUps.length;\n\nif (bracketComplete && groupOrder) {\n  // Assign groupOrder to participantResults\n}\n")),(0,l.yg)("p",null,"For incomplete brackets, use ",(0,l.yg)("inlineCode",{parentName:"p"},"provisionalOrder")," instead."),(0,l.yg)("h3",{id:"circular-ties"},"Circular Ties"),(0,l.yg)("p",null,"With 3+ participants, circular ties are possible:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"Team A beats Team B"),(0,l.yg)("li",{parentName:"ul"},"Team B beats Team C"),(0,l.yg)("li",{parentName:"ul"},"Team C beats Team A"),(0,l.yg)("li",{parentName:"ul"},"All teams 1-1 head-to-head")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Solution:")," Use ",(0,l.yg)("inlineCode",{parentName:"p"},"maxParticipants: 2")," on head-to-head rules to skip circular tie scenarios."),(0,l.yg)("p",null,"See ",(0,l.yg)("a",{parentName:"p",href:"/tods-competition-factory/docs/policies/maxParticipants"},"maxParticipants documentation")," for details."),(0,l.yg)("hr",null),(0,l.yg)("h2",{id:"testing"},"Testing"),(0,l.yg)("p",null,"Comprehensive test coverage in ",(0,l.yg)("inlineCode",{parentName:"p"},"src/tests/documentation/roundRobinTallyPolicy.test.ts"),":"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\u2705 All built-in policies"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Precision calculations"),(0,l.yg)("li",{parentName:"ul"},"\u2705 maxParticipants thresholds"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Reversed attributes"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Disqualification rules"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Exclude match statuses"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Credit for incomplete matches"),(0,l.yg)("li",{parentName:"ul"},"\u2705 groupTotals calculations"),(0,l.yg)("li",{parentName:"ul"},"\u2705 idsFilter scoping"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Head-to-head configurations"),(0,l.yg)("li",{parentName:"ul"},"\u2705 GEMscore generation"),(0,l.yg)("li",{parentName:"ul"},"\u2705 TEAM event statistics"),(0,l.yg)("li",{parentName:"ul"},"\u2705 Circular tie scenarios")),(0,l.yg)("p",null,(0,l.yg)("strong",{parentName:"p"},"Total: 27 tests, all passing \u2705")))}c.isMDXComponent=!0}}]);
"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[5875],{8322(e,n,t){t.d(n,{R:()=>s,x:()=>d});var i=t(758);const a={},r=i.createContext(a);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:n},e.children)}},9717(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"governors/event-governor","title":"Event Governor","description":"addDrawDefinition","source":"@site/docs/governors/event-governor.md","sourceDirName":"governors","slug":"/governors/event-governor","permalink":"/competition-factory/docs/governors/event-governor","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Event Governor"},"sidebar":"docs","previous":{"title":"Entries Governor","permalink":"/competition-factory/docs/governors/entries-governor"},"next":{"title":"Generation Governor","permalink":"/competition-factory/docs/governors/generation-governor"}}');var a=t(6070),r=t(8322);const s={title:"Event Governor"},d=void 0,o={},l=[{value:"addDrawDefinition",id:"adddrawdefinition",level:2},{value:"addEvent",id:"addevent",level:2},{value:"addFlight",id:"addflight",level:2},{value:"assignSeedPositions",id:"assignseedpositions",level:2},{value:"attachFlightProfile",id:"attachflightprofile",level:2},{value:"deleteDrawDefinitions",id:"deletedrawdefinitions",level:2},{value:"deleteEvents",id:"deleteevents",level:2},{value:"deleteFlightAndFlightDraw",id:"deleteflightandflightdraw",level:2},{value:"deleteFlightProfileAndFlightDraws",id:"deleteflightprofileandflightdraws",level:2},{value:"getCategoryAgeDetails",id:"getcategoryagedetails",level:2},{value:"modifyEvent",id:"modifyevent",level:2},{value:"modifyEventMatchUpFormatTiming",id:"modifyeventmatchupformattiming",level:2},{value:"modifyPairAssignment",id:"modifypairassignment",level:2},{value:"modifyTieFormat",id:"modifytieformat",level:2},{value:"promoteAlternates",id:"promotealternates",level:2},{value:"refreshEventDrawOrder",id:"refresheventdraworder",level:2},{value:"removeEventEntries",id:"removeevententries",level:2},{value:"removeEventExtension",id:"removeeventextension",level:2},{value:"removeEventMatchUpFormatTiming",id:"removeeventmatchupformattiming",level:2},{value:"removeScaleValues",id:"removescalevalues",level:2},{value:"removeSeeding",id:"removeseeding",level:2},{value:"setEventDates",id:"seteventdates",level:2},{value:"setEventDisplay",id:"seteventdisplay",level:2},{value:"updateDrawIdsOrder",id:"updatedrawidsorder",level:2},{value:"validateCategory",id:"validatecategory",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import { eventGovernor } from 'tods-competition-factory';\n"})}),"\n",(0,a.jsx)(n.h2,{id:"adddrawdefinition",children:"addDrawDefinition"}),"\n",(0,a.jsxs)(n.p,{children:["Adds a drawDefinition to an event in a tournamentRecord. Called after ",(0,a.jsx)(n.a,{href:"/docs/governors/generation-governor#generatedrawdefinition",children:"generateDrawDefinition"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const { drawDefinition, error } = engine.generateDrawDefinition(drawDefinitionValues);\nif (!error) {\n  const result = engine.addDrawDefinition({\n    modifyEventEntries, // event.entries[{entryStatus}] are modified to match draw.entries[{entryStatus}]\n    existingDrawCount, // number of draws that exist in the event, used to check that two clients don't attempt to add simultaneously\n    allowReplacement, // optional - defaults to false\n    checkEntryStatus, // optional - defualts to false\n    drawDefinition,\n    eventId,\n    flight, // optional - pass flight definition object for integrity check\n  });\n}\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"addevent",children:"addEvent"}),"\n",(0,a.jsx)(n.p,{children:"Add an event object to a tournamentRecord."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.addEvent({ event });\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"addflight",children:"addFlight"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.addFlight({\n  drawEntries, // optional\n  drawName,\n  eventId,\n  drawId, // optional -- if scenario involves client and server side tournamentEngines, provide { drawId: UUID() }\n  stage,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"assignseedpositions",children:"assignSeedPositions"}),"\n",(0,a.jsxs)(n.p,{children:["Assign ",(0,a.jsx)(n.strong,{children:"seedNumbers"})," to ",(0,a.jsx)(n.strong,{children:"participantIds"})," within a target draw structure."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Provides the ability to assign seeding ",(0,a.jsx)(n.em,{children:"after"})," a structure has been generated"]}),"\n",(0,a.jsxs)(n.li,{children:["To be used ",(0,a.jsx)(n.em,{children:"before"})," participants are positioned"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"seedNumber"})," is unique while ",(0,a.jsx)(n.strong,{children:"seedValue"})," can be any string representation, e.g ",(0,a.jsx)(n.code,{children:'"5-8"'})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.assignSeedPositions({\n  assignments, // [{ seedNumber: 1, seedValue: '1', participantId: 'pid' }];\n  structureId,\n  eventId,\n  drawId,\n\n  stage, // opional; defaults to { stage: MAIN }\n  stageSequence, // optional; defaults to { stageSequence: 1 }\n  useExistingSeedLimits, // optional; restrict ability to assign seedNumbers beyond established limit\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"attachflightprofile",children:"attachFlightProfile"}),"\n",(0,a.jsxs)(n.p,{children:["Attaches a ",(0,a.jsx)(n.code,{children:"flightProfile"})," to the ",(0,a.jsx)(n.code,{children:"event"})," specified by ",(0,a.jsx)(n.code,{children:"eventId"}),". A ",(0,a.jsx)(n.code,{children:"flightProfile"})," is first generated with ",(0,a.jsx)(n.code,{children:"generateFlightProfile()"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.attachFlightProfile({ flightProfile, eventId });\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"deletedrawdefinitions",children:"deleteDrawDefinitions"}),"\n",(0,a.jsxs)(n.p,{children:["Remove ",(0,a.jsx)(n.code,{children:"drawDefinitions"})," from an ",(0,a.jsx)(n.code,{children:"event"}),". An audit timeItem is added to the tournamentRecord whenever this method is called. If ",(0,a.jsx)(n.code,{children:"autoPublish: true"})," (default behavior) then if a deleted draw was published then the ",(0,a.jsx)(n.code,{children:"event"})," to which it belongs will be re-published."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.deleteDrawDefinitions({\n  autoPublish, // optional - defaults to true.\n  eventDataParams, // optional - params to pass to `getEventData` for regeneration of remaining draws\n  auditData, // object with attributes to be added to drawDeletions extension\n  drawIds: [drawId],\n  eventId,\n  force, // boolean - override error when scores present\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"deleteevents",children:"deleteEvents"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.deleteEvents({ eventIds });\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"deleteflightandflightdraw",children:"deleteFlightAndFlightDraw"}),"\n",(0,a.jsxs)(n.p,{children:["Removes flight from ",(0,a.jsx)(n.code,{children:"event"})," flightProfile as well as associated ",(0,a.jsx)(n.code,{children:"drawDefinition"})," (if generated)."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.deleteFlightAndFlightDraw({\n  autoPublish, // optional - defaults to true.\n  auditData, // object with attributes to be added to drawDeletions extension\n  eventId,\n  drawId,\n  force, // boolean - override error when scores present\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"deleteflightprofileandflightdraws",children:"deleteFlightProfileAndFlightDraws"}),"\n",(0,a.jsx)(n.p,{children:"Removes flightProfiles and all associated drawDefinitions from a specified event."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.deleteFlightProfileAndFlightDraws({\n  auditData, // object with attributes to be added to drawDeletions extension\n  eventId,\n  force, // boolean - override error when scores present\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"getcategoryagedetails",children:"getCategoryAgeDetails"}),"\n",(0,a.jsxs)(n.p,{children:["Parses ",(0,a.jsx)(n.code,{children:"ageCategoryCode"})," to determine min/max eligible birthdates and min/max age. Category age/birthdate boundaries can be specified using other attributes.\nIf attributes are combined will sanity check correspondence and return an array of any encountered errors."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const {\n  consideredDate, // returns either supplied value or date when invoked\n  combinedAge, // boolean indicating that ageMax and ageMin are combined values\n  ageMaxDate,\n  ageMinDate,\n  ageMax,\n  ageMin,\n  errors,\n} = engine.getCategoryAgeDetails({\n  consideredDate, // optional - date string 'YYYY-MM-DD'; defaults to current date\n  category: {\n    ageCategoryCode, // TODS code, e.g. 'U18', '18U', '18O', 'O18', '8O-U18', 'C50-70'\n    categoryName, // when no ageCategoryCode is provided, an attempt is made to find in categoryName\n    ageMaxDate, // latest/most recent date acceptable for eligibilty\n    ageMinDate, // earliest date acceptable for eligibility\n    ageMax, // maximum age acceptable for eligibility\n    ageMin, // minimum age acceptable for eligibility\n  },\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"modifyevent",children:"modifyEvent"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"event.modifyEvent({\n  eventUpdates: {\n    eventGender, // optional - must validate against current event entries, if any\n    eventType, // optional - must validate against current event entries, if any\n    eventName, // optional\n    startDate, // optional - must fall within tournament dates\n    category, // optional - must validate against current event entries, if any\n    endDate, // optional - must fall within tournament dates\n  },\n  eventId,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"modifyeventmatchupformattiming",children:"modifyEventMatchUpFormatTiming"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.modifyEventMatchUpFormatTiming({\n  recoveryMinutes,\n  averageMinutes,\n  matchUpFormat,\n  eventId,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"modifypairassignment",children:"modifyPairAssignment"}),"\n",(0,a.jsx)(n.p,{children:"Modifies an individualParticipantId within a PAIR particiapnt entered into an event or draw. Will clean up (delete) any PAIR participants that are not entered into any other draws or events."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.modifyPairAssignment({\n  replacementIndividualParticipantId,\n  existingIndividualParticipantId,\n  participantId,\n  eventId, // optional if drawId is provided\n  drawId, // optional if eventId is provided; scopes change to specified draw\n  uuids, // optional array of uuids for use when generating new participant\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"modifytieformat",children:"modifyTieFormat"}),"\n",(0,a.jsxs)(n.p,{children:["Both modifies the ",(0,a.jsx)(n.code,{children:"tieFormat"})," on the target ",(0,a.jsx)(n.code,{children:"event"}),", ",(0,a.jsx)(n.code,{children:"drawDefinition"}),", ",(0,a.jsx)(n.code,{children:"structure"})," or ",(0,a.jsx)(n.code,{children:"matchUp"})," and adds/deletes ",(0,a.jsx)(n.code,{children:"tieMatchUps"})," as necessary."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.modifyTieFormat({\n  considerations, // optional { collectionName?: boolean; collectionOrder?: boolean };\n  modifiedTieFormat, // will be compared to existing tieFormat that is targeted and differences calculated\n  structureId, // required if modifying tieFormat for a structure\n  matchUpId, // required if modifying tieFormat for a matchUp\n  eventId, // required if modifying tieFormat for a event\n  drawId, // required if modifying tieFormat for a drawDefinition or a structure\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"promotealternates",children:"promoteAlternates"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.promoteAlternates({\n  participantIds,\n  // either drawId or eventId are REQUIRED\n  eventId, // optional if drawId proided\n  drawId, // optional if eventId proided\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"refresheventdraworder",children:"refreshEventDrawOrder"}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"removeevententries",children:"removeEventEntries"}),"\n",(0,a.jsxs)(n.p,{children:["Removes ",(0,a.jsx)(n.code,{children:"event.entries"})," with integrity checks."]}),"\n",(0,a.jsxs)(n.p,{children:["Filters ",(0,a.jsx)(n.code,{children:"participantIds"})," by specified ",(0,a.jsx)(n.code,{children:"entryStatuses"})," and/or ",(0,a.jsx)(n.code,{children:"stage"}),". If no ",(0,a.jsx)(n.code,{children:"participantIds"})," are provided, removes all ",(0,a.jsx)(n.code,{children:"entries"})," that match both ",(0,a.jsx)(n.code,{children:"entryStatuses"})," and ",(0,a.jsx)(n.code,{children:"stage"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.removeEventEntries({\n  autoEntryPositions, // optional - keeps entries ordered by entryStage/entryStatus and auto-increments\n  participantIds, // optional array of participantIds to remove\n  entryStatuses, // optional array of entryStatuses to remove\n  stage, // optional - remove entries for specified stage\n  eventId,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"removeeventextension",children:"removeEventExtension"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.removeEventExtension({ eventId, name });\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"removeeventmatchupformattiming",children:"removeEventMatchUpFormatTiming"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.removeEventMatchUpFormatTiming({ eventId });\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"removescalevalues",children:"removeScaleValues"}),"\n",(0,a.jsx)(n.p,{children:"Removes scale values for participants in a particular event. Optionally restrict by draw or stage."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.removeScaleValues({\n  scaleAttributes, // { scaleType, scaleName, eventType }\n  scaleName, // optional - override default scaleName, event.category.categoryName || event.category.ageCategoryCode\n  drawId, // optional - to scope participants to entries in a specific draw\n  stage, // optinal - scope participants to entries in a specific stage of draw\n  eventId,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"removeseeding",children:"removeSeeding"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.removeSeeding({\n  entryStatuses, // optional array of entryStatues to consider\n  scaleName, // optional - override default scaleName, event.category.categoryName || event.category.ageCategoryCode\n  drawId, // optional - to scope participants to entries in a specific draw\n  stage, // optinal - scope participants to entries in a specific stage of draw\n  eventId,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"seteventdates",children:"setEventDates"}),"\n",(0,a.jsxs)(n.p,{children:["Where startDate and/or endDate are strings 'YYYY-MM-DD'. Can be used to set ",(0,a.jsx)(n.code,{children:"startDate"})," and ",(0,a.jsx)(n.code,{children:"endDate"})," independently."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.setEventDates({\n  activeDates, // optional array of dates from startDate to endDate\n  weekdays, // optional array of [MON, TUE, ...] // use { weekDayConstants }\n  startDate, // optional\n  endDate, // optional\n  eventId, // required\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"seteventdisplay",children:"setEventDisplay"}),"\n",(0,a.jsxs)(n.p,{children:["Defines publish status for attributes of ",(0,a.jsx)(n.code,{children:"participants"})," and ",(0,a.jsx)(n.code,{children:"matchUp"})," schedules which are returned by ",(0,a.jsx)(n.a,{href:"/docs/governors/query-governor#geteventdata",children:"getEventData"})," and ",(0,a.jsx)(n.a,{href:"/docs/governors/query-governor#competitionschedulematchups",children:"competitionScheduleMatchUps"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const displaySettings = {\n  draws: {\n    default: {\n      participantAttributes: { [key]: boolean },\n      // an array of attribute settings to be applied to specified dates\n      scheduleDetails: [\n        {\n          attributes: { scheduledTime: false },\n          dates: [], // empty array or undefined specifies that attribute setting apply to all scheduledDates\n        },\n      ],\n    },\n    [drawId]: {},\n  },\n};\n\nengine.setEventDisplay({\n  displaySettings,\n  eventId,\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"updatedrawidsorder",children:"updateDrawIdsOrder"}),"\n",(0,a.jsxs)(n.p,{children:["Updates the ",(0,a.jsx)(n.code,{children:"drawOrder"})," attribute of all ",(0,a.jsx)(n.code,{children:"drawDefinitions"})," within an event. The ",(0,a.jsx)(n.code,{children:"drawOrder"})," attribute can be used for sorting or for differentiating ",(0,a.jsx)(n.code,{children:"drawDefinitions"}),' for the award of rankings points, when "flighting" separates participants by some ',(0,a.jsx)(n.code,{children:"scaleValue"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.updateDrawIdsOrder({\n  eventId,\n  orderedDrawIdsMap: {\n    'id-Of-draw-1': 1,\n    'id-of-draw-2': 2,\n  },\n});\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"validatecategory",children:"validateCategory"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"engine.validateCategory({ category });\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);
---
title: drawEngine API
---

All **_drawEngine_** methods which make a mutation return either `{ success: true }` or `{ error }`

---

## addDrawEntries

```js
drawEngine.addDrawEntries({
  participantIds, // an array of participantIds, should all be of the same participantType
  entryStatus, // optional - defaults to DIRECT_ACCEPTANCE
  stage, // optional - stage into which participantIds have been entered; defaults to MAIN
  stageSequence, // optional - applies to qualifying
  autoEntryPositions, // optional - keeps entries ordered by entryStage/entryStatus and auto-increments
  ignoreStageSpace, // optional boolean to disable checking available positions
});
```

---

## addDrawEntry

```js
drawEngine.addDrawEntry({
  participantId,
  entryStage, // optional - stage into which participantIds have been entered; defaults to MAIN
  entryStatus, // optional - defaults to DIRECT_ACCEPTANCE
  entryPosition, // optional - used to order entries, e.g. { entryPosition: 1 } for 1st alternate
  ignoreStageSpace, // optional boolean to disable checking available positions
});
```

---

## addFinishingRounds

```js
addFinishingRounds({
  finishingPositionOffset = 0, // required for sub-structures; e.g. consolation fed from R32 would have { finishingPositionOffset: 16 }
  roundLimit, // for qualifying, offset the final round so that qualifyinground is finishingRound
  matchUps, // required - matchUps belonging to a single structure
});
```

---

## addMatchUpEndTime

```js
const endTime = '2020-01-01T09:05:00Z';
drawEngine.addMatchUpEndTime({
  validateTimeSeries, // optional - true by default - when false does not verify endTime is later than startTime
  disableNotice, // when disabled subscribers will not be notified
  matchUpId,
  endTime,
});
```

---

## addMatchUpOfficial

```js
drawEngine.addMatchUpOfficial({
  matchUpId,
  participantId,
  officialType,
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addMatchUpResumeTime

```js
const resumeTime = '2020-01-01T09:00:00Z';
drawEngine.addMatchUpResumeTime({
  matchUpId,
  resumeTime,
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addMatchUpScheduledDate

```js
const scheduledDate = '2020-01-01';
drawEngine.addMatchUpScheduledDate({
  matchUpId,
  scheduledDate,
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addMatchUpScheduledTime

```js
const scheduledTime = '08:00';
drawEngine.addMatchUpScheduledTime({
  matchUpId,
  scheduledTime,
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addMatchUpScheduleItems

Convenience function to add several schedule items at once.

```js
drawEngine.addMatchUpScheduleItems({
  matchUpId,
  schedule: {
    scheduledTime,
    scheduledDate,
    startTime,
    endTime,
  },
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addMatchUpStartTime

```js
const startTime = '2020-01-01T08:05:00Z';
drawEngine.addMatchUpStartTime({
  matchUpId,
  startTime,
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addMatchUpStopTime

```js
const stopTime = '2020-01-01T08:15:00Z';
drawEngine.addMatchUpStopTime({
  matchUpId,
  stopTime,
  disableNotice, // when disabled subscribers will not be notified
});
```

---

## addPlayoffStructures

```js
drawEngine.addPlayoffStructures({
  structureId,
  roundNumbers: [3], // optional if playoffPositions not provided; roundNumbers of structure to be played off.
  roundProfiles, // optional - source roundNumbers as Object.keys with depth as Object.values, e.g. [{ 1: 2}, {2: 1}]
  playoffPositions: [3, 4], // optional if roundNumbers not provided; finishing positions to be played off.
  playoffAttributes, // optional - mapping of either exitProfile or finishingPositionRange to structure names, e.g. 0-1-1 for South
  exitProfileLimit, // limit playoff rounds generated by the attributes present in playoffAttributes
  playoffStructureNameBase, // optional - Root word for default playoff naming, e.g. 'Playoff' for 'Playoff 3-4'
});

// example use of playoffAttributes - will generated playoff structure from 2nd round with structureName: 'BRONZE'
const playoffAttributes = {
  '0-2': { name: 'BRONZE', abbreviation: 'B' },
};
```

---

## addMatchUpTimeItem

```js
const timeItem = {
  itemType: SCHEDULED_DATE,
  itemValue: scheduledDate,
};
drawEngine.addMatchUpTimeItem({
  matchUpId,
  timeItem,
  duplicateValues: false,
});
```

---

## addVoluntaryConsolationStage

Modifies the entryProfile for a draw to allow `{ entryStage: VOLUNTARY_CONSOLATION }`

```js
drawEngine.addVoluntaryConsolationStage({
  drawSize,
});
```

---

### addVoluntaryConsolationStructure

Generates a new structure within a `drawDefinition` if any draw entries are present for `{ entryStage: VOLUNTARY_CONSOLATION }`.

```js
drawEngine.addVoluntaryConsolationStructure();
```

---

## allDrawMatchUps

Returns all matchUps from all structures within a draw.

```js
const { matchUps } = drawEngine.allDrawMatchUps({
  context, // optional context to be added into matchUps
  inContext, // boolean - add context { drawId, structureId, participant, individualParticipants ... }
  nextMatchUps, // optioanl - boolean - to include winnerTo and loserTo
  matchUpFilters, // attribute filters
  contextFilters, // filters based on context attributes
  tournamentParticipants, // optional - provide an array of tournamentParticipants to add into matchUps
  requireParticipants, // optional - require that participants be loaded into drawEngine or passed into method
  tournamentAppliedPolicies, // any policies, such as privacy, to be applied to matchUps
  contextProfile, // optional: { inferGender: true, withCompetitiveness: true, withScaleValues: true, exclude: ['attribute', 'to', 'exclude']}
});
```

---

## allPlayoffPositionsFilled

Returns boolean value for whether playoff positions (which have been generated) are populated with `participantIds` or `BYEs`.

```js
const allPositionsFilled = allPlayoffPositionsFilled({
  drawDefinition,
  structureId,
});
```

---

## allStructureMatchUps

Returns all matchUps from a single structure within a draw.

```js
const { matchUps } = drawEngine.allStructureMatchUps({
  structureId,
  context, // optional context to be added into matchUps
  inContext, // boolean - add context { drawId, structureId, participant, individualParticipants ... }
  nextMatchUps, // optioanl - boolean - to include winnerTo and loserTo
  matchUpFilters, // attribute filters
  contextFilters, // filters based on context attributes
  tournamentParticipants, // optional - provide an array of tournamentParticipants to add into matchUps
  requireParticipants, // optional - require that participants be loaded into drawEngine or passed into method
  tournamentAppliedPolicies, // any policies, such as privacy, to be applied to matchUps
});
```

---

## assignDrawPosition

```js
drawEngine.assignDrawPosition({
  structureId,
  drawPosition,
  participantId,
});
```

---

## assignDrawPositionBye

```js
drawEngine.assignDrawPositionBye({
  structureId,
  drawPosition,
});
```

---

## assignSeed

```js
result = drawEngine.assignSeed({
  structureId,
  seedNumber,
  seedValue, // optional - display value, e.g. '5-8'
  participantId,
});
```

---

## attachPlayoffStructures

Attaches the results of `generateAndPopulatePlayoffStructures` to a `drawDefinition`.
Used primarily when multiple instances of `drawEngine` are in use and the generation step is performed by one instance.

:::note
`drawEngine.addPlayoffStructures()` calls both `generateAndPopulatePlayoffStructures` and `attachPlayoffStructures` and is used when there is only one instance of `drawEngine`.
:::

```js
drawEngine.attachPlayoffStructures({ structures, links });
```

---

## automatedPositioning

Positions participants in a draw structure. `drawEngine` is agnostic about the type of participants that are placed in a draw structure, but requires tournament participants for avoidance policies to work.

See [Policies](../concepts/policies).

```js
drawEngine.automatedPositioning({
  structureId,
  participants, // optional - participants must be passed in for Avoidance Policies to be effective
});
```

---

## checkInParticipant

Set the check-in state for a participant. Used to determine when both participants in a matchUp are available to be assigned to a court.

```js
drawEngine.checkInParticipant({
  matchUpId,
  participantId,
});
```

---

## checkOutParticipant

```js
drawEngine.checkOutParticipant({
  matchUpId,
  participantId,
});
```

---

## clearDrawPosition

Removes a `participantId` or `bye` from a specified `drawPosition` within a `structure` or, optionally, removes a specified `participantId` from a `structure`.

```js
drawEngine.clearDrawPosition({
  structureId,
  drawPosition, // optional if participantId is provided
  participantId, // optional if drawPosition is provided
});
```

---

## deleteAdHocMatchUps

```js
const result = drawEngine.deleteAdHocMatchUps({
  drawDefinition, // required - drawDefinition in which target structure is found
  structureId, // required - structureId of structure for which matchUps are being generated
  matchUpIds, // array of matchUpIds identifying matchUps to be deleted
});
```

---

## devContext

Setting devContext(true) bypasses **try {} catch (err) {}** code block and in some cases enables logging

```js
drawEngine.devContext(true);
```

---

## drawMatchUps

Returns categorized matchUps from all structures within a draw.

```js
const {
  upcomingMatchUps,
  pendingMatchUps,
  completedMatchUps,
  abandonedMatchUps,
  byeMatchUps,
} = drawEngine.drawMatchUps({
  context, // optional context to be added into matchUps
  inContext, // boolean - add context { drawId, structureId, participant, individualParticipants ... }
  nextMatchUps, // optioanl - boolean - to include winnerTo and loserTo
  matchUpFilters, // attribute filters
  contextFilters, // filters based on context attributes
  tournamentParticipants, // optional - provide an array of tournamentParticipants to add into matchUps
  requireParticipants, // optional - require that participants be loaded into drawEngine or passed into method
  tournamentAppliedPolicies, // any policies, such as privacy, to be applied to matchUps
});
```

---

## drawMatic

```js
const { matchUps } = drawEngine.drawMatic({
  addToStructure, // optional - defaults to true
  drawId,
});
```

---

## disableTieAutoCalc

Disable default behavior of auto calculating TEAM matchUp scores.

```js
drawEngine.disableTieAutoCalc({ matchUpId });
```

---

## enableTiaAutoCalc

Re-enable default behavior of auto calculating TEAM matchUp scores, and trigger auto calculation.

```js
drawEngine.enableTieAutoCalc({ matchUpId });
```

---

## findMatchUp

```js
const {
  matchUp,
  structure, // returned for convenience
} = drawEngine.findMatchUp({
  matchUpId,
  inContext, // optional - boolean - returns matchUp with additional attributes
  tournamentParticipants, // optional - enables inContext matchUp to contain full participant objects
});
```

---

## generateAndPopulatePlayoffStructures

Generates `structures` and `links` but does not attach them to the `drawDefinition`. Used in conjunction with `attachPlayoffStructures`.

```js
const { structures, links, matchUpModifications } =
  drawEngine.generateAndPopulatePlayoffStructures({
    requireSequential, // boolean defaults to true; only applies to Round Robin; require finishingPositions to be sequential
    roundNumbers: [3], // optional if playoffPositions not provided; roundNumbers of structure to be played off.
    roundProfiles, // optional - source roundNumbers as Object.keys with depth as Object.values, e.g. [{ 1: 2}, {2: 1}]
    playoffPositions: [3, 4], // optional if roundNumbers not provided; finishing positions to be played off.
    playoffAttributes, // optional - mapping of either exitProfile or finishingPositionRange to structure names, e.g. 0-1-1 for South
    exitProfileLimit, // limit playoff rounds generated by the attributes present in playoffAttributes
    playoffStructureNameBase, // optional - Root word for default playoff naming, e.g. 'Playoff' for 'Playoff 3-4'
    structureId,
  });
```

---

## generateDrawTypeAndModifyDrawDefinition

Convenience method to generate pre-defined drawTypes.

For more information on `feedPolicy` see [Feed Policies](../policies/feedPolicy).

```js
drawEngine.generateDrawTypeAndModifyDrawDefinition({
  drawType, // defaults to SINGLE_ELIMINATION
  modifyOriginal, // optional - defaults to true (primarily used by other engines)

  matchUpType, // optional - defaults to SINGLES - will check first on drawDefinition
  matchUpFormat, // optional - default matchUpFormat
  tieFormat, // optional - overrides drawDefinition.tieFormat, if present, for TEAM draws
  playoffMatchUpFormat, // optional - default playoffMatchUpFormat

  staggeredEntry, // optional - accepts non-base-2 drawSizes and generates feed arms for "extra" drawPositions
  seedingProfile, // optional { positioning, groupSeedingThreshold }; WATERFALL seeding for ROUND_ROBIN structures, CLUSTER or SEPARATE seeding for elimination structures
  feedPolicy, // optional - provides fine-grain control for FEED_IN_CONSOLATION feed links

  qualifyingPositions, // optional - number of drawPositions to be filled by qualifiers
  finishingPositionLimit, // optional - for playoff structures, limit to the number of positions to be played off

  structureOptions: {
    groupSize, // e.g. 4 participants per group
    groupSizeLimit: 8,
    playoffGroups: [
      { finishingPositions: [1], structureName: 'Gold Flight', drawType }, // drawype defaults to SINGLE_ELIMINATION
      { finishingPositions: [2], structureName: 'Silver Flight', drawType }, // drawType can also be COMPASS or FIRST_MATCH_LOSER_CONSOLATION
    ],
  },

  uuids, // optional - array of UUIDs to be used for structureIds and matchUpIds

  structureName, // optional - defaults to stage
});
```

---

## generateQualifyingLink

Generates and adds a `link` to `drawDefinition.links`.

```js
drawEngine.generateQualifyingLink({
  qualifyingStructureId,
  mainStructureId,
});
```

---

## getAvailablePlayoffProfiles

If provided a `structureId`, returns rounds of the selected structure which are available for adding playoff structures.

```js
const { playoffRounds, playoffRoundsRanges, positionsPlayedOff } =
  drawEngine.getAvailablePlayoffProfiles({
    structureId,
  });
```

...for a SINGLE_ELIMINATION struture with `{ drawSize: 16 }` this would return:

```js
{
  playoffRounds: [ 1, 2, 3 ],
  playoffRoundsRanges: [
    { round: 1, range: '9-16' },
    { round: 2, range: '5-8' },
    { round: 3, range: '3-4' }
  ]
}
```

...for a ROUND_ROBIN struture with `{ drawSize: 16 }` and `{ groupSize: 4 }` this would return:

```js
{
    "finishingPositionsAvailable": [ 1, 2, 3, 4 ],
    "playoffFinishingPositionRanges": [
        {
            "finishingPosition": 1,
            "finishingPositions": [ 1, 2, 3, 4 ],
            "finishingPositionRange": "1-4"
        },
        {
            "finishingPosition": 2,
            "finishingPositions": [ 5, 6, 7, 8 ],
            "finishingPositionRange": "5-8"
        },
        {
            "finishingPosition": 3,
            "finishingPositions": [ 9, 10, 11, 12 ],
            "finishingPositionRange": "9-12"
        },
        {
            "finishingPosition": 4,
            "finishingPositions": [ 13, 14, 15, 16 ],
            "finishingPositionRange": "13-16"
        }
    ],
}
```

When no `structureId` is provided, returns an array of `availablePlayoffProfiles` with entries for each structure in a loaded `drawDefinition`.

```js
const { availablePlayoffProfiles, positionsPlayedOff } =
  drawEngine.getAvailablePlayoffProfiles();
```

---

## getCheckedInParticipantIds

```js
const {
  allParticipantsCheckedIn, // boolean
  checkedInParticipantIds, // array of participantIds
} = drawEngine.getCheckedInParticipantIds({ matchUp });
```

---

## getDrawStructures

```js
const { structures, stageStructures } = drawEngine.getDrawStructures({
  withStageGrouping, // optinal, return structures collated by stage
  stageSequences, // optional - specify stageSequences to include
  stageSequence, // optional - filter by stageSequence
  stages, // optional - specify stageSequences to include
  stage, // optional - filter by stage
});
```

---

## getEliminationDrawSize

```js
const { drawSize } = drawEngine.getEliminationDrawSize({ participantsCount });
```

---

## getMatchUpContextIds

Convenience method to find a `matchUp` by `matchUpId` and return "context ids". Does NOT require that drawEngine state be set, but does require an array of "inContext" `matchUps`.

```js
const { matchUpId, drawId, eventId, structureId, tournamentId } =
  drawEngine.getMatchUpContextIds({ matchUps, matchUpId });
```

---

## getMatchUpParticipantIds

Convenience function; requires inContext matchUp.

```js
const { sideParticipantIds, individualParticipantIds } =
  drawEngine.getMatchUpParticipantIds({ matchUp });
```

---

## getMatchUpScheduleDetails

Returns the latest values for all `matchUp.timeItems`, along with calculated values, that relate to the scheduling of a `matchUp`.

```js
const {
  schedule: {
    time,
    courtId,
    venueId,
    startTime,
    endTime,
    milliseconds,
    scheduledDate,
    scheduledTime,
    allocatedCourts: [{ venueId, courtid }], // applies only to TEAM matchUps
  },
} = drawEngine.getMatchUpScheduleDetails({
  scheduleVisibilityFilters, // { visibilityThreshold: Date, eventIds, drawIds }
  matchUp,
});
```

---

## getNextSeedBlock

Returns the next block of drawPositions which are to be assigned seeded participants.

```js
const {
  nextSeedBlock,
  unplacedSeedParticipantIds,
  unplacedSeedNumbers,
  unfilledPositions,
  unplacedSeedAssignments,
} = drawEngine.getNextSeedBlock({
  structureId,
});
```

---

## getNextUnfilledDrawPositions

Returns the next valid block of unfilled drawPositions. Useful for UI to give visual indication of drawPostions valid to assign.

```js
const { nextUnfilledDrawPositions } = drawEngine.getNextUnfilledDrawPositions({
  structureId,
});
```

---

## getPositionsPlayedOff

Determines which finishing positions will be returned by a draw. For example, a First Match Loser Consolation with a draw size of 16 will playoff possitions 1, 2, 9 and 10.

```js
const { positionsPlayedOff } = drawEngine.getPositionsPlayedOff({
  drawDefinition,
});
```

---

## getRoundMatchUps

Organizes matchUps by roundNumber. **roundMatchUps** contains matchUp objects; **roundProfile** provides an overview of drawPositions which have advanced to each round, a matchUpsCount, finishingPositionRange for winners and losers, and finishingRound.

```js
const { roundMatchUps, roundProfile } = drawEngine.getRoundMatchUps({
  matchUps,
});
```

---

## getSeedingThresholds

```js
const { seedingThresholds } = drawEngine.getSeedingThresholds({
  roundRobinGroupsCount,
  participantsCount,
});
```

---

## getSourceRounds

Returns the round numbers for desired playoff positions.

```js
const {
  sourceRounds, // all source rounds for playedOff positions and specified playoffPositions
  playoffSourceRounds,
  playedOffSourceRounds,
  playoffPositionsReturned,
} = drawEngine.getSourceRounds({
  structureId,
  playoffPositions: [3, 4],
});
```

---

## getStructureSeedAssignments

Returns seedAssignments for a specific structure based on structureId or structure

The structure of an **_assignment object_** is as follows:

```json
{
  "seedNumber": 1,
  "seedValue": "1",
  "participantId": "uuid-of-participant"
}
```

The most basic usage is to retrieve seed assignments for a draw which has a single main stage structure

```js
const { seedAssignments } = drawEngine.getStructureSeedAssignments({
  structureId,
});
```

---

## getState

No parameters.

Returns a deep copy of the current drawEngine state.

```js
const { drawDefinition } = drawEngine.getState({
  convertExtensions, // optional - convert extensions to '_' prefixed attributes
  removeExtensions, // optional - strip all extensions out of tournamentRecord
});
```

---

## getValidGroupSizes

Returns valid Round Robin group sizes for specified `drawSize`.

```js
const { validGroupSizes } = drawEngine.getValidGroupSies({
  groupSizeLimit, // optional - defaults to 10
  drawSize,
});
```

---

## initializeStructureSeedAssignments

Creates the `seedAssignments` attribute for the specified structure.

```js
drawEngine.initializeStructureSeedAssignments({
  structureId,
  seedsCount,
});
```

---

## isCompletedStructure

Returns boolean whether all matchUps in a given structure have been completed

```js
const structureIsComplete = drawEngine.isCompletedStructure({
  structureId,
});
```

---

## matchUpActions

Return an array of all validActions for a specific matchUp.

```js
const {
  isByeMatchUp, // boolean; true if matchUp includes a BYE
  structureIsComplete, // boolean; true if structure is ready for positioning
  validActions, // array of possible actions given current matchUpStatus
} = drawEngine.matchUpActions({
  restrictAdHocRoundParticipants, // optional - true by default; applies to AD_HOC; disallow the same participant being in the same round multiple times
  sideNumber, // optional - select side to which action should apply; applies to AD_HOC position assignments
  matchUpId,
});

const {
  type, // 'REFEREE', 'SCHEDULE', 'PENALTY', 'STATUS', 'SCORE', 'START', 'END'.
  method, // tournamentEngine method relating to action type
  payload, // attributes to be passed to method
  // additional method-specific options for values to be added to payload when calling method
} = validAction;
```

---

## matchUpDuration

Calculates matchUp duration from START, STOP, RESUME, END timeItems.

```js
const {
  milliseconds,
  time, // string representation of elapsed time, e.g. "01:10:00" for an hour and 10 seconds
  relevantTimeItems,
} = drawEngine.matchUpDuration({
  matchUp,
});
```

---

## newDrawDefinition

Creates a new drawDefinition within drawEngine state.

```js
const { drawId } = drawEngine.newDrawDefinition();
const { drawDefinition } = drawEngine.getState();
```

---

## positionActions

```js
const positionActions = drawEngine.positionActions({
  policyDefinitions: positionActionsPolicy, // optional - policy defining what actions are allowed in client context
  returnParticipants, // optional boolean; defaults to true; performance optimization when false requires client to provide participants.
  drawPosition,
  structureId,
});

const {
  isActiveDrawPosition, // boolean
  isByePosition, // boolean
  isDrawPosition, // boolean
  hasPositionAssiged, // boolean
  validActions,
} = positionActions;

const {
  type, // 'ASSIGN', 'LUCKY', 'SWAP', 'BYE', 'REMOVE'
  method, // tournamentEngine method relating to action type
  payload, // attributes to be passed to method
  // additional method-specific options for values to be added to payload when calling method
} = validAction;
```

---

## removeEntry

```js
drawEngine.removeEntry({
  participantId,
  autoEntryPositions, // optional - keeps entries ordered by entryStage/entryStatus
});
```

---

## removeStructure

Removes targeted `drawDefinition.structure` and all other child `structures` along with all associated `drawDefinition.links`.

```js
const { removedMatchUpIds } = drawEngine.removeStructure({
  structureId,
});
```

---

## renameStructures

```js
drawEngine.renameStructures({
  structureDetails: [{ structureId, structureName }],
});
```

## reset

Clears the drawEngine state.

```js
drawEngine.reset();
```

---

## resetMatchUpTimeItems

Removes all timeItems from a specified matchUp.

```js
drawEngine.resetMatchUpTimeItems({ matchUpId });
```

---

## setDrawDescription

```js
const drawDescription = 'Draw Description';
drawEngine.setDrawDescription({ description: drawDescription });
```

---

## setMatchUpFormat

Sets the default `matchUpFormat` for a `drawDefintion` or a `structure`, or for a specific `matchUp`.

```js
drawEngine.setMatchUpFormat({
  matchUpFormat,
  structureId, // optional - if structureId is present and not matchUpId is present, then set for structure
  matchUpId, // optional - if matchUpId is present then only set for matchUp
});
```

---

## setMatchUpStatus

Sets either matchUpStatus or score and winningSide. Handles any winner/loser participant movements within or across structures.

```js
drawEngine.setMatchUpStatus({
  disableScoreValidation, // optional boolean
  allowChangePropagation, // optional boolean - allow winner/loser to be swapped and propgate change throughout draw structures
  disableAutoCalc, // optional - applies only to { matchUpType: TEAM }
  enableAutoCalc, // optional - applies only to { matchUpType: TEAM }
  matchUpTieId, // optional - if part of a TIE matchUp
  matchUpStatus, // optional - if matchUpFormat differs from event/draw/structure defaults
  matchUpId,
  score, // optional - { sets }
  winningSide,
  schedule: {
    // optional - set schedule items
    scheduledDate,
    scheduledTime,
    startTime,
    endTime,
  },
  notes, // optional - add note (string) to matchUp object
});
```

---

## setOrderOfFinish

Sets the `orderOfFinish` attribute for `matchUps` specified by `matchUpId` in the `finishingOrder` array.

### Validation

Validation is done within a _cohort_ of `matchUps` which have equivalent `structureId`, `matchUpType`, `roundNumber`, and `matchUpTieId` (if applicable).

- `matchUpIds` in `finishingOrder` must be part of the same _cohort_
- `orderOfFinish` values must be unique positive integers within the _cohort_

```js
drawEngine.setOrderOfFinish({
  finishingOrder: [{ matchUpId, orderOfFinish: 1 }],
});
```

---

## setParticipants

Participants are not managed by the `drawEngine`, but they can be used when returning 'inContext' matchUps as well as when automated positioning relies on avoidance policies.

```js
drawEngine.setParticipants(participants);
```

---

## setStageAlternatesCount

Sets an (optional) limit to the number of accepted alternates.

Modifies the 'entryProfile' of a drawDefinition before the structures have been generated.

```js
drawEngine.setStageAlternatesCount({ alternatesCount: 8 });
```

---

## setStageDrawSize

Modifies the 'entryProfile' of a drawDefinition before the structures have been generated.

```js
drawEngine.setStageDrawSize({ stage: QUALIFYING, stageSequence, drawSize: 8 });
drawEngine.setStageDrawSize({ stage: MAIN, drawSize: 16 });
```

---

## setStageQualifiersCount

```js
drawEngine.setStageQualifiersCount({
  qualifiersCount: 4,
  stageSequence,
  stage,
});
```

---

## setStageWildcardsCount

```js
drawEngine.setStageWildcardsCount({ stage, stageSequence, wildcardsCount: 2 });
```

---

## setState

Loads a drawDefinition into drawEngine.

```js
drawEngine.setsState(drawDefinition, deepCopy, deepCopyConfig);
```

:::info
By default a deep copy of the tournament record is made so that mutations made by drawEngine do not affect the source object. An optional boolean parameter, _deepCopy_ can be set to false to override this default behavior.
:::

:::note
`deepCopyConfig` is an optional configuration for `makeDeepCopy`. In server configurations when `deepCopy` is FALSE and `tournamentRecords` are retrieved from Mongo, for instance, there are scenarios where nodes of the JSON structure contain prototypes which cannot be converted.
:::

```js
const deepCopyConfig = {
  ignore, // optional - either an array of attributes to ignore or a function which processes attributes to determine whether to ignore them
  toJSON, // optional - an array of attributes to convert to JSON if the attribute in question is an object with .toJSON property
  stringify, // optional - an array of attributes to stringify
  modulate, // optional - function to process every attribute and return custom values, or undefined, which continues normal processing
};
```

---

## setSubOrder

Used to order ROUND_ROBIN participants when finishingPosition ties cannot be broken algorithmically. Assigns a subOrder value to a participant within a structure by drawPosition.

```js
drawEngine.setSubOrder({
  structureId, // structure identifier within drawDefinition
  drawPosition: 1, // drawPosition of the participant where subOrder is to be added
  subOrder: 2, // order in which tied participant should receive finishing position
});
```

---

## swapDrawPositionAssignments

Swaps the `participantIds` of two `drawPositions`.

```js
drawEngine.swapDrawPositionAssignments({ structureId, drawPositions });
```

---

## getStructureMatchUps

Returns categorized matchUps from a single structure.

```js
const {
  upcomingMatchUps,
  pendingMatchUps,
  completedMatchUps,
  abandonedMatchUps,
  byeMatchUps,
} = drawEngine.getStructureMatchUps({
  structureId,
  context, // optional context to be added into matchUps
  inContext, // boolean - add context { drawId, structureId, participant, individualParticipants ... }
  nextMatchUps, // optioanl - boolean - to include winnerTo and loserTo
  matchUpFilters, // attribute filters
  contextFilters, // filters based on context attributes
  tournamentParticipants, // optional - provide an array of tournamentParticipants to add into matchUps
  requireParticipants, // optional - require that participants be loaded into drawEngine or passed into method
  tournamentAppliedPolicies, // any policies, such as privacy, to be applied to matchUps
  scheduleVisibilityFilters, // { visibilityThreshold: Date, eventIds, drawIds }
});
```

---

## validDrawPositions

Returns boolean indicating whether all matchUps have valid draw positions

```js
drawEngine.validDrawPositions({ matchUps });
```

---

## version

Returns NPM package version. Can be used in configurations that utilize Competition Factory engines on both client and server to ensure equivalency.

```js
const version = drawEngine.version();
```

---

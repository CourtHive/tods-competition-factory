---
title: Draws Governor
---

```js
import { governors: { drawsGovernor }} from 'tods-competition-factory';
```

## addAdHocMatchUps

Adds `matchUps` generated by [generateAdHocMatchUps](/docs/governors/generation-governor/#generateadhocmatchups) to specified structure within an AD_HOC `drawDefinition`.

```js
  engine.addAdHocMatchUps({
    structureId,
    matchUps,
    drawId,
  }
```

---

## addPlayoffStructures

Adds playoff structures to an existing drawDefinition.

```js
engine.addPlayoffStructures({
  drawId,
  structureId,
  roundNumbers: [3], // required if no playoffPositions - source roundNumbers which will feed target structures, e.g. [1, 2]
  roundProfiles, // optional - source roundNumbers as Object.keys with depth as Object.values, e.g. [{ 1: 2}, {2: 1}]
  playoffPositions: [3, 4], // required if not provided roundNumbers
  playoffAttributes, // optional - mapping of either exitProfile or finishingPositionRange to structure names, e.g. 0-1-1 for South
  exitProfileLimit, // limit playoff rounds generated by the attributes present in playoffAttributes
  playoffStructureNameBase, // optional - base word for default playoff naming, e.g. 'Playoff'
});

// example use of playoffAttributes - will generated playoff structure from 2nd round with structureName: 'BRONZE'
const playoffAttributes = {
  '0-2': { name: 'BRONZE', abbreviation: 'B' },
};
```

---

## addQualifyingStructure

```js
engine.addQualifyingStructure({
  targetStructureId, // required: structure for which participants will qualify
  qualifyingPositions, // optional: specify the # of qualifyingPositions
  qualifyingRoundNumber, // optional: determine qualifyingPositions by # of matchUps in specified round; does not apply to ROUND_ROBIN
  structureOptions, // optional: specific to ROUND_ROBIN generation
  structureName, // optional
  drawSize,
  drawType, // optional: defaults to SINGLE_ELIMINATION
  drawId, // required: draw within which target structure appears
});
```

---

## addVoluntaryConsolationStage

Modifies the entryProfile for a draw to allow `{ entryStage: VOLUNTARY_CONSOLATION }`

```js
engine.addVoluntaryConsolationStage({
  drawSize,
  drawId,
});
```

---

## addVoluntaryConsolationStructure

Generates a new structure within a `drawDefinition` if any draw entries are present for `{ entryStage: VOLUNTARY_CONSOLATION }`.

```js
engine.addVoluntaryConsolationStructure({
  structureAbbreviation, // optional
  structureName, // optional - defaults to 'VOLUNTARY_CONSOLATION'
  drawId,
});
```

---

## alternateDrawPositionAssignment

Replaces an existing drawPosition assignment with an alternateParticipantId. This method is included in `validActions` for [positionActions](../policies/positionActions)

```js
engine.alternateDrawPositionAssignment({
  alternateParticipantId,
  drawPosition,
  structureId,
  drawId,
});
```

---

## assignDrawPosition

Low level function normally called by higher order convenience functions.

```js
engine.assignDrawPosition({
  participantId, // optional - if assigning position to a participant
  drawPosition,
  structureId,
  qualifier, // optional boolean, if assigning a space for a qualifier
  drawId,
  bye, // optional boolean, if assigning a bye
});
```

---

## attachPlayoffStructures

Attaches the results of `generateAndPopulatePlayoffStructures` to a `drawDefinition`.
Used primarily when multiple instances of `drawEngine` are in use and the generation step is performed by one instance.

:::note
`engine.addPlayoffStructures()` calls both `generateAndPopulatePlayoffStructures` and `attachPlayoffStructures` and is used when there is only one instance of `drawEngine`.
:::

```js
engine.attachPlayoffStructures({
  matchUpModifications, // optional - pass any modifications external to the structure that are relevant to structure generation
  structures,
  drawId,
  links,
});
```

---

## attachQualifyingStructure

```js
engine.attachQualifyingStructure({
  structure, // required: structure object; see `generateQualifyingStructure`
  drawId, // required: id of drawDedfinition to which structure will be attached
  link, // required
});
```

---

## attachStructures

Use to attach structures and links which are generated by `generateVoluntaryConsolation`.

```js
engine.attachStructures({
  matchUpModifications, // optional - pass any modifications external to the structure that are relevant to structure generation
  structures,
  drawId,
  links,
});
```

---

## automatedPlayoffPositioning

For Round Robin structures, uses Round Robin Tallies to position participants in playoff structure(s).

```js
engine.automatedPlayoffPositioning({
  structureId: mainStructure.structureId,
  provisionalPositioning, // optional boolean, defaults to false; when true will honor provisionalOrder if no groupOrder is found in tallyResults
  applyPositioning, // optional boolean, defaults to true; when false will return positioning but not apply it to playoff structures
  drawId,
});
```

---

## automatedPositioning

Positions participants in a draw structure.

See [Policies](../concepts/policies).

```js
engine.automatedPositioning({ drawId, structureId });
```

---

## autoSeeding

:::note
Only generates seeding. To apply `engine.setParticipantScaleItems({ scaleItemsWithParticipantIds }`.
:::

```js
const { scaleItemsWithParticipantIds } = engine.autoSeeding({
  eventId,
  policyDefinitions, // seeding policyDefinition determines the # of seeds for given participantsCount/drawSize
  scaleAttributes, // { scaleType, scaleName, eventType, accessor }
  scaleName, // Optional - defaults to scaleAttributes.scaleName
  drawSize, // Optional - defaults to calculation based on # of entries
  drawId, // Optional - will use flight.drawEntries or drawDefinition.entries rather than event.entries
  stage, // Optional - filters entries by specified stage

  scaleSortMethod, // Optional - user defined sorting method
  sortDescending, // Optional - defaults to false
});

engine.setParticipantScaleItems({
  scaleItemsWithParticipantIds,
});
```

---
